
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>hydpy.core.devicetools &#8212; HydPy 4.0a11 documentation</title>
    <link rel="stylesheet" href="../../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">HydPy 4.0a11 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for hydpy.core.devicetools</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;This modules implements the fundamental features for structuring</span>
<span class="sd">*HydPy* projects.</span>

<span class="sd">Module |devicetools| provides two |Device| subclasses, |Node| and |Element|.</span>
<span class="sd">In this documentation, &quot;node&quot; stands for an object of class |Node|, &quot;element&quot;</span>
<span class="sd">for an object of class |Element|, and &quot;device&quot; for either of them (you</span>
<span class="sd">cannot initialise objects of class |Device| directly).  On the other hand,</span>
<span class="sd">&quot;nodes&quot;, for example, does not necessarily mean an object of class |Nodes|,</span>
<span class="sd">but any other group of |Node| objects as well.</span>

<span class="sd">Each element handles a single |Model| object and represents, for example,</span>
<span class="sd">a subbasin or a channel segment.  The purpose of a node is to connect</span>
<span class="sd">different elements, and, for example, to pass the discharge calculated</span>
<span class="sd">for a subbasin outlet (from a first element) to the top of a channel</span>
<span class="sd">segment (to second element).  Class |Node| and |Element| come with</span>
<span class="sd">specialised container classes (|Nodes| and |Elements|).  The names of</span>
<span class="sd">individual nodes and elements serve as identity values, which is why</span>
<span class="sd">duplicate names are not permitted.</span>

<span class="sd">Note that module |devicetools| implements a registry mechanism both</span>
<span class="sd">for nodes and elements, preventing from instantiating an object with an</span>
<span class="sd">already assigned name.  This mechanism allows to address the same node</span>
<span class="sd">or element in different network files (see module |selectiontools|).</span>

<span class="sd">Let us take class |Node| as an example.  One can call its constructor</span>
<span class="sd">with the same name multiple times, but it returns already existing</span>
<span class="sd">nodes when available:</span>

<span class="sd">&gt;&gt;&gt; from hydpy import Node</span>
<span class="sd">&gt;&gt;&gt; node1 = Node(&#39;test1&#39;)</span>
<span class="sd">&gt;&gt;&gt; node2a = Node(&#39;test2&#39;)</span>
<span class="sd">&gt;&gt;&gt; node2b = Node(&#39;test2&#39;)</span>
<span class="sd">&gt;&gt;&gt; node1 is node2a</span>
<span class="sd">False</span>
<span class="sd">&gt;&gt;&gt; node2a is node2b</span>
<span class="sd">True</span>

<span class="sd">To get information on all currently registered nodes, call method</span>
<span class="sd">|Device.extract_new|:</span>

<span class="sd">&gt;&gt;&gt; Node.extract_new()</span>
<span class="sd">Nodes(&quot;test1&quot;, &quot;test2&quot;)</span>

<span class="sd">Method |Device.extract_new| returns only those nodes prepared or</span>
<span class="sd">recovered after its last invocation:</span>

<span class="sd">&gt;&gt;&gt; node1 = Node(&#39;test1&#39;)</span>
<span class="sd">&gt;&gt;&gt; node3a = Node(&#39;test3&#39;)</span>

<span class="sd">&gt;&gt;&gt; Node.extract_new()</span>
<span class="sd">Nodes(&quot;test1&quot;, &quot;test3&quot;)</span>

<span class="sd">For a complete list of all available nodes, use method |Device.query_all|:</span>

<span class="sd">&gt;&gt;&gt; Node.query_all()</span>
<span class="sd">Nodes(&quot;test1&quot;, &quot;test2&quot;, &quot;test3&quot;)</span>

<span class="sd">When working interactively in the Python interpreter, it might be useful</span>
<span class="sd">to clear the registry completely, sometimes.  Do this with care, because</span>
<span class="sd">defining nodes with already assigned names might result in surprises</span>
<span class="sd">due to using their names for identification:</span>

<span class="sd">&gt;&gt;&gt; nodes = Node.query_all()</span>
<span class="sd">&gt;&gt;&gt; Node.clear_all()</span>
<span class="sd">&gt;&gt;&gt; Node.query_all()</span>
<span class="sd">Nodes()</span>
<span class="sd">&gt;&gt;&gt; node3b = Node(&#39;test3&#39;)</span>
<span class="sd">&gt;&gt;&gt; node3b in nodes</span>
<span class="sd">True</span>
<span class="sd">&gt;&gt;&gt; nodes.test3.name == node3b.name</span>
<span class="sd">True</span>
<span class="sd">&gt;&gt;&gt; nodes.test3 is node3b</span>
<span class="sd">False</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1"># import...</span>
<span class="c1"># ...from standard library</span>
<span class="kn">import</span> <span class="nn">abc</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="k">import</span> <span class="o">*</span>
<span class="c1"># ...from site-packages</span>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="c1"># ...from HydPy</span>
<span class="kn">import</span> <span class="nn">hydpy</span>
<span class="kn">from</span> <span class="nn">hydpy.core.typingtools</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">hydpy.core</span> <span class="k">import</span> <span class="n">exceptiontools</span>
<span class="kn">from</span> <span class="nn">hydpy.core</span> <span class="k">import</span> <span class="n">objecttools</span>
<span class="kn">from</span> <span class="nn">hydpy.core</span> <span class="k">import</span> <span class="n">printtools</span>
<span class="kn">from</span> <span class="nn">hydpy.core</span> <span class="k">import</span> <span class="n">sequencetools</span>
<span class="kn">from</span> <span class="nn">hydpy.cythons.autogen</span> <span class="k">import</span> <span class="n">pointerutils</span>
<span class="n">pandas</span> <span class="o">=</span> <span class="n">exceptiontools</span><span class="o">.</span><span class="n">OptionalImport</span><span class="p">(</span>
    <span class="s1">&#39;pandas&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;pandas&#39;</span><span class="p">],</span> <span class="nb">locals</span><span class="p">())</span>
<span class="n">pyplot</span> <span class="o">=</span> <span class="n">exceptiontools</span><span class="o">.</span><span class="n">OptionalImport</span><span class="p">(</span>
    <span class="s1">&#39;pyplot&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;matplotlib.pyplot&#39;</span><span class="p">],</span> <span class="nb">locals</span><span class="p">())</span>
<span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">hydpy.core</span> <span class="k">import</span> <span class="n">auxfiletools</span>
    <span class="kn">from</span> <span class="nn">hydpy.core</span> <span class="k">import</span> <span class="n">modeltools</span>
    <span class="kn">from</span> <span class="nn">hydpy.core</span> <span class="k">import</span> <span class="n">timetools</span>

<span class="n">DeviceType</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;DeviceType&#39;</span><span class="p">,</span> <span class="s1">&#39;Node&#39;</span><span class="p">,</span> <span class="s1">&#39;Element&#39;</span><span class="p">)</span>
<span class="n">DevicesTypeBound</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;DevicesTypeBound&#39;</span><span class="p">,</span> <span class="n">bound</span><span class="o">=</span><span class="s1">&#39;Devices&#39;</span><span class="p">)</span>
<span class="n">DevicesTypeUnbound</span> <span class="o">=</span> <span class="n">TypeVar</span><span class="p">(</span><span class="s1">&#39;DevicesTypeUnbound&#39;</span><span class="p">,</span> <span class="s1">&#39;Nodes&#39;</span><span class="p">,</span> <span class="s1">&#39;Elements&#39;</span><span class="p">)</span>

<span class="n">NodesConstrArg</span> <span class="o">=</span> <span class="n">MayNonerable2</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
<span class="n">ElementsConstrArg</span> <span class="o">=</span> <span class="n">MayNonerable2</span><span class="p">[</span><span class="s1">&#39;Element&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
<span class="n">NodeConstrArg</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
<span class="n">ElementConstrArg</span> <span class="o">=</span> <span class="n">Union</span><span class="p">[</span><span class="s1">&#39;Element&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>


<div class="viewcode-block" id="Keywords"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Keywords">[docs]</a><span class="k">class</span> <span class="nc">Keywords</span><span class="p">(</span><span class="nb">set</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Set of keyword arguments used to describe and search for |Element| and</span>
<span class="sd">    |Node| objects.&quot;&quot;&quot;</span>

    <span class="n">device</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">,</span> <span class="s1">&#39;Element&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_keywords</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>

<div class="viewcode-block" id="Keywords.startswith"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Keywords.startswith">[docs]</a>    <span class="k">def</span> <span class="nf">startswith</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Return a list of all keywords starting with the given string.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.core.devicetools import Keywords</span>
<span class="sd">        &gt;&gt;&gt; keywords = Keywords(&#39;first_keyword&#39;, &#39;second_keyword&#39;,</span>
<span class="sd">        ...                     &#39;keyword_3&#39;, &#39;keyword_4&#39;,</span>
<span class="sd">        ...                     &#39;keyboard&#39;)</span>
<span class="sd">        &gt;&gt;&gt; keywords.startswith(&#39;keyword&#39;)</span>
<span class="sd">        [&#39;keyword_3&#39;, &#39;keyword_4&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">keyword</span> <span class="k">for</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="bp">self</span> <span class="k">if</span> <span class="n">keyword</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">name</span><span class="p">))</span></div>

<div class="viewcode-block" id="Keywords.endswith"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Keywords.endswith">[docs]</a>    <span class="k">def</span> <span class="nf">endswith</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Return a list of all keywords ending with the given string.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.core.devicetools import Keywords</span>
<span class="sd">        &gt;&gt;&gt; keywords = Keywords(&#39;first_keyword&#39;, &#39;second_keyword&#39;,</span>
<span class="sd">        ...                     &#39;keyword_3&#39;, &#39;keyword_4&#39;,</span>
<span class="sd">        ...                     &#39;keyboard&#39;)</span>
<span class="sd">        &gt;&gt;&gt; keywords.endswith(&#39;keyword&#39;)</span>
<span class="sd">        [&#39;first_keyword&#39;, &#39;second_keyword&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">keyword</span> <span class="k">for</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="bp">self</span> <span class="k">if</span> <span class="n">keyword</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">name</span><span class="p">))</span></div>

<div class="viewcode-block" id="Keywords.contains"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Keywords.contains">[docs]</a>    <span class="k">def</span> <span class="nf">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Return a list of all keywords containing the given string.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.core.devicetools import Keywords</span>
<span class="sd">        &gt;&gt;&gt; keywords = Keywords(&#39;first_keyword&#39;, &#39;second_keyword&#39;,</span>
<span class="sd">        ...                     &#39;keyword_3&#39;, &#39;keyword_4&#39;,</span>
<span class="sd">        ...                     &#39;keyboard&#39;)</span>
<span class="sd">        &gt;&gt;&gt; keywords.contains(&#39;keyword&#39;)</span>
<span class="sd">        [&#39;first_keyword&#39;, &#39;keyword_3&#39;, &#39;keyword_4&#39;, &#39;second_keyword&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">keyword</span> <span class="k">for</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="bp">self</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">keyword</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_check_keywords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
                <span class="n">objecttools</span><span class="o">.</span><span class="n">valid_variable_identifier</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">objecttools</span><span class="o">.</span><span class="n">augment_excmessage</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;While trying to add the keyword `</span><span class="si">{name}</span><span class="s1">` &#39;</span>
                <span class="n">f</span><span class="s1">&#39;to device {objecttools.devicename(self.device)}&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Keywords.update"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Keywords.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">names</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Before updating, the given names are checked to be valid</span>
<span class="sd">        variable identifiers.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.core.devicetools import Keywords</span>
<span class="sd">        &gt;&gt;&gt; keywords = Keywords(&#39;first_keyword&#39;, &#39;second_keyword&#39;,</span>
<span class="sd">        ...                     &#39;keyword_3&#39;, &#39;keyword_4&#39;,</span>
<span class="sd">        ...                     &#39;keyboard&#39;)</span>
<span class="sd">        &gt;&gt;&gt; keywords.update(&#39;test_1&#39;, &#39;test 2&#39;)   # doctest: +ELLIPSIS</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        ValueError: While trying to add the keyword `test 2` to device ?, \</span>
<span class="sd">the following error occurred: The given name string `test 2` does not \</span>
<span class="sd">define a valid variable identifier.  ...</span>

<span class="sd">        Note that even the first string (`test1`) is not added due to the</span>
<span class="sd">        second one (`test 2`) being invalid.</span>

<span class="sd">        &gt;&gt;&gt; keywords</span>
<span class="sd">        Keywords(&quot;first_keyword&quot;, &quot;keyboard&quot;, &quot;keyword_3&quot;, &quot;keyword_4&quot;,</span>
<span class="sd">                 &quot;second_keyword&quot;)</span>

<span class="sd">        After correcting the second string, everything works fine:</span>

<span class="sd">        &gt;&gt;&gt; keywords.update(&#39;test_1&#39;, &#39;test_2&#39;)</span>
<span class="sd">        &gt;&gt;&gt; keywords</span>
<span class="sd">        Keywords(&quot;first_keyword&quot;, &quot;keyboard&quot;, &quot;keyword_3&quot;, &quot;keyword_4&quot;,</span>
<span class="sd">                 &quot;second_keyword&quot;, &quot;test_1&quot;, &quot;test_2&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_names</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_keywords</span><span class="p">(</span><span class="n">_names</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">_names</span><span class="p">)</span></div>

<div class="viewcode-block" id="Keywords.add"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Keywords.add">[docs]</a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Before adding a new name, it is checked to be valid variable</span>
<span class="sd">        identifiers.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.core.devicetools import Keywords</span>
<span class="sd">        &gt;&gt;&gt; keywords = Keywords(&#39;first_keyword&#39;, &#39;second_keyword&#39;,</span>
<span class="sd">        ...                     &#39;keyword_3&#39;, &#39;keyword_4&#39;,</span>
<span class="sd">        ...                     &#39;keyboard&#39;)</span>
<span class="sd">        &gt;&gt;&gt; keywords.add(&#39;1_test&#39;)   # doctest: +ELLIPSIS</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        ValueError: While trying to add the keyword `1_test` to device ?, \</span>
<span class="sd">the following error occurred: The given name string `1_test` does not \</span>
<span class="sd">define a valid variable identifier.  ...</span>

<span class="sd">        &gt;&gt;&gt; keywords</span>
<span class="sd">        Keywords(&quot;first_keyword&quot;, &quot;keyboard&quot;, &quot;keyword_3&quot;, &quot;keyword_4&quot;,</span>
<span class="sd">                 &quot;second_keyword&quot;)</span>

<span class="sd">        After correcting the string, everything works fine:</span>

<span class="sd">        &gt;&gt;&gt; keywords.add(&#39;one_test&#39;)</span>
<span class="sd">        &gt;&gt;&gt; keywords</span>
<span class="sd">        Keywords(&quot;first_keyword&quot;, &quot;keyboard&quot;, &quot;keyword_3&quot;, &quot;keyword_4&quot;,</span>
<span class="sd">                 &quot;one_test&quot;, &quot;second_keyword&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_keywords</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">)])</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">))</span></div>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">with</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">repr_</span><span class="o">.</span><span class="n">preserve_strings</span><span class="p">(</span><span class="kc">True</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">assignrepr_values</span><span class="p">(</span>
                <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="s1">&#39;Keywords(&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span>

    <span class="fm">__dir__</span> <span class="o">=</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">dir_</span></div>


<div class="viewcode-block" id="Devices"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Devices">[docs]</a><span class="k">class</span> <span class="nc">Devices</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">DeviceType</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Base class for class |Elements| and class |Nodes|.</span>

<span class="sd">    The following features are common to class |Nodes| and class</span>
<span class="sd">    |Elements|.  We arbitrarily select class |Nodes| for all examples.</span>

<span class="sd">    To initialise a |Nodes| collection class, pass a variable number of</span>
<span class="sd">    |str| or |Node| objects.  Strings are used to create new or query</span>
<span class="sd">    already existing nodes automatically:</span>

<span class="sd">    &gt;&gt;&gt; from hydpy import Node, Nodes</span>
<span class="sd">    &gt;&gt;&gt; nodes = Nodes(&#39;na&#39;,</span>
<span class="sd">    ...               Node(&#39;nb&#39;, variable=&#39;W&#39;),</span>
<span class="sd">    ...               Node(&#39;nc&#39;, keywords=(&#39;group_a&#39;, &#39;group_1&#39;)),</span>
<span class="sd">    ...               Node(&#39;nd&#39;, keywords=(&#39;group_a&#39;, &#39;group_2&#39;)),</span>
<span class="sd">    ...               Node(&#39;ne&#39;, keywords=(&#39;group_b&#39;, &#39;group_1&#39;)))</span>

<span class="sd">    |Nodes| and |Elements| objects are containers supporting attribute</span>
<span class="sd">    access. You can access each node or element directly by its name:</span>

<span class="sd">    &gt;&gt;&gt; nodes.na</span>
<span class="sd">    Node(&quot;na&quot;, variable=&quot;Q&quot;)</span>

<span class="sd">    Wrong node names result in the following error message:</span>

<span class="sd">    &gt;&gt;&gt; nodes.wrong</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    ...</span>
<span class="sd">    AttributeError: The selected Nodes object has neither a `wrong` \</span>
<span class="sd">attribute nor does it handle a Node object with name or keyword `wrong`, \</span>
<span class="sd">which could be returned.</span>

<span class="sd">    As explained in more detail in the documentation on property</span>
<span class="sd">    |Device.keywords|, you can also use the keywords of the individual</span>
<span class="sd">    nodes to query the relevant ones:</span>

<span class="sd">    &gt;&gt;&gt; nodes.group_a</span>
<span class="sd">    Nodes(&quot;nc&quot;, &quot;nd&quot;)</span>

<span class="sd">    Especially in this context, you might find it useful to also get an</span>
<span class="sd">    iterable object in case no node or only a single node is available:</span>

<span class="sd">    &gt;&gt;&gt; Nodes.forceiterable = True</span>
<span class="sd">    &gt;&gt;&gt; nodes.wrong</span>
<span class="sd">    Nodes()</span>
<span class="sd">    &gt;&gt;&gt; nodes.na</span>
<span class="sd">    Nodes(&quot;na&quot;)</span>
<span class="sd">    &gt;&gt;&gt; Nodes.forceiterable = False</span>

<span class="sd">    Attribute deleting is supported:</span>

<span class="sd">    &gt;&gt;&gt; &#39;na&#39; in nodes</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; del nodes.na</span>
<span class="sd">    &gt;&gt;&gt; &#39;na&#39; in nodes</span>
<span class="sd">    False</span>
<span class="sd">    &gt;&gt;&gt; del nodes.na</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    ...</span>
<span class="sd">    AttributeError: The actual Nodes object does not handle \</span>
<span class="sd">a Node object named `na` which could be removed, and deleting \</span>
<span class="sd">other attributes is not supported.</span>

<span class="sd">    However, shown  by the next example, setting devices via attribute</span>
<span class="sd">    access could result in inconsistencies and is not allowed (see method</span>
<span class="sd">    |Devices.add_device| instead):</span>

<span class="sd">    &gt;&gt;&gt; nodes.NF = Node(&#39;nf&#39;)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    ...</span>
<span class="sd">    AttributeError: Setting attributes of Nodes objects could result \</span>
<span class="sd">in confusion whether a new attribute should be handled as a Node object or \</span>
<span class="sd">as a &quot;normal&quot; attribute and is thus not support, hence `NF` is rejected.</span>

<span class="sd">    |Nodes| and |Elements| objects support iteration:</span>

<span class="sd">    &gt;&gt;&gt; len(nodes)</span>
<span class="sd">    4</span>
<span class="sd">    &gt;&gt;&gt; for node in nodes:</span>
<span class="sd">    ...     print(node.name, end=&#39;,&#39;)</span>
<span class="sd">    nb,nc,nd,ne,</span>

<span class="sd">    The binary operators `+`, `+=`, `-` and `-=` support adding and removing</span>
<span class="sd">    single devices or groups of devices:</span>

<span class="sd">    &gt;&gt;&gt; nodes</span>
<span class="sd">    Nodes(&quot;nb&quot;, &quot;nc&quot;, &quot;nd&quot;, &quot;ne&quot;)</span>
<span class="sd">    &gt;&gt;&gt; nodes - Node(&quot;nc&quot;)</span>
<span class="sd">    Nodes(&quot;nb&quot;, &quot;nd&quot;, &quot;ne&quot;)</span>

<span class="sd">    Nodes(&quot;nb&quot;, &quot;nc&quot;, &quot;nd&quot;, &quot;ne&quot;)</span>
<span class="sd">    &gt;&gt;&gt; nodes -= Nodes(&quot;nc&quot;, &quot;ne&quot;)</span>
<span class="sd">    &gt;&gt;&gt; nodes</span>
<span class="sd">    Nodes(&quot;nb&quot;, &quot;nd&quot;)</span>

<span class="sd">    &gt;&gt;&gt; nodes + &quot;nc&quot;</span>
<span class="sd">    Nodes(&quot;nb&quot;, &quot;nc&quot;, &quot;nd&quot;)</span>
<span class="sd">    &gt;&gt;&gt; nodes</span>
<span class="sd">    Nodes(&quot;nb&quot;, &quot;nd&quot;)</span>
<span class="sd">    &gt;&gt;&gt; nodes += (&quot;nc&quot;, Node(&quot;ne&quot;))</span>
<span class="sd">    &gt;&gt;&gt; nodes</span>
<span class="sd">    Nodes(&quot;nb&quot;, &quot;nc&quot;, &quot;nd&quot;, &quot;ne&quot;)</span>

<span class="sd">    Attempts to add already existing or to remove non-existing devices</span>
<span class="sd">    do no harm:</span>

<span class="sd">    &gt;&gt;&gt; nodes</span>
<span class="sd">    Nodes(&quot;nb&quot;, &quot;nc&quot;, &quot;nd&quot;, &quot;ne&quot;)</span>
<span class="sd">    &gt;&gt;&gt; nodes + (&quot;nc&quot;, &quot;ne&quot;)</span>
<span class="sd">    Nodes(&quot;nb&quot;, &quot;nc&quot;, &quot;nd&quot;, &quot;ne&quot;)</span>
<span class="sd">    &gt;&gt;&gt; nodes - Node(&#39;na&#39;)</span>
<span class="sd">    Nodes(&quot;nb&quot;, &quot;nc&quot;, &quot;nd&quot;, &quot;ne&quot;)</span>

<span class="sd">    Comparisons are supported, with &quot;x &lt; y&quot; being |True|, if &quot;x&quot; is</span>
<span class="sd">    a subset of &quot;y&quot;:</span>

<span class="sd">    &gt;&gt;&gt; subgroup = Nodes(&quot;nc&quot;, &quot;ne&quot;)</span>
<span class="sd">    &gt;&gt;&gt; subgroup &lt; nodes, nodes &lt; subgroup, nodes &lt; nodes</span>
<span class="sd">    (True, False, False)</span>
<span class="sd">    &gt;&gt;&gt; subgroup &lt;= nodes, nodes &lt;= subgroup, nodes &lt;= nodes</span>
<span class="sd">    (True, False, True)</span>
<span class="sd">    &gt;&gt;&gt; subgroup == nodes, nodes == subgroup, nodes == nodes, nodes == &#39;nodes&#39;</span>
<span class="sd">    (False, False, True, False)</span>
<span class="sd">    &gt;&gt;&gt; subgroup != nodes, nodes != subgroup, nodes != nodes, nodes != &#39;nodes&#39;</span>
<span class="sd">    (True, True, False, True)</span>
<span class="sd">    &gt;&gt;&gt; subgroup &gt;= nodes, nodes &gt;= subgroup, nodes &gt;= nodes</span>
<span class="sd">    (False, True, True)</span>
<span class="sd">    &gt;&gt;&gt; subgroup &gt; nodes, nodes &gt; subgroup, nodes &gt; nodes</span>
<span class="sd">    (False, True, False)</span>

<span class="sd">    Passing wrong arguments to the constructor of class |Node| results</span>
<span class="sd">    in errors like the following:</span>

<span class="sd">    &gt;&gt;&gt; from hydpy import Element</span>
<span class="sd">    &gt;&gt;&gt; Nodes(&#39;na&#39;, Element(&#39;ea&#39;))</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    ...</span>
<span class="sd">    TypeError: While trying to initialise a `Nodes` object, the following \</span>
<span class="sd">error occurred: The given (sub)value `Element(&quot;ea&quot;)` is not an instance \</span>
<span class="sd">of the following classes: node and str.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_name2device</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">DeviceType</span><span class="p">]</span>
    <span class="n">mutable</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="n">_shadowed_keywords</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">forceiterable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">values</span><span class="p">:</span> <span class="n">MayNonerable2</span><span class="p">[</span><span class="n">DeviceType</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
                <span class="n">mutable</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">cls</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
        <span class="n">dict_</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">dict_</span><span class="p">[</span><span class="s1">&#39;mutable&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mutable</span>
        <span class="n">dict_</span><span class="p">[</span><span class="s1">&#39;_name2device&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">dict_</span><span class="p">[</span><span class="s1">&#39;_shadowed_keywords&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">contentclass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_contentclass</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span>
                    <span class="n">values</span><span class="p">,</span> <span class="n">types_</span><span class="o">=</span><span class="p">(</span><span class="n">contentclass</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="n">skip</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_device</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
            <span class="n">objecttools</span><span class="o">.</span><span class="n">augment_excmessage</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;While trying to initialise a &#39;</span>
                <span class="n">f</span><span class="s1">&#39;`{objecttools.classname(self)}` object&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

<div class="viewcode-block" id="Devices.get_contentclass"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Devices.get_contentclass">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">get_contentclass</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;To be overridden.&quot;&quot;&quot;</span></div>

<div class="viewcode-block" id="Devices.add_device"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Devices.add_device">[docs]</a>    <span class="k">def</span> <span class="nf">add_device</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">DeviceType</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add the given |Node| or |Element| object to the actual</span>
<span class="sd">        |Nodes| or |Elements| object.</span>

<span class="sd">        You can pass either a string or a device:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Nodes</span>
<span class="sd">        &gt;&gt;&gt; nodes = Nodes()</span>
<span class="sd">        &gt;&gt;&gt; nodes.add_device(&#39;old_node&#39;)</span>
<span class="sd">        &gt;&gt;&gt; nodes</span>
<span class="sd">        Nodes(&quot;old_node&quot;)</span>
<span class="sd">        &gt;&gt;&gt; nodes.add_device(&#39;new_node&#39;)</span>
<span class="sd">        &gt;&gt;&gt; nodes</span>
<span class="sd">        Nodes(&quot;new_node&quot;, &quot;old_node&quot;)</span>

<span class="sd">        Method |Devices.add_device| is disabled for immutable |Nodes|</span>
<span class="sd">        and |Elements| objects:</span>

<span class="sd">        &gt;&gt;&gt; nodes.mutable = False</span>
<span class="sd">        &gt;&gt;&gt; nodes.add_device(&#39;newest_node&#39;)</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        RuntimeError: While trying to add the device `newest_node` to a \</span>
<span class="sd">Nodes object, the following error occurred: Adding devices to immutable \</span>
<span class="sd">Nodes objects is not allowed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mutable</span><span class="p">:</span>
                <span class="n">_device</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_contentclass</span><span class="p">()(</span><span class="n">device</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_name2device</span><span class="p">[</span><span class="n">_device</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">_device</span>
                <span class="n">_id2devices</span><span class="p">[</span><span class="n">_device</span><span class="p">][</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="p">)]</span> <span class="o">=</span> <span class="bp">self</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="n">f</span><span class="s1">&#39;Adding devices to immutable &#39;</span>
                    <span class="n">f</span><span class="s1">&#39;{objecttools.classname(self)} objects is not allowed.&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
            <span class="n">objecttools</span><span class="o">.</span><span class="n">augment_excmessage</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;While trying to add the device `</span><span class="si">{device}</span><span class="s1">` to a &#39;</span>
                <span class="n">f</span><span class="s1">&#39;{objecttools.classname(self)} object&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Devices.remove_device"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Devices.remove_device">[docs]</a>    <span class="k">def</span> <span class="nf">remove_device</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">device</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">DeviceType</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Remove the given |Node| or |Element| object from the actual</span>
<span class="sd">        |Nodes| or |Elements| object.</span>

<span class="sd">        You can pass either a string or a device:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Node, Nodes</span>
<span class="sd">        &gt;&gt;&gt; nodes = Nodes(&#39;node_x&#39;, &#39;node_y&#39;)</span>
<span class="sd">        &gt;&gt;&gt; node_x, node_y = nodes</span>
<span class="sd">        &gt;&gt;&gt; nodes.remove_device(Node(&#39;node_y&#39;))</span>
<span class="sd">        &gt;&gt;&gt; nodes</span>
<span class="sd">        Nodes(&quot;node_x&quot;)</span>
<span class="sd">        &gt;&gt;&gt; nodes.remove_device(Node(&#39;node_x&#39;))</span>
<span class="sd">        &gt;&gt;&gt; nodes</span>
<span class="sd">        Nodes()</span>
<span class="sd">        &gt;&gt;&gt; nodes.remove_device(Node(&#39;node_z&#39;))</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        ValueError: While trying to remove the device `node_z` from a \</span>
<span class="sd">Nodes object, the following error occurred: The actual Nodes object does \</span>
<span class="sd">not handle such a device.</span>

<span class="sd">        Method |Devices.remove_device| is disabled for immutable |Nodes|</span>
<span class="sd">        and |Elements| objects:</span>

<span class="sd">        &gt;&gt;&gt; nodes.mutable = False</span>
<span class="sd">        &gt;&gt;&gt; nodes.remove_device(&#39;node_z&#39;)</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        RuntimeError: While trying to remove the device `node_z` from a \</span>
<span class="sd">Nodes object, the following error occurred: Removing devices from \</span>
<span class="sd">immutable Nodes objects is not allowed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mutable</span><span class="p">:</span>
                <span class="n">_device</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_contentclass</span><span class="p">()(</span><span class="n">device</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name2device</span><span class="p">[</span><span class="n">_device</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="n">f</span><span class="s1">&#39;The actual {objecttools.classname(self)} &#39;</span>
                        <span class="n">f</span><span class="s1">&#39;object does not handle such a device.&#39;</span><span class="p">)</span>
                <span class="k">del</span> <span class="n">_id2devices</span><span class="p">[</span><span class="n">_device</span><span class="p">][</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="n">f</span><span class="s1">&#39;Removing devices from immutable &#39;</span>
                    <span class="n">f</span><span class="s1">&#39;{objecttools.classname(self)} objects is not allowed.&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
            <span class="n">objecttools</span><span class="o">.</span><span class="n">augment_excmessage</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;While trying to remove the device `</span><span class="si">{device}</span><span class="s1">` from a &#39;</span>
                <span class="n">f</span><span class="s1">&#39;{objecttools.classname(self)} object&#39;</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">names</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;A sorted tuple of the names of the handled devices.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Nodes</span>
<span class="sd">        &gt;&gt;&gt; Nodes(&#39;a&#39;, &#39;c&#39;, &#39;b&#39;).names</span>
<span class="sd">        (&#39;a&#39;, &#39;b&#39;, &#39;c&#39;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">device</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">devices</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">DeviceType</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;A tuple of the handled devices sorted by the device names.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Nodes</span>
<span class="sd">        &gt;&gt;&gt; for node in Nodes(&#39;a&#39;, &#39;c&#39;, &#39;b&#39;).devices:</span>
<span class="sd">        ...     print(repr(node))</span>
<span class="sd">        Node(&quot;a&quot;, variable=&quot;Q&quot;)</span>
<span class="sd">        Node(&quot;b&quot;, variable=&quot;Q&quot;)</span>
<span class="sd">        Node(&quot;c&quot;, variable=&quot;Q&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">device</span> <span class="k">for</span> <span class="n">device</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">keywords</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;A set of all keywords of all handled devices.</span>

<span class="sd">        In addition to attribute access via device names, |Nodes| and</span>
<span class="sd">        |Elements| objects allow for attribute access via keywords,</span>
<span class="sd">        allowing for an efficient search of certain groups of devices.</span>
<span class="sd">        Let us use the example from above, where the nodes `na` and `nb`</span>
<span class="sd">        have no keywords, but each of the other three nodes both belongs</span>
<span class="sd">        to either `group_a` or `group_b` and `group_1` or `group_2`:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Node, Nodes</span>
<span class="sd">        &gt;&gt;&gt; nodes = Nodes(&#39;na&#39;,</span>
<span class="sd">        ...               Node(&#39;nb&#39;, variable=&#39;W&#39;),</span>
<span class="sd">        ...               Node(&#39;nc&#39;, keywords=(&#39;group_a&#39;, &#39;group_1&#39;)),</span>
<span class="sd">        ...               Node(&#39;nd&#39;, keywords=(&#39;group_a&#39;, &#39;group_2&#39;)),</span>
<span class="sd">        ...               Node(&#39;ne&#39;, keywords=(&#39;group_b&#39;, &#39;group_1&#39;)))</span>
<span class="sd">        &gt;&gt;&gt; nodes</span>
<span class="sd">        Nodes(&quot;na&quot;, &quot;nb&quot;, &quot;nc&quot;, &quot;nd&quot;, &quot;ne&quot;)</span>
<span class="sd">        &gt;&gt;&gt; sorted(nodes.keywords)</span>
<span class="sd">        [&#39;group_1&#39;, &#39;group_2&#39;, &#39;group_a&#39;, &#39;group_b&#39;]</span>

<span class="sd">        If you are interested in inspecting all devices belonging to</span>
<span class="sd">        `group_a`, select them via this keyword:</span>

<span class="sd">        &gt;&gt;&gt; subgroup = nodes.group_1</span>
<span class="sd">        &gt;&gt;&gt; subgroup</span>
<span class="sd">        Nodes(&quot;nc&quot;, &quot;ne&quot;)</span>

<span class="sd">        You can further restrict the search by also selecting the devices</span>
<span class="sd">        belonging to `group_b`, which holds only for node &quot;e&quot;, in the given</span>
<span class="sd">        example:</span>

<span class="sd">        &gt;&gt;&gt; subsubgroup = subgroup.group_b</span>
<span class="sd">        &gt;&gt;&gt; subsubgroup</span>
<span class="sd">        Node(&quot;ne&quot;, variable=&quot;Q&quot;,</span>
<span class="sd">             keywords=[&quot;group_1&quot;, &quot;group_b&quot;])</span>

<span class="sd">        Note that the keywords already used for building a device subgroup</span>
<span class="sd">        are not informative anymore (as they hold for each device) and are</span>
<span class="sd">        thus not shown anymore:</span>

<span class="sd">        &gt;&gt;&gt; sorted(subgroup.keywords)</span>
<span class="sd">        [&#39;group_a&#39;, &#39;group_b&#39;]</span>

<span class="sd">        The latter might be confusing if you intend to work with a device</span>
<span class="sd">        subgroup for a longer time.  After copying the subgroup, all</span>
<span class="sd">        keywords of the contained devices are available again:</span>

<span class="sd">        &gt;&gt;&gt; from copy import copy</span>
<span class="sd">        &gt;&gt;&gt; newgroup = copy(subgroup)</span>
<span class="sd">        &gt;&gt;&gt; sorted(newgroup.keywords)</span>
<span class="sd">        [&#39;group_1&#39;, &#39;group_a&#39;, &#39;group_b&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="n">keyword</span> <span class="k">for</span> <span class="n">device</span> <span class="ow">in</span> <span class="bp">self</span>
                   <span class="k">for</span> <span class="n">keyword</span> <span class="ow">in</span> <span class="n">device</span><span class="o">.</span><span class="n">keywords</span> <span class="k">if</span>
                   <span class="n">keyword</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shadowed_keywords</span><span class="p">)</span>

<div class="viewcode-block" id="Devices.search_keywords"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Devices.search_keywords">[docs]</a>    <span class="k">def</span> <span class="nf">search_keywords</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">DevicesTypeBound</span><span class="p">,</span> <span class="o">*</span><span class="n">keywords</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">DevicesTypeBound</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Search for all devices handling at least one of the given</span>
<span class="sd">        keywords and return them.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Node, Nodes</span>
<span class="sd">        &gt;&gt;&gt; nodes = Nodes(&#39;na&#39;,</span>
<span class="sd">        ...               Node(&#39;nb&#39;, variable=&#39;W&#39;),</span>
<span class="sd">        ...               Node(&#39;nc&#39;, keywords=(&#39;group_a&#39;, &#39;group_1&#39;)),</span>
<span class="sd">        ...               Node(&#39;nd&#39;, keywords=(&#39;group_a&#39;, &#39;group_2&#39;)),</span>
<span class="sd">        ...               Node(&#39;ne&#39;, keywords=(&#39;group_b&#39;, &#39;group_1&#39;)))</span>
<span class="sd">        &gt;&gt;&gt; nodes.search_keywords(&#39;group_c&#39;)</span>
<span class="sd">        Nodes()</span>
<span class="sd">        &gt;&gt;&gt; nodes.search_keywords(&#39;group_a&#39;)</span>
<span class="sd">        Nodes(&quot;nc&quot;, &quot;nd&quot;)</span>
<span class="sd">        &gt;&gt;&gt; nodes.search_keywords(&#39;group_a&#39;, &#39;group_1&#39;)</span>
<span class="sd">        Nodes(&quot;nc&quot;, &quot;nd&quot;, &quot;ne&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">keywords_</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">keywords</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="o">*</span><span class="p">(</span><span class="n">device</span> <span class="k">for</span> <span class="n">device</span> <span class="ow">in</span> <span class="bp">self</span>
                            <span class="k">if</span> <span class="n">keywords_</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">device</span><span class="o">.</span><span class="n">keywords</span><span class="p">)))</span></div>

<div class="viewcode-block" id="Devices.open_files"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Devices.open_files">[docs]</a>    <span class="k">def</span> <span class="nf">open_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Call method |Node.open_files| or |Element.open_files| of all</span>
<span class="sd">        contained |Node| or |Element| objects.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">device</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">device</span><span class="o">.</span><span class="n">open_files</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span></div>

<div class="viewcode-block" id="Devices.close_files"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Devices.close_files">[docs]</a>    <span class="k">def</span> <span class="nf">close_files</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Call method |Node.close_files| or |Element.close_files| of</span>
<span class="sd">        all contained |Node| or |Element| objects.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">device</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">device</span><span class="o">.</span><span class="n">close_files</span><span class="p">()</span></div>

<div class="viewcode-block" id="Devices.copy"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Devices.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">DevicesTypeBound</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DevicesTypeBound</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return a shallow copy of the actual |Nodes| or |Elements| object.</span>

<span class="sd">        Method |Devices.copy| returns a semi-flat copy of |Nodes| or</span>
<span class="sd">        |Elements| objects, due to their devices being not copyable:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Nodes</span>
<span class="sd">        &gt;&gt;&gt; old = Nodes(&#39;x&#39;, &#39;y&#39;)</span>
<span class="sd">        &gt;&gt;&gt; import copy</span>
<span class="sd">        &gt;&gt;&gt; new = copy.copy(old)</span>
<span class="sd">        &gt;&gt;&gt; new == old</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; new is old</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; new.devices is old.devices</span>
<span class="sd">        False</span>
<span class="sd">        &gt;&gt;&gt; new.x is new.x</span>
<span class="sd">        True</span>

<span class="sd">        Changing the |Device.name| of a device is recognised both by the</span>
<span class="sd">        original and the copied collection objects:</span>

<span class="sd">        &gt;&gt;&gt; new.x.name = &#39;z&#39;</span>
<span class="sd">        &gt;&gt;&gt; old.z</span>
<span class="sd">        Node(&quot;z&quot;, variable=&quot;Q&quot;)</span>
<span class="sd">        &gt;&gt;&gt; new.z</span>
<span class="sd">        Node(&quot;z&quot;, variable=&quot;Q&quot;)</span>

<span class="sd">        Deep copying is permitted due to the above reason:</span>

<span class="sd">        &gt;&gt;&gt; copy.deepcopy(old)</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        NotImplementedError: Deep copying of Nodes objects is not supported, \</span>
<span class="sd">as it would require to make deep copies of the Node objects themselves, \</span>
<span class="sd">which is in conflict with using their names as identifiers.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)()</span>
        <span class="nb">vars</span><span class="p">(</span><span class="n">new</span><span class="p">)</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
        <span class="nb">vars</span><span class="p">(</span><span class="n">new</span><span class="p">)[</span><span class="s1">&#39;_name2device&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_name2device</span><span class="p">)</span>
        <span class="nb">vars</span><span class="p">(</span><span class="n">new</span><span class="p">)[</span><span class="s1">&#39;_shadowed_keywords&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">device</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">_id2devices</span><span class="p">[</span><span class="n">device</span><span class="p">][</span><span class="nb">id</span><span class="p">(</span><span class="n">new</span><span class="p">)]</span> <span class="o">=</span> <span class="n">new</span>
        <span class="k">return</span> <span class="n">new</span></div>

    <span class="n">__copy__</span> <span class="o">=</span> <span class="n">copy</span>

    <span class="k">def</span> <span class="nf">__deepcopy__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dict_</span><span class="p">):</span>
        <span class="n">classname</span> <span class="o">=</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">classname</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
            <span class="n">f</span><span class="s1">&#39;Deep copying of </span><span class="si">{classname}</span><span class="s1"> objects is not supported, as it &#39;</span>
            <span class="n">f</span><span class="s1">&#39;would require to make deep copies of the </span><span class="si">{classname[:-1]}</span><span class="s1"> &#39;</span>
            <span class="n">f</span><span class="s1">&#39;objects themselves, which is in conflict with using their &#39;</span>
            <span class="n">f</span><span class="s1">&#39;names as identifiers.&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__select_devices_by_keyword</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="n">devices</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="o">*</span><span class="p">(</span><span class="n">device</span> <span class="k">for</span> <span class="n">device</span> <span class="ow">in</span> <span class="bp">self</span>
                               <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">device</span><span class="o">.</span><span class="n">keywords</span><span class="p">))</span>
        <span class="nb">vars</span><span class="p">(</span><span class="n">devices</span><span class="p">)[</span><span class="s1">&#39;_shadowed_keywords&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_shadowed_keywords</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="nb">vars</span><span class="p">(</span><span class="n">devices</span><span class="p">)[</span><span class="s1">&#39;_shadowed_keywords&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">devices</span>

    <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">name2device</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name2device</span>
            <span class="n">name2device</span> <span class="o">=</span> <span class="n">name2device</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">forceiterable</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">name2device</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">name2device</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="n">_devices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__select_devices_by_keyword</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">forceiterable</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">_devices</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_devices</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">_devices</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_devices</span><span class="o">.</span><span class="n">devices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
            <span class="n">f</span><span class="s1">&#39;The selected {objecttools.classname(self)} object has &#39;</span>
            <span class="n">f</span><span class="s1">&#39;neither a `</span><span class="si">{name}</span><span class="s1">` attribute nor does it handle a &#39;</span>
            <span class="n">f</span><span class="s1">&#39;{objecttools.classname(self.get_contentclass())} object with &#39;</span>
            <span class="n">f</span><span class="s1">&#39;name or keyword `</span><span class="si">{name}</span><span class="s1">`, which could be returned.&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">classname</span> <span class="o">=</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">classname</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;Setting attributes of </span><span class="si">{classname}</span><span class="s1"> objects could result in &#39;</span>
                <span class="n">f</span><span class="s1">&#39;confusion whether a new attribute should be handled as a &#39;</span>
                <span class="n">f</span><span class="s1">&#39;</span><span class="si">{classname[:-1]}</span><span class="s1"> object or as a &quot;normal&quot; attribute and is &#39;</span>
                <span class="n">f</span><span class="s1">&#39;thus not support, hence `</span><span class="si">{name}</span><span class="s1">` is rejected.&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__delattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove_device</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;The actual {objecttools.classname(self)} object does not &#39;</span>
                <span class="n">f</span><span class="s1">&#39;handle a {objecttools.classname(self.get_contentclass())} &#39;</span>
                <span class="n">f</span><span class="s1">&#39;object named `</span><span class="si">{name}</span><span class="s1">` which could be removed, and deleting &#39;</span>
                <span class="n">f</span><span class="s1">&#39;other attributes is not supported.&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DeviceType</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name2device</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;No node named `</span><span class="si">{name}</span><span class="s1">` available.&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__setitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">DeviceType</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name2device</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">__delitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name2device</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="n">DeviceType</span><span class="p">]:</span>
        <span class="k">for</span> <span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_name2device</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">yield</span> <span class="n">device</span>

    <span class="k">def</span> <span class="nf">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">Mayberable2</span><span class="p">[</span><span class="n">DeviceType</span><span class="p">,</span> <span class="nb">str</span><span class="p">]):</span>
        <span class="n">device</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_contentclass</span><span class="p">()(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">device</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name2device</span>

    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_name2device</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">DevicesTypeBound</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Mayberable2</span><span class="p">[</span><span class="n">DeviceType</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> \
            <span class="o">-&gt;</span> <span class="n">DevicesTypeBound</span><span class="p">:</span>
        <span class="n">new</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">device</span> <span class="ow">in</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">other</span><span class="p">):</span>
            <span class="n">new</span><span class="o">.</span><span class="n">add_device</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new</span>

    <span class="k">def</span> <span class="nf">__iadd__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">DevicesTypeBound</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Mayberable2</span><span class="p">[</span><span class="n">DeviceType</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> \
            <span class="o">-&gt;</span> <span class="n">DevicesTypeBound</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">device</span> <span class="ow">in</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">other</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_device</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">__sub__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">DevicesTypeBound</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Mayberable2</span><span class="p">[</span><span class="n">DeviceType</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> \
            <span class="o">-&gt;</span> <span class="n">DevicesTypeBound</span><span class="p">:</span>
        <span class="n">new</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">device</span> <span class="ow">in</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">other</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">new</span><span class="o">.</span><span class="n">remove_device</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">return</span> <span class="n">new</span>

    <span class="k">def</span> <span class="nf">__isub__</span><span class="p">(</span><span class="bp">self</span><span class="p">:</span> <span class="n">DevicesTypeBound</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Mayberable2</span><span class="p">[</span><span class="n">DeviceType</span><span class="p">,</span> <span class="nb">str</span><span class="p">])</span> \
            <span class="o">-&gt;</span> <span class="n">DevicesTypeBound</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">device</span> <span class="ow">in</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)(</span><span class="n">other</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">remove_device</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span> <span class="nf">__compare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)):</span>
            <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="n">func</span><span class="p">)(</span><span class="nb">set</span><span class="p">(</span><span class="n">other</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">NotImplemented</span>

    <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__compare</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s1">&#39;__lt__&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__compare</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s1">&#39;__le__&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__compare</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s1">&#39;__eq__&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Any</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__compare</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s1">&#39;__ne__&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">DeviceType</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__compare</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s1">&#39;__ge__&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">DeviceType</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__compare</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="s1">&#39;__gt__&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">assignrepr</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Devices.assignrepr"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Devices.assignrepr">[docs]</a>    <span class="k">def</span> <span class="nf">assignrepr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return a |repr| string with a prefixed assignment.&quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">repr_</span><span class="o">.</span><span class="n">preserve_strings</span><span class="p">(</span><span class="kc">True</span><span class="p">):</span>
            <span class="k">with</span> <span class="n">hydpy</span><span class="o">.</span><span class="n">pub</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">ellipsis</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
                <span class="n">prefix</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">(&#39;</span> <span class="o">%</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">classname</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="n">repr_</span> <span class="o">=</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">assignrepr_values</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">,</span> <span class="n">prefix</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">repr_</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span></div>

    <span class="k">def</span> <span class="nf">__dir__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Just a regression test:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Node, Nodes</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.core.objecttools import assignrepr_values</span>
<span class="sd">        &gt;&gt;&gt; nodes = Nodes(Node(&#39;name1&#39;, keywords=&#39;keyword1&#39;),</span>
<span class="sd">        ...               Node(&#39;name2&#39;, keywords=(&#39;keyword2a&#39;, &#39;keyword2a&#39;)))</span>
<span class="sd">        &gt;&gt;&gt; print(assignrepr_values(dir(nodes), &#39;&#39;, 70))</span>
<span class="sd">        add_device, assignrepr, close_files, copy, devices, forceiterable,</span>
<span class="sd">        get_contentclass, keyword1, keyword2a, keywords, load_allseries,</span>
<span class="sd">        load_obsseries, load_simseries, mutable, name1, name2, names,</span>
<span class="sd">        open_files, prepare_allseries, prepare_obsseries, prepare_simseries,</span>
<span class="sd">        remove_device, save_allseries, save_obsseries, save_simseries,</span>
<span class="sd">        search_keywords, variables</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">dir_</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keywords</span><span class="p">)</span></div>


<div class="viewcode-block" id="Nodes"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Nodes">[docs]</a><span class="k">class</span> <span class="nc">Nodes</span><span class="p">(</span><span class="n">Devices</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;A container class for handling |Node| objects.</span>

<span class="sd">    For the general usage of |Nodes| objects, please see the documentation</span>
<span class="sd">    on its base class |Devices|.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Nodes.get_contentclass"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Nodes.get_contentclass">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_contentclass</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="s1">&#39;Node&#39;</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Return class |Node|.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Node</span></div>

<div class="viewcode-block" id="Nodes.prepare_allseries"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Nodes.prepare_allseries">[docs]</a>    <span class="nd">@printtools</span><span class="o">.</span><span class="n">print_progress</span>
    <span class="k">def</span> <span class="nf">prepare_allseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ramflag</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Call methods |Node.prepare_simseries| and</span>
<span class="sd">        |Node.prepare_obsseries|.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">printtools</span><span class="o">.</span><span class="n">progressbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">node</span><span class="o">.</span><span class="n">prepare_allseries</span><span class="p">(</span><span class="n">ramflag</span><span class="p">)</span></div>

<div class="viewcode-block" id="Nodes.prepare_simseries"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Nodes.prepare_simseries">[docs]</a>    <span class="nd">@printtools</span><span class="o">.</span><span class="n">print_progress</span>
    <span class="k">def</span> <span class="nf">prepare_simseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ramflag</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Call method |Node.prepare_simseries| of all handled</span>
<span class="sd">        |Node| objects.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">printtools</span><span class="o">.</span><span class="n">progressbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">node</span><span class="o">.</span><span class="n">prepare_simseries</span><span class="p">(</span><span class="n">ramflag</span><span class="p">)</span></div>

<div class="viewcode-block" id="Nodes.prepare_obsseries"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Nodes.prepare_obsseries">[docs]</a>    <span class="nd">@printtools</span><span class="o">.</span><span class="n">print_progress</span>
    <span class="k">def</span> <span class="nf">prepare_obsseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ramflag</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Call method |Node.prepare_obsseries| of all handled</span>
<span class="sd">        |Node| objects.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">printtools</span><span class="o">.</span><span class="n">progressbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">node</span><span class="o">.</span><span class="n">prepare_obsseries</span><span class="p">(</span><span class="n">ramflag</span><span class="p">)</span></div>

<div class="viewcode-block" id="Nodes.load_allseries"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Nodes.load_allseries">[docs]</a>    <span class="nd">@printtools</span><span class="o">.</span><span class="n">print_progress</span>
    <span class="k">def</span> <span class="nf">load_allseries</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Call methods |Nodes.load_simseries| and |Nodes.load_obsseries|.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_simseries</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_obsseries</span><span class="p">()</span></div>

<div class="viewcode-block" id="Nodes.load_simseries"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Nodes.load_simseries">[docs]</a>    <span class="nd">@printtools</span><span class="o">.</span><span class="n">print_progress</span>
    <span class="k">def</span> <span class="nf">load_simseries</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Call method |IOSequence.load_ext| of all |Sim| objects</span>
<span class="sd">        with an activated |IOSequence.memoryflag|.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__load_nodeseries</span><span class="p">(</span><span class="s1">&#39;sim&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Nodes.load_obsseries"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Nodes.load_obsseries">[docs]</a>    <span class="nd">@printtools</span><span class="o">.</span><span class="n">print_progress</span>
    <span class="k">def</span> <span class="nf">load_obsseries</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Call method |IOSequence.load_ext| of all |Obs| objects</span>
<span class="sd">        with an activated |IOSequence.memoryflag|.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__load_nodeseries</span><span class="p">(</span><span class="s1">&#39;obs&#39;</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__load_nodeseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seqname</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">printtools</span><span class="o">.</span><span class="n">progressbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="nb">getattr</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">sequences</span><span class="p">,</span> <span class="n">seqname</span><span class="p">)</span><span class="o">.</span><span class="n">load_ext</span><span class="p">()</span>

<div class="viewcode-block" id="Nodes.save_allseries"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Nodes.save_allseries">[docs]</a>    <span class="nd">@printtools</span><span class="o">.</span><span class="n">print_progress</span>
    <span class="k">def</span> <span class="nf">save_allseries</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Call methods |Nodes.save_simseries| and |Nodes.save_obsseries|.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_simseries</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_obsseries</span><span class="p">()</span></div>

<div class="viewcode-block" id="Nodes.save_simseries"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Nodes.save_simseries">[docs]</a>    <span class="nd">@printtools</span><span class="o">.</span><span class="n">print_progress</span>
    <span class="k">def</span> <span class="nf">save_simseries</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Call method |IOSequence.save_ext| of all |Sim| objects</span>
<span class="sd">        with an activated |IOSequence.memoryflag|.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__save_nodeseries</span><span class="p">(</span><span class="s1">&#39;sim&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Nodes.save_obsseries"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Nodes.save_obsseries">[docs]</a>    <span class="nd">@printtools</span><span class="o">.</span><span class="n">print_progress</span>
    <span class="k">def</span> <span class="nf">save_obsseries</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Call method |IOSequence.save_ext| of all |Obs| objects</span>
<span class="sd">        with an activated |IOSequence.memoryflag|.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__save_nodeseries</span><span class="p">(</span><span class="s1">&#39;obs&#39;</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__save_nodeseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seqname</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">printtools</span><span class="o">.</span><span class="n">progressbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">seq</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">sequences</span><span class="p">,</span> <span class="n">seqname</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">seq</span><span class="o">.</span><span class="n">memoryflag</span><span class="p">:</span>
                <span class="n">seq</span><span class="o">.</span><span class="n">save_ext</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">variables</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Return a sorted list of the variables of all handled |Node| objects.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Node, Nodes</span>
<span class="sd">        &gt;&gt;&gt; nodes = Nodes(Node(&#39;x1&#39;),</span>
<span class="sd">        ...               Node(&#39;x2&#39;, variable=&#39;Q&#39;),</span>
<span class="sd">        ...               Node(&#39;x3&#39;, variable=&#39;H&#39;))</span>
<span class="sd">        &gt;&gt;&gt; nodes.variables</span>
<span class="sd">        [&#39;H&#39;, &#39;Q&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">sorted</span><span class="p">({</span><span class="n">node</span><span class="o">.</span><span class="n">variable</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">})</span></div>


<div class="viewcode-block" id="Elements"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Elements">[docs]</a><span class="k">class</span> <span class="nc">Elements</span><span class="p">(</span><span class="n">Devices</span><span class="p">[</span><span class="s1">&#39;Element&#39;</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;A container for handling |Element| objects.</span>

<span class="sd">    For the general usage of |Elements| objects, please see the documentation</span>
<span class="sd">    on its base class |Devices|.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Elements.get_contentclass"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Elements.get_contentclass">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_contentclass</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="s1">&#39;Element&#39;</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Return class |Element|.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Element</span></div>

<div class="viewcode-block" id="Elements.prepare_models"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Elements.prepare_models">[docs]</a>    <span class="nd">@printtools</span><span class="o">.</span><span class="n">print_progress</span>
    <span class="k">def</span> <span class="nf">prepare_models</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Call method |Element.prepare_model| of all handle |Element| objects.</span>

<span class="sd">        We show, based the `LahnH` example project, that method</span>
<span class="sd">        |Element.init_model| prepares the |Model| objects of all elements,</span>
<span class="sd">        including building the required connections and updating the</span>
<span class="sd">        derived parameters:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.examples import prepare_full_example_1</span>
<span class="sd">        &gt;&gt;&gt; prepare_full_example_1()</span>
<span class="sd">        &gt;&gt;&gt; from hydpy import HydPy, pub, TestIO</span>
<span class="sd">        &gt;&gt;&gt; with TestIO():</span>
<span class="sd">        ...     hp = HydPy(&#39;LahnH&#39;)</span>
<span class="sd">        ...     pub.timegrids = &#39;1996-01-01&#39;, &#39;1996-02-01&#39;, &#39;1d&#39;</span>
<span class="sd">        ...     hp.prepare_network()</span>
<span class="sd">        ...     hp.prepare_models()</span>
<span class="sd">        &gt;&gt;&gt; hp.elements.land_dill.model.parameters.derived.dt</span>
<span class="sd">        dt(0.000833)</span>

<span class="sd">        Wrong control files result in error messages like the following:</span>

<span class="sd">        &gt;&gt;&gt; with TestIO():</span>
<span class="sd">        ...     with open(&#39;LahnH/control/default/land_dill.py&#39;, &#39;a&#39;) as file_:</span>
<span class="sd">        ...         _ = file_.write(&#39;zonetype(-1)&#39;)</span>
<span class="sd">        ...     hp.prepare_models()   # doctest: +ELLIPSIS</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        ValueError: While trying to initialise the model object of element \</span>
<span class="sd">`land_dill`, the following error occurred: While trying to load the control \</span>
<span class="sd">file `...land_dill.py`, the following error occurred: At least one value of \</span>
<span class="sd">parameter `zonetype` of element `?` is not valid.</span>

<span class="sd">        By default, missing control files result in exceptions:</span>

<span class="sd">        &gt;&gt;&gt; del hp.elements.land_dill.model</span>
<span class="sd">        &gt;&gt;&gt; import os</span>
<span class="sd">        &gt;&gt;&gt; with TestIO():</span>
<span class="sd">        ...     os.remove(&#39;LahnH/control/default/land_dill.py&#39;)</span>
<span class="sd">        ...     hp.prepare_models()   # doctest: +ELLIPSIS</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        FileNotFoundError: While trying to initialise the model object of \</span>
<span class="sd">element `land_dill`, the following error occurred: While trying to load the \</span>
<span class="sd">control file `...land_dill.py`, the following error occurred: ...</span>
<span class="sd">        &gt;&gt;&gt; hasattr(hp.elements.land_dill, &#39;model&#39;)</span>
<span class="sd">        False</span>

<span class="sd">        When building new, still incomplete *HydPy* projects, this behaviour</span>
<span class="sd">        can be annoying.  After setting the option</span>
<span class="sd">        |Options.warnmissingcontrolfile| to |False|, missing control files</span>
<span class="sd">        only result in a warning:</span>

<span class="sd">        &gt;&gt;&gt; with TestIO():</span>
<span class="sd">        ...     with pub.options.warnmissingcontrolfile(True):</span>
<span class="sd">        ...         hp.prepare_models()</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        UserWarning: Due to a missing or no accessible control file, \</span>
<span class="sd">no model could be initialised for element `land_dill`</span>
<span class="sd">        &gt;&gt;&gt; hasattr(hp.elements.land_dill, &#39;model&#39;)</span>
<span class="sd">        False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">printtools</span><span class="o">.</span><span class="n">progressbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                <span class="n">element</span><span class="o">.</span><span class="n">prepare_model</span><span class="p">(</span><span class="n">clear_registry</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">hydpy</span><span class="o">.</span><span class="n">pub</span><span class="o">.</span><span class="n">controlmanager</span><span class="o">.</span><span class="n">clear_registry</span><span class="p">()</span></div>

<div class="viewcode-block" id="Elements.init_models"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Elements.init_models">[docs]</a>    <span class="k">def</span> <span class="nf">init_models</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Deprecated: use method |Elements.prepare_models| instead.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Elements</span>
<span class="sd">        &gt;&gt;&gt; from unittest import mock</span>
<span class="sd">        &gt;&gt;&gt; with mock.patch.object(Elements, &#39;prepare_models&#39;) as mocked:</span>
<span class="sd">        ...     elements = Elements()</span>
<span class="sd">        ...     elements.init_models()</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        hydpy.core.exceptiontools.HydPyDeprecationWarning: \</span>
<span class="sd">Method `init_models` of class `Elements` is deprecated.  \</span>
<span class="sd">Use method `prepare_models` instead.</span>
<span class="sd">        &gt;&gt;&gt; mocked.call_args_list</span>
<span class="sd">        [call()]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prepare_models</span><span class="p">()</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s1">&#39;Method `init_models` of class `Elements` is deprecated.  &#39;</span>
            <span class="s1">&#39;Use method `prepare_models` instead.&#39;</span><span class="p">,</span>
            <span class="n">exceptiontools</span><span class="o">.</span><span class="n">HydPyDeprecationWarning</span><span class="p">)</span></div>

<div class="viewcode-block" id="Elements.save_controls"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Elements.save_controls">[docs]</a>    <span class="nd">@printtools</span><span class="o">.</span><span class="n">print_progress</span>
    <span class="k">def</span> <span class="nf">save_controls</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">parameterstep</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s1">&#39;timetools.PeriodConstrArg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">simulationstep</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="s1">&#39;timetools.PeriodConstrArg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">auxfiler</span><span class="p">:</span> <span class="s1">&#39;Optional[auxfiletools.Auxfiler]&#39;</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save the control parameters of the |Model| object handled by</span>
<span class="sd">        each |Element| object and eventually the ones handled by the</span>
<span class="sd">        given |Auxfiler| object.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">auxfiler</span><span class="p">:</span>
            <span class="n">auxfiler</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">parameterstep</span><span class="p">,</span> <span class="n">simulationstep</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">printtools</span><span class="o">.</span><span class="n">progressbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">save_controls</span><span class="p">(</span>
                <span class="n">parameterstep</span><span class="o">=</span><span class="n">parameterstep</span><span class="p">,</span>
                <span class="n">simulationstep</span><span class="o">=</span><span class="n">simulationstep</span><span class="p">,</span>
                <span class="n">auxfiler</span><span class="o">=</span><span class="n">auxfiler</span><span class="p">)</span></div>

<div class="viewcode-block" id="Elements.load_conditions"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Elements.load_conditions">[docs]</a>    <span class="nd">@printtools</span><span class="o">.</span><span class="n">print_progress</span>
    <span class="k">def</span> <span class="nf">load_conditions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Save the initial conditions of the |Model| object handled by</span>
<span class="sd">        each |Element| object.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">printtools</span><span class="o">.</span><span class="n">progressbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">load_conditions</span><span class="p">()</span></div>

<div class="viewcode-block" id="Elements.save_conditions"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Elements.save_conditions">[docs]</a>    <span class="nd">@printtools</span><span class="o">.</span><span class="n">print_progress</span>
    <span class="k">def</span> <span class="nf">save_conditions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Save the calculated conditions of the |Model| object handled by</span>
<span class="sd">        each |Element| object.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">printtools</span><span class="o">.</span><span class="n">progressbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">save_conditions</span><span class="p">()</span></div>

<div class="viewcode-block" id="Elements.trim_conditions"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Elements.trim_conditions">[docs]</a>    <span class="k">def</span> <span class="nf">trim_conditions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Call method |Sequences.trim_conditions| of the |Sequences|</span>
<span class="sd">        object handled (indirectly) by each |Element| object.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">trim_conditions</span><span class="p">()</span></div>

<div class="viewcode-block" id="Elements.reset_conditions"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Elements.reset_conditions">[docs]</a>    <span class="k">def</span> <span class="nf">reset_conditions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Call method |Sequences.reset| of the |Sequences| object</span>
<span class="sd">        handled (indirectly) by each |Element| object.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">conditions</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> \
            <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]]]:</span>
        <span class="sd">&quot;&quot;&quot;A nested dictionary containing the values of all</span>
<span class="sd">        |ConditionSequence| objects of all currently handled models.</span>

<span class="sd">        See the documentation on property |HydPy.conditions| for further</span>
<span class="sd">        information.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">element</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">conditions</span>
                <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">}</span>

    <span class="nd">@conditions</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">conditions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">conditions</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span>
                                          <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span>
                                               <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span>
                                                    <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span>
                                                          <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]]]):</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">subconditions</span> <span class="ow">in</span> <span class="n">conditions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">element</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">conditions</span> <span class="o">=</span> <span class="n">subconditions</span>

<div class="viewcode-block" id="Elements.prepare_allseries"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Elements.prepare_allseries">[docs]</a>    <span class="nd">@printtools</span><span class="o">.</span><span class="n">print_progress</span>
    <span class="k">def</span> <span class="nf">prepare_allseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ramflag</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Call method |Element.prepare_allseries| of all handled</span>
<span class="sd">        |Element| objects.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">printtools</span><span class="o">.</span><span class="n">progressbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">element</span><span class="o">.</span><span class="n">prepare_allseries</span><span class="p">(</span><span class="n">ramflag</span><span class="p">)</span></div>

<div class="viewcode-block" id="Elements.prepare_inputseries"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Elements.prepare_inputseries">[docs]</a>    <span class="nd">@printtools</span><span class="o">.</span><span class="n">print_progress</span>
    <span class="k">def</span> <span class="nf">prepare_inputseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ramflag</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Call method |Element.prepare_inputseries| of all handled</span>
<span class="sd">        |Element| objects.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">printtools</span><span class="o">.</span><span class="n">progressbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">element</span><span class="o">.</span><span class="n">prepare_inputseries</span><span class="p">(</span><span class="n">ramflag</span><span class="p">)</span></div>

<div class="viewcode-block" id="Elements.prepare_fluxseries"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Elements.prepare_fluxseries">[docs]</a>    <span class="nd">@printtools</span><span class="o">.</span><span class="n">print_progress</span>
    <span class="k">def</span> <span class="nf">prepare_fluxseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ramflag</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Call method |Element.prepare_fluxseries| of all handled</span>
<span class="sd">        |Element| objects.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">printtools</span><span class="o">.</span><span class="n">progressbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">element</span><span class="o">.</span><span class="n">prepare_fluxseries</span><span class="p">(</span><span class="n">ramflag</span><span class="p">)</span></div>

<div class="viewcode-block" id="Elements.prepare_stateseries"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Elements.prepare_stateseries">[docs]</a>    <span class="nd">@printtools</span><span class="o">.</span><span class="n">print_progress</span>
    <span class="k">def</span> <span class="nf">prepare_stateseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ramflag</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Call method |Element.prepare_stateseries| of all handled</span>
<span class="sd">        |Element| objects.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">printtools</span><span class="o">.</span><span class="n">progressbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">element</span><span class="o">.</span><span class="n">prepare_stateseries</span><span class="p">(</span><span class="n">ramflag</span><span class="p">)</span></div>

<div class="viewcode-block" id="Elements.load_allseries"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Elements.load_allseries">[docs]</a>    <span class="nd">@printtools</span><span class="o">.</span><span class="n">print_progress</span>
    <span class="k">def</span> <span class="nf">load_allseries</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Call methods |Elements.load_inputseries|,</span>
<span class="sd">        |Elements.load_fluxseries|, and |Elements.load_stateseries|.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_inputseries</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_fluxseries</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">load_stateseries</span><span class="p">()</span></div>

<div class="viewcode-block" id="Elements.load_inputseries"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Elements.load_inputseries">[docs]</a>    <span class="nd">@printtools</span><span class="o">.</span><span class="n">print_progress</span>
    <span class="k">def</span> <span class="nf">load_inputseries</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Call method |IOSequence.load_ext| of all |InputSequence| objects</span>
<span class="sd">        with an activated |IOSequence.memoryflag|.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__load_modelseries</span><span class="p">(</span><span class="s1">&#39;inputs&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Elements.load_fluxseries"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Elements.load_fluxseries">[docs]</a>    <span class="nd">@printtools</span><span class="o">.</span><span class="n">print_progress</span>
    <span class="k">def</span> <span class="nf">load_fluxseries</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Call method |IOSequence.load_ext| of all |FluxSequence| objects</span>
<span class="sd">        with an activated |IOSequence.memoryflag|.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__load_modelseries</span><span class="p">(</span><span class="s1">&#39;fluxes&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Elements.load_stateseries"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Elements.load_stateseries">[docs]</a>    <span class="nd">@printtools</span><span class="o">.</span><span class="n">print_progress</span>
    <span class="k">def</span> <span class="nf">load_stateseries</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Call method |IOSequence.load_ext| of all |StateSequence| objects</span>
<span class="sd">        with an activated |IOSequence.memoryflag|.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__load_modelseries</span><span class="p">(</span><span class="s1">&#39;states&#39;</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__load_modelseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name_subseqs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">printtools</span><span class="o">.</span><span class="n">progressbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">sequences</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span>
            <span class="n">subseqs</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sequences</span><span class="p">,</span> <span class="n">name_subseqs</span><span class="p">,</span> <span class="p">())</span>
            <span class="k">for</span> <span class="n">seq</span> <span class="ow">in</span> <span class="n">subseqs</span><span class="p">:</span>
                <span class="n">seq</span><span class="o">.</span><span class="n">load_ext</span><span class="p">()</span>

<div class="viewcode-block" id="Elements.save_allseries"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Elements.save_allseries">[docs]</a>    <span class="nd">@printtools</span><span class="o">.</span><span class="n">print_progress</span>
    <span class="k">def</span> <span class="nf">save_allseries</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Call methods |Elements.save_inputseries|,</span>
<span class="sd">        |Elements.save_fluxseries|, and |Elements.save_stateseries|.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_inputseries</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_fluxseries</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_stateseries</span><span class="p">()</span></div>

<div class="viewcode-block" id="Elements.save_inputseries"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Elements.save_inputseries">[docs]</a>    <span class="nd">@printtools</span><span class="o">.</span><span class="n">print_progress</span>
    <span class="k">def</span> <span class="nf">save_inputseries</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Call method |IOSequence.save_ext| of all |InputSequence| objects</span>
<span class="sd">        with an activated |IOSequence.memoryflag|.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__save_modelseries</span><span class="p">(</span><span class="s1">&#39;inputs&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Elements.save_fluxseries"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Elements.save_fluxseries">[docs]</a>    <span class="nd">@printtools</span><span class="o">.</span><span class="n">print_progress</span>
    <span class="k">def</span> <span class="nf">save_fluxseries</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Call method |IOSequence.save_ext| of all |FluxSequence| objects</span>
<span class="sd">        with an activated |IOSequence.memoryflag|.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__save_modelseries</span><span class="p">(</span><span class="s1">&#39;fluxes&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Elements.save_stateseries"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Elements.save_stateseries">[docs]</a>    <span class="nd">@printtools</span><span class="o">.</span><span class="n">print_progress</span>
    <span class="k">def</span> <span class="nf">save_stateseries</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Call method |IOSequence.save_ext| of all |StateSequence| objects</span>
<span class="sd">        with an activated |IOSequence.memoryflag|.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__save_modelseries</span><span class="p">(</span><span class="s1">&#39;states&#39;</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__save_modelseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name_subseqs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">printtools</span><span class="o">.</span><span class="n">progressbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="n">sequences</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span>
            <span class="n">subseqs</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">sequences</span><span class="p">,</span> <span class="n">name_subseqs</span><span class="p">,</span> <span class="p">())</span>
            <span class="k">for</span> <span class="n">seq</span> <span class="ow">in</span> <span class="n">subseqs</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">seq</span><span class="o">.</span><span class="n">memoryflag</span><span class="p">:</span>
                    <span class="n">seq</span><span class="o">.</span><span class="n">save_ext</span><span class="p">()</span></div>


<div class="viewcode-block" id="Device"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Device">[docs]</a><span class="k">class</span> <span class="nc">Device</span><span class="p">(</span><span class="n">Generic</span><span class="p">[</span><span class="n">DevicesTypeUnbound</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Base class for class |Element| and class |Node|.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1"># pylint: disable=unused-argument</span>
        <span class="c1"># required for consistincy with __init__</span>
        <span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">__check_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span> <span class="o">=</span> <span class="n">_registry</span><span class="p">[</span><span class="bp">cls</span><span class="p">][</span><span class="n">name</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="bp">self</span> <span class="o">=</span> <span class="nb">object</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
            <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">name</span>
            <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;new_instance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;keywords&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Keywords</span><span class="p">()</span>
            <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;keywords&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">device</span> <span class="o">=</span> <span class="bp">self</span>
            <span class="n">_id2devices</span><span class="p">[</span><span class="bp">self</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">_registry</span><span class="p">[</span><span class="bp">cls</span><span class="p">][</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="n">_selection</span><span class="p">[</span><span class="bp">cls</span><span class="p">][</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">_registry</span><span class="p">[</span><span class="bp">cls</span><span class="p">][</span><span class="n">name</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span>

<div class="viewcode-block" id="Device.get_handlerclass"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Device.get_handlerclass">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
    <span class="k">def</span> <span class="nf">get_handlerclass</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;To be overridden.&quot;&quot;&quot;</span></div>

<div class="viewcode-block" id="Device.query_all"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Device.query_all">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">query_all</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DevicesTypeUnbound</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get all |Node| or |Element| objects initialised so far.</span>

<span class="sd">        See the main documentation on module |devicetools| for further</span>
<span class="sd">        information.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_handlerclass</span><span class="p">()(</span><span class="o">*</span><span class="n">_registry</span><span class="p">[</span><span class="bp">cls</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span></div>

<div class="viewcode-block" id="Device.extract_new"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Device.extract_new">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">extract_new</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DevicesTypeUnbound</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Gather all &quot;new&quot; |Node| or |Element| objects.</span>

<span class="sd">        See the main documentation on module |devicetools| for further</span>
<span class="sd">        information.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">devices</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_handlerclass</span><span class="p">()(</span><span class="o">*</span><span class="n">_selection</span><span class="p">[</span><span class="bp">cls</span><span class="p">])</span>
        <span class="n">_selection</span><span class="p">[</span><span class="bp">cls</span><span class="p">]</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">devices</span></div>

<div class="viewcode-block" id="Device.clear_all"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Device.clear_all">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">clear_all</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Clear the registry from all initialised |Node| or |Element| objects.</span>

<span class="sd">        See the main documentation on module |devicetools| for further</span>
<span class="sd">        information.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_selection</span><span class="p">[</span><span class="bp">cls</span><span class="p">]</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">_registry</span><span class="p">[</span><span class="bp">cls</span><span class="p">]</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Name of the actual |Node| or |Element| object.</span>

<span class="sd">        Device names serve as identifiers, as explained in the main</span>
<span class="sd">        documentation on module |devicetools|. So define them carefully:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Node</span>
<span class="sd">        &gt;&gt;&gt; Node.clear_all()</span>
<span class="sd">        &gt;&gt;&gt; node1, node2 = Node(&#39;n1&#39;), Node(&#39;n2&#39;)</span>
<span class="sd">        &gt;&gt;&gt; node1 is Node(&#39;n1&#39;)</span>
<span class="sd">        True</span>
<span class="sd">        &gt;&gt;&gt; node1 is Node(&#39;n2&#39;)</span>
<span class="sd">        False</span>

<span class="sd">        Each device name must be a valid variable identifier (see function</span>
<span class="sd">        |valid_variable_identifier|), to allow for attribute access:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Nodes</span>
<span class="sd">        &gt;&gt;&gt; nodes = Nodes(node1, &#39;n2&#39;)</span>
<span class="sd">        &gt;&gt;&gt; nodes.n1</span>
<span class="sd">        Node(&quot;n1&quot;, variable=&quot;Q&quot;)</span>

<span class="sd">        Invalid variable identifiers result in errors like the following:</span>

<span class="sd">        &gt;&gt;&gt; node3 = Node(&#39;n 3&#39;)   # doctest: +ELLIPSIS</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        ValueError: While trying to initialize a `Node` object with value \</span>
<span class="sd">`n 3` of type `str`, the following error occurred: The given name string \</span>
<span class="sd">`n 3` does not define a valid variable identifier.  ...</span>

<span class="sd">        When you change the name of a device (only do this for a good reason),</span>
<span class="sd">        the corresponding keys of all related |Nodes| and |Elements| objects</span>
<span class="sd">        (as well as of the internal registry) change automatically:</span>

<span class="sd">        &gt;&gt;&gt; Node.query_all()</span>
<span class="sd">        Nodes(&quot;n1&quot;, &quot;n2&quot;)</span>
<span class="sd">        &gt;&gt;&gt; node1.name = &#39;n1a&#39;</span>
<span class="sd">        &gt;&gt;&gt; nodes</span>
<span class="sd">        Nodes(&quot;n1a&quot;, &quot;n2&quot;)</span>
<span class="sd">        &gt;&gt;&gt; Node.query_all()</span>
<span class="sd">        Nodes(&quot;n1a&quot;, &quot;n2&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>

    <span class="nd">@name</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__check_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">devices</span> <span class="ow">in</span> <span class="n">_id2devices</span><span class="p">[</span><span class="bp">self</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">devices</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">):</span>
                <span class="k">del</span> <span class="n">devices</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
        <span class="k">del</span> <span class="n">_registry</span><span class="p">[</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)][</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
        <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">name</span>
        <span class="n">_registry</span><span class="p">[</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)][</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="k">for</span> <span class="n">devices</span> <span class="ow">in</span> <span class="n">_id2devices</span><span class="p">[</span><span class="bp">self</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">devices</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">__check_name</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">objecttools</span><span class="o">.</span><span class="n">valid_variable_identifier</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">objecttools</span><span class="o">.</span><span class="n">augment_excmessage</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;While trying to initialize a `{objecttools.classname(cls)}` &#39;</span>
                <span class="n">f</span><span class="s1">&#39;object with value `</span><span class="si">{name}</span><span class="s1">` of type `&#39;</span>
                <span class="n">f</span><span class="s1">&#39;{objecttools.classname(name)}`&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">keywords</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Keywords</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Keywords describing the actual |Node| or |Element| object.</span>

<span class="sd">        The keywords are contained within a |Keywords| object:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Node</span>
<span class="sd">        &gt;&gt;&gt; node = Node(&#39;n&#39;, keywords=&#39;word0&#39;)</span>
<span class="sd">        &gt;&gt;&gt; node.keywords</span>
<span class="sd">        Keywords(&quot;word0&quot;)</span>

<span class="sd">        Assigning new words does not overwrite already existing ones.</span>
<span class="sd">        You are allowed to add them individually or within iterable objects:</span>

<span class="sd">        &gt;&gt;&gt; node.keywords = &#39;word1&#39;</span>
<span class="sd">        &gt;&gt;&gt; node.keywords = &#39;word2&#39;, &#39;word3&#39;</span>
<span class="sd">        &gt;&gt;&gt; node.keywords</span>
<span class="sd">        Keywords(&quot;word0&quot;, &quot;word1&quot;, &quot;word2&quot;, &quot;word3&quot;)</span>

<span class="sd">        Additionally, passing additional keywords to the constructor</span>
<span class="sd">        of class |Node| or |Element| works also fine:</span>

<span class="sd">        &gt;&gt;&gt; Node(&#39;n&#39;, keywords=(&#39;word3&#39;, &#39;word4&#39;, &#39;word5&#39;))</span>
<span class="sd">        Node(&quot;n&quot;, variable=&quot;Q&quot;,</span>
<span class="sd">             keywords=[&quot;word0&quot;, &quot;word1&quot;, &quot;word2&quot;, &quot;word3&quot;, &quot;word4&quot;, &quot;word5&quot;])</span>

<span class="sd">        You can delete all keywords at once:</span>

<span class="sd">        &gt;&gt;&gt; del node.keywords</span>
<span class="sd">        &gt;&gt;&gt; node.keywords</span>
<span class="sd">        Keywords()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;keywords&#39;</span><span class="p">]</span>

    <span class="nd">@keywords</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">keywords</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">keywords</span><span class="p">:</span> <span class="n">Mayberable1</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">keywords</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">objecttools</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="n">keywords</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,),</span> <span class="kc">True</span><span class="p">))</span>
        <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;keywords&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">*</span><span class="n">keywords</span><span class="p">)</span>

    <span class="nd">@keywords</span><span class="o">.</span><span class="n">deleter</span>
    <span class="k">def</span> <span class="nf">keywords</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;keywords&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

    <span class="fm">__dir__</span> <span class="o">=</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">dir_</span></div>


<div class="viewcode-block" id="Node"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Node">[docs]</a><span class="k">class</span> <span class="nc">Node</span><span class="p">(</span><span class="n">Device</span><span class="p">[</span><span class="n">Nodes</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Handles the data flow between |Element| objects.</span>

<span class="sd">    |Node| objects always handle two sequences, a |Sim| object for</span>
<span class="sd">    simulated values and an |Obs| object for measured values:</span>

<span class="sd">    &gt;&gt;&gt; from hydpy import Node</span>
<span class="sd">    &gt;&gt;&gt; node = Node(&#39;test&#39;)</span>
<span class="sd">    &gt;&gt;&gt; for sequence in node.sequences:</span>
<span class="sd">    ...     print(sequence)</span>
<span class="sd">    sim(0.0)</span>
<span class="sd">    obs(0.0)</span>

<span class="sd">    Each node can handle an arbitrary number of &quot;input&quot; and &quot;output&quot;</span>
<span class="sd">    elements, available as instance attributes `entries` and `exits`,</span>
<span class="sd">    respectively:</span>

<span class="sd">    &gt;&gt;&gt; node.entries</span>
<span class="sd">    Elements()</span>
<span class="sd">    &gt;&gt;&gt; node.exits</span>
<span class="sd">    Elements()</span>

<span class="sd">    You cannot (or at least should not) add new elements manually:</span>

<span class="sd">    &gt;&gt;&gt; node.entries = &#39;element&#39;</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    ...</span>
<span class="sd">    AttributeError: can&#39;t set attribute</span>
<span class="sd">    &gt;&gt;&gt; node.exits.add_device(&#39;element&#39;)</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    ...</span>
<span class="sd">    RuntimeError: While trying to add the device `element` to a \</span>
<span class="sd">Elements object, the following error occurred: Adding devices to \</span>
<span class="sd">immutable Elements objects is not allowed.</span>

<span class="sd">    Instead, see the documentation on class |Element| on how to connect</span>
<span class="sd">    |Node| and |Element| objects properly.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">NodeConstrArg</span><span class="p">,</span> <span class="n">variable</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">keywords</span><span class="p">:</span> <span class="n">MayNonerable1</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="c1"># pylint: disable=unused-argument</span>
        <span class="c1"># required for consistincy with Device.__new__</span>
        <span class="k">if</span> <span class="s1">&#39;new_instance&#39;</span> <span class="ow">in</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">variable</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;variable&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Q&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;variable&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">variable</span>
            <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;entries&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Elements</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">mutable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;exits&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Elements</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">mutable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__connections</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entries</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">exits</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span> <span class="o">=</span> <span class="n">sequencetools</span><span class="o">.</span><span class="n">NodeSequences</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;deploymode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;newsim&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__blackhole</span> <span class="o">=</span> <span class="n">pointerutils</span><span class="o">.</span><span class="n">Double</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span>
            <span class="k">del</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;new_instance&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">variable</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">variable</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;The variable to be represented by a &#39;</span>
                <span class="n">f</span><span class="s1">&#39;{objecttools.classname(self)} instance cannot be changed.  &#39;</span>
                <span class="n">f</span><span class="s1">&#39;The variable of node `</span><span class="si">{self.name}</span><span class="s1">` is `</span><span class="si">{self.variable}</span><span class="s1">` &#39;</span>
                <span class="n">f</span><span class="s1">&#39;instead of `</span><span class="si">{variable}</span><span class="s1">`.  Keep in mind, that `name` is &#39;</span>
                <span class="n">f</span><span class="s1">&#39;the unique identifier of node objects.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">keywords</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">keywords</span> <span class="o">=</span> <span class="n">keywords</span>    <span class="c1"># type: ignore</span>
            <span class="c1"># due to internal type conversion</span>
            <span class="c1"># see issue https://github.com/python/mypy/issues/3004</span>

<div class="viewcode-block" id="Node.get_handlerclass"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Node.get_handlerclass">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_handlerclass</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">Nodes</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Return class |Nodes|.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Nodes</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">entries</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Elements</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Group of |Element| objects which set the the simulated value</span>
<span class="sd">        of the |Node| object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;entries&#39;</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">exits</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Elements</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Group of |Element| objects which query the simulated or</span>
<span class="sd">        observed value of the actual |Node| object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;exits&#39;</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">variable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The variable handled by the actual |Node| object.</span>

<span class="sd">        By default, nodes route discharge:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Node</span>
<span class="sd">        &gt;&gt;&gt; node = Node(&#39;test1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; node.variable</span>
<span class="sd">        &#39;Q&#39;</span>

<span class="sd">        Any other string is acceptable:</span>

<span class="sd">        &gt;&gt;&gt; Node(&#39;test2&#39;, variable=&#39;H&#39;)</span>
<span class="sd">        Node(&quot;test2&quot;, variable=&quot;H&quot;)</span>

<span class="sd">        To avoid confusion, one cannot change property |Node.variable|:</span>

<span class="sd">        &gt;&gt;&gt; node.variable = &#39;H&#39;</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        AttributeError: can&#39;t set attribute</span>
<span class="sd">        &gt;&gt;&gt; Node(&#39;test1&#39;, variable=&#39;H&#39;)</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        ValueError: The variable to be represented by a Node instance \</span>
<span class="sd">cannot be changed.  The variable of node `test1` is `Q` instead of `H`.  \</span>
<span class="sd">Keep in mind, that `name` is the unique identifier of node objects.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;variable&#39;</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">deploymode</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Defines the kind of information a |Node| object offers.</span>

<span class="sd">        *HydPy* supports the following modes:</span>

<span class="sd">          * newsim: Deploy the simulated values calculated just recently.</span>
<span class="sd">            `newsim` is the default mode, used, for example, when a node</span>
<span class="sd">            receives a discharge value from an upstream element and passes</span>
<span class="sd">            it to the downstream element directly.</span>
<span class="sd">          * obs: Deploy observed values instead of simulated values.  The</span>
<span class="sd">            node still receives the simulated values from its upstream</span>
<span class="sd">            element(s).  However, it deploys values to its downstream</span>
<span class="sd">            element(s) which are defined externally.  Usually, these values</span>
<span class="sd">            are observations made available within a time series file. See</span>
<span class="sd">            the documentation on module |sequencetools| for further</span>
<span class="sd">            information on file specifications.</span>
<span class="sd">          * oldsim: Similar to mode `obs`.  However, it is usually applied when</span>
<span class="sd">            a node is supposed to deploy simulated values which have been</span>
<span class="sd">            calculated in a previous simulation run and stored in a sequence</span>
<span class="sd">            file.</span>

<span class="sd">        The technical difference between modes `obs` and `oldsim` is that</span>
<span class="sd">        the external values are either handled by the `obs` or the `sim`</span>
<span class="sd">        sequence object.  Hence, if you select the `oldsim` mode, the</span>
<span class="sd">        values of the upstream elements calculated within the current</span>
<span class="sd">        simulation are not available (e.g. for parameter calibration)</span>
<span class="sd">        after the simulation is finished.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Node</span>
<span class="sd">        &gt;&gt;&gt; node = Node(&#39;test&#39;)</span>
<span class="sd">        &gt;&gt;&gt; node.deploymode</span>
<span class="sd">        &#39;newsim&#39;</span>
<span class="sd">        &gt;&gt;&gt; node.deploymode = &#39;obs&#39;</span>
<span class="sd">        &gt;&gt;&gt; node.deploymode</span>
<span class="sd">        &#39;obs&#39;</span>
<span class="sd">        &gt;&gt;&gt; node.deploymode = &#39;oldsim&#39;</span>
<span class="sd">        &gt;&gt;&gt; node.deploymode</span>
<span class="sd">        &#39;oldsim&#39;</span>
<span class="sd">        &gt;&gt;&gt; node.deploymode = &#39;oldobs&#39;</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        ValueError: When trying to set the routing mode of node `test`, \</span>
<span class="sd">the value `oldobs` was given, but only the following values are allowed: \</span>
<span class="sd">`newsim`, `obs` and `oldsim`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;deploymode&#39;</span><span class="p">]</span>

    <span class="nd">@deploymode</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">deploymode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s1">&#39;oldsim&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__blackhole</span> <span class="o">=</span> <span class="n">pointerutils</span><span class="o">.</span><span class="n">Double</span><span class="p">(</span><span class="mf">0.</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;newsim&#39;</span><span class="p">,</span> <span class="s1">&#39;obs&#39;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;When trying to set the routing mode of node `</span><span class="si">{self.name}</span><span class="s1">`, &#39;</span>
                <span class="n">f</span><span class="s1">&#39;the value `</span><span class="si">{value}</span><span class="s1">` was given, but only the following &#39;</span>
                <span class="n">f</span><span class="s1">&#39;values are allowed: `newsim`, `obs` and `oldsim`.&#39;</span><span class="p">)</span>
        <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;deploymode&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entries</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">exits</span><span class="p">):</span>
            <span class="n">model</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="s1">&#39;model&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">model</span><span class="p">:</span>
                <span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>

<div class="viewcode-block" id="Node.get_double"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Node.get_double">[docs]</a>    <span class="k">def</span> <span class="nf">get_double</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pointerutils</span><span class="o">.</span><span class="n">Double</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return the |Double| object appropriate for the given |Element|</span>
<span class="sd">        input or output group and the actual |Node.deploymode|.</span>

<span class="sd">        Method |Node.get_double| should be of interest for framework</span>
<span class="sd">        developers only (and eventually for model developers).</span>

<span class="sd">        Let |Node| object `node1` handle different simulation and</span>
<span class="sd">        observation values:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Node</span>
<span class="sd">        &gt;&gt;&gt; node = Node(&#39;node1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; node.sequences.sim = 1.0</span>
<span class="sd">        &gt;&gt;&gt; node.sequences.obs = 2.0</span>

<span class="sd">        The following `test` function shows for a given |Node.deploymode|</span>
<span class="sd">        if method |Node.get_double| either returns the |Double| object</span>
<span class="sd">        handling the simulated value (1.0) or the |Double| object handling</span>
<span class="sd">        the observed value (2.0):</span>

<span class="sd">        &gt;&gt;&gt; def test(deploymode):</span>
<span class="sd">        ...     node.deploymode = deploymode</span>
<span class="sd">        ...     for group in (&#39;inlets&#39;, &#39;receivers&#39;, &#39;outlets&#39;, &#39;senders&#39;):</span>
<span class="sd">        ...         print(group, node.get_double(group))</span>

<span class="sd">        In the default mode, nodes (passively) route simulated values</span>
<span class="sd">        through offering the |Double| object of sequence |Sim| to all</span>
<span class="sd">        |Element| input and output groups:</span>

<span class="sd">        &gt;&gt;&gt; test(&#39;newsim&#39;)</span>
<span class="sd">        inlets 1.0</span>
<span class="sd">        receivers 1.0</span>
<span class="sd">        outlets 1.0</span>
<span class="sd">        senders 1.0</span>

<span class="sd">        Setting |Node.deploymode| to `obs` means that a node receives</span>
<span class="sd">        simulated values (from group `outlets` or `senders`), but provides</span>
<span class="sd">        observed values (to group `inlets` or `receivers`):</span>

<span class="sd">        &gt;&gt;&gt; test(&#39;obs&#39;)</span>
<span class="sd">        inlets 2.0</span>
<span class="sd">        receivers 2.0</span>
<span class="sd">        outlets 1.0</span>
<span class="sd">        senders 1.0</span>

<span class="sd">        With |Node.deploymode| set to `oldsim`, the node provides</span>
<span class="sd">        (previously) simulated values (to group `inlets` or `receivers`)</span>
<span class="sd">        but does not receive any values.  Method |Node.get_double| just</span>
<span class="sd">        returns a dummy |Double| object with value 0.0 in this case</span>
<span class="sd">        (for group `outlets` or `senders`):</span>

<span class="sd">        &gt;&gt;&gt; test(&#39;oldsim&#39;)</span>
<span class="sd">        inlets 1.0</span>
<span class="sd">        receivers 1.0</span>
<span class="sd">        outlets 0.0</span>
<span class="sd">        senders 0.0</span>

<span class="sd">        Other |Element| input or output groups are not supported:</span>

<span class="sd">        &gt;&gt;&gt; node.get_double(&#39;test&#39;)</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        ValueError: Function `get_double` of class `Node` does not support \</span>
<span class="sd">the given group name `test`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">group</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;inlets&#39;</span><span class="p">,</span> <span class="s1">&#39;receivers&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">deploymode</span> <span class="o">!=</span> <span class="s1">&#39;obs&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">sim</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">obs</span>
        <span class="k">if</span> <span class="n">group</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;outlets&#39;</span><span class="p">,</span> <span class="s1">&#39;senders&#39;</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">deploymode</span> <span class="o">!=</span> <span class="s1">&#39;oldsim&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">sim</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__blackhole</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="n">f</span><span class="s1">&#39;Function `get_double` of class `Node` does not &#39;</span>
            <span class="n">f</span><span class="s1">&#39;support the given group name `</span><span class="si">{group}</span><span class="s1">`.&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Node.reset"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Node.reset">[docs]</a>    <span class="k">def</span> <span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># pylint: disable=unused-argument</span>
        <span class="c1"># required for consistincy with the other reset methods.</span>
        <span class="sd">&quot;&quot;&quot;Reset the actual value of the simulation sequence to zero.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Node</span>
<span class="sd">        &gt;&gt;&gt; node = Node(&#39;node1&#39;)</span>
<span class="sd">        &gt;&gt;&gt; node.sequences.sim = 1.0</span>
<span class="sd">        &gt;&gt;&gt; node.reset()</span>
<span class="sd">        &gt;&gt;&gt; node.sequences.sim</span>
<span class="sd">        sim(0.0)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fastaccess</span><span class="o">.</span><span class="n">sim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span></div>

<div class="viewcode-block" id="Node.open_files"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Node.open_files">[docs]</a>    <span class="k">def</span> <span class="nf">open_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Call method |Sequences.open_files| of the |Sequences| object</span>
<span class="sd">        handled by the actual |Node| object.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">open_files</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span></div>

<div class="viewcode-block" id="Node.close_files"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Node.close_files">[docs]</a>    <span class="k">def</span> <span class="nf">close_files</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Call method |Sequences.close_files| of the |Sequences| object</span>
<span class="sd">        handled by the actual |Node| object.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">close_files</span><span class="p">()</span></div>

<div class="viewcode-block" id="Node.prepare_allseries"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Node.prepare_allseries">[docs]</a>    <span class="k">def</span> <span class="nf">prepare_allseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ramflag</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Prepare the |IOSequence.series| object both of the |Sim| and the</span>
<span class="sd">        |Obs| sequence.</span>

<span class="sd">        Call this method before a simulation run if you need access to the</span>
<span class="sd">        whole time series of the simulated and the observed series after the</span>
<span class="sd">        simulation run is finished.</span>

<span class="sd">        By default, the time series are stored in RAM, which is the faster</span>
<span class="sd">        option.  If your RAM is limited, pass |False| to function argument</span>
<span class="sd">        `ramflag` to store the series on disk.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prepare_simseries</span><span class="p">(</span><span class="n">ramflag</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prepare_obsseries</span><span class="p">(</span><span class="n">ramflag</span><span class="p">)</span></div>

<div class="viewcode-block" id="Node.prepare_simseries"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Node.prepare_simseries">[docs]</a>    <span class="k">def</span> <span class="nf">prepare_simseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ramflag</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Prepare the |IOSequence.series| object of the |Sim| sequence.</span>

<span class="sd">        See method |Node.prepare_allseries| for further information.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__prepare_nodeseries</span><span class="p">(</span><span class="s1">&#39;sim&#39;</span><span class="p">,</span> <span class="n">ramflag</span><span class="p">)</span></div>

<div class="viewcode-block" id="Node.prepare_obsseries"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Node.prepare_obsseries">[docs]</a>    <span class="k">def</span> <span class="nf">prepare_obsseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ramflag</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Prepare the |IOSequence.series| object of the |Obs| sequence.</span>

<span class="sd">        See method |Node.prepare_allseries| for further information.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__prepare_nodeseries</span><span class="p">(</span><span class="s1">&#39;obs&#39;</span><span class="p">,</span> <span class="n">ramflag</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__prepare_nodeseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seqname</span><span class="p">,</span> <span class="n">ramflag</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">seq</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="p">,</span> <span class="n">seqname</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ramflag</span><span class="p">:</span>
            <span class="n">seq</span><span class="o">.</span><span class="n">activate_ram</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">seq</span><span class="o">.</span><span class="n">activate_disk</span><span class="p">()</span>

<div class="viewcode-block" id="Node.plot_allseries"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Node.plot_allseries">[docs]</a>    <span class="k">def</span> <span class="nf">plot_allseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Plot the |IOSequence.series| data of both the |Sim| and</span>
<span class="sd">        the |Obs| sequence object.</span>

<span class="sd">        We demonstrate the functionalities of method |Node.plot_allseries|</span>
<span class="sd">        based on the `Lahn` example project:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.examples import prepare_full_example_2</span>
<span class="sd">        &gt;&gt;&gt; hp, _, _ = prepare_full_example_2(lastdate=&#39;1997-01-01&#39;)</span>

<span class="sd">        We perform a simulation run and calculate &quot;observed&quot; values for</span>
<span class="sd">        node `dill`:</span>

<span class="sd">        &gt;&gt;&gt; hp.simulate()</span>
<span class="sd">        &gt;&gt;&gt; dill = hp.nodes.dill</span>
<span class="sd">        &gt;&gt;&gt; dill.sequences.obs.series = dill.sequences.sim.series + 10.0</span>

<span class="sd">        Calling method |Node.plot_allseries| prints the time series of</span>
<span class="sd">        both sequences to the screen immediately (if not, you need to</span>
<span class="sd">        activate the interactive mode of `matplotlib` first):</span>

<span class="sd">        &gt;&gt;&gt; dill.plot_allseries()</span>

<span class="sd">        Subsequent calls to |Node.plot_allseries| or the related methods</span>
<span class="sd">        |Node.plot_simseries| and |Node.plot_obsseries| of nodes add</span>
<span class="sd">        further time series data to the existing plot:</span>

<span class="sd">        &gt;&gt;&gt; lahn_1 = hp.nodes.lahn_1</span>
<span class="sd">        &gt;&gt;&gt; lahn_1.plot_simseries()</span>

<span class="sd">        You can modify the appearance of the lines by passing different</span>
<span class="sd">        arguments supported by `matplotlib`:</span>

<span class="sd">        &gt;&gt;&gt; lahn_1.sequences.obs.series = lahn_1.sequences.sim.series + 10.0</span>
<span class="sd">        &gt;&gt;&gt; lahn_1.plot_obsseries(color=&#39;black&#39;, linestyle=&#39;dashed&#39;)</span>

<span class="sd">        Use the `pyplot` API of `matplotlib` directly for further</span>
<span class="sd">        plot handling, e.g. for saving figures to disk:</span>

<span class="sd">        &gt;&gt;&gt; from matplotlib import pyplot</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.docs import figs</span>
<span class="sd">        &gt;&gt;&gt; pyplot.savefig(figs.__path__[0] + &#39;/Node_plot_allseries_1.png&#39;)</span>
<span class="sd">        &gt;&gt;&gt; pyplot.close()</span>

<span class="sd">        .. image:: Node_plot_allseries_1.png</span>

<span class="sd">        You can overwrite the time-series label, but doing so is most likely</span>
<span class="sd">        useful when plotting the time-series individually, of course:</span>

<span class="sd">        &gt;&gt;&gt; lahn_1.plot_obsseries(color=&#39;blue&#39;, label=&#39;measured&#39;)</span>
<span class="sd">        &gt;&gt;&gt; lahn_1.plot_simseries(color=&#39;red&#39;, label=&#39;calculated&#39;)</span>
<span class="sd">        &gt;&gt;&gt; pyplot.savefig(figs.__path__[0] + &#39;/Node_plot_allseries_2.png&#39;)</span>
<span class="sd">        &gt;&gt;&gt; pyplot.close()</span>

<span class="sd">        .. image:: Node_plot_allseries_2.png</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__plot_series</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Node.plot_simseries"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Node.plot_simseries">[docs]</a>    <span class="k">def</span> <span class="nf">plot_simseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Plot the |IOSequence.series| of the |Sim| sequence object.</span>

<span class="sd">        See method |Node.plot_allseries| for further information.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__plot_series</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">sim</span><span class="p">],</span> <span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Node.plot_obsseries"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Node.plot_obsseries">[docs]</a>    <span class="k">def</span> <span class="nf">plot_obsseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Plot the |IOSequence.series| of the |Obs| sequence object.</span>

<span class="sd">        See method |Node.plot_allseries| for further information.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__plot_series</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">obs</span><span class="p">],</span> <span class="n">kwargs</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__plot_series</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sequences</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">sequencetools</span><span class="o">.</span><span class="n">IOSequence</span><span class="p">],</span>
                      <span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">_get_pandasindex</span><span class="p">()</span>
        <span class="n">defaultlabel</span> <span class="o">=</span> <span class="s1">&#39;label&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span>
        <span class="k">for</span> <span class="n">sequence</span> <span class="ow">in</span> <span class="n">sequences</span><span class="p">:</span>
            <span class="n">ps</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">sequence</span><span class="o">.</span><span class="n">series</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">defaultlabel</span><span class="p">:</span>
                <span class="n">ps</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ps</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">sequence</span><span class="o">.</span><span class="n">name</span><span class="p">)),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">get_fignums</span><span class="p">():</span>
            <span class="n">variable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable</span>
            <span class="k">if</span> <span class="n">variable</span> <span class="o">==</span> <span class="s1">&#39;Q&#39;</span><span class="p">:</span>
                <span class="n">variable</span> <span class="o">=</span> <span class="sa">u</span><span class="s1">&#39;Q [m³/s]&#39;</span>
            <span class="n">pyplot</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">variable</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">assignrepr</span><span class="p">()</span>

<div class="viewcode-block" id="Node.assignrepr"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Node.assignrepr">[docs]</a>    <span class="k">def</span> <span class="nf">assignrepr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return a |repr| string with a prefixed assignment.&quot;&quot;&quot;</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">Node(&quot;</span><span class="si">%s</span><span class="s1">&quot;, variable=&quot;</span><span class="si">%s</span><span class="s1">&quot;,&#39;</span>
                 <span class="o">%</span> <span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">variable</span><span class="p">)]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keywords</span><span class="p">:</span>
            <span class="n">subprefix</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">keywords=&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39; &#39;</span><span class="o">*</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span><span class="o">+</span><span class="mi">5</span><span class="p">))</span>
            <span class="k">with</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">repr_</span><span class="o">.</span><span class="n">preserve_strings</span><span class="p">(</span><span class="kc">True</span><span class="p">):</span>
                <span class="k">with</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">assignrepr_tuple</span><span class="o">.</span><span class="n">always_bracketed</span><span class="p">(</span><span class="kc">False</span><span class="p">):</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">assignrepr_list</span><span class="p">(</span>
                        <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keywords</span><span class="p">),</span> <span class="n">subprefix</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
        <span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Element"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Element">[docs]</a><span class="k">class</span> <span class="nc">Element</span><span class="p">(</span><span class="n">Device</span><span class="p">[</span><span class="n">Elements</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Handles a |Model| object and connects it to other models via</span>
<span class="sd">    |Node| objects.</span>

<span class="sd">    When preparing |Element| objects one links them to nodes of different</span>
<span class="sd">    &quot;groups&quot;, each group of nodes being implemented as an immutable</span>
<span class="sd">    |Nodes| object.  |Element.inlets| and |Element.outlets| nodes handle,</span>
<span class="sd">    for example, the inflow to and the outflow from the respective element.</span>
<span class="sd">    |Element.receivers| and |Element.senders| nodes are thought for</span>
<span class="sd">    information flow between arbitrary elements, for example to inform a</span>
<span class="sd">    |dam| model about the discharge at a gauge downstream.</span>

<span class="sd">    You can select nodes either by passing them explicitly or by passing</span>
<span class="sd">    their name both as single objects or as objects contained within an</span>
<span class="sd">    iterable object:</span>

<span class="sd">    &gt;&gt;&gt; from hydpy import Element, Node</span>
<span class="sd">    &gt;&gt;&gt; Element(&#39;test&#39;,</span>
<span class="sd">    ...         inlets=&#39;in1&#39;,</span>
<span class="sd">    ...         outlets=Node(&#39;out1&#39;),</span>
<span class="sd">    ...         receivers=(&#39;rec1&#39;, Node(&#39;rec2&#39;)))</span>
<span class="sd">    Element(&quot;test&quot;,</span>
<span class="sd">            inlets=&quot;in1&quot;,</span>
<span class="sd">            outlets=&quot;out1&quot;,</span>
<span class="sd">            receivers=[&quot;rec1&quot;, &quot;rec2&quot;])</span>

<span class="sd">    Repeating such a statement with different nodes adds them to the</span>
<span class="sd">    existing ones without any conflict in case of repeated specification:</span>

<span class="sd">    &gt;&gt;&gt; Element(&#39;test&#39;,</span>
<span class="sd">    ...         inlets=&#39;in1&#39;,</span>
<span class="sd">    ...         receivers=(&#39;rec2&#39;, &#39;rec3&#39;),</span>
<span class="sd">    ...         senders=&#39;sen1&#39;)</span>
<span class="sd">    Element(&quot;test&quot;,</span>
<span class="sd">            inlets=&quot;in1&quot;,</span>
<span class="sd">            outlets=&quot;out1&quot;,</span>
<span class="sd">            receivers=[&quot;rec1&quot;, &quot;rec2&quot;, &quot;rec3&quot;],</span>
<span class="sd">            senders=&quot;sen1&quot;)</span>

<span class="sd">    Subsequent adding of nodes also works via property access:</span>

<span class="sd">    &gt;&gt;&gt; test = Element(&#39;test&#39;)</span>
<span class="sd">    &gt;&gt;&gt; test.inlets = &#39;in2&#39;</span>
<span class="sd">    &gt;&gt;&gt; test.outlets = None</span>
<span class="sd">    &gt;&gt;&gt; test.receivers = ()</span>
<span class="sd">    &gt;&gt;&gt; test.senders = &#39;sen2&#39;, Node(&#39;sen3&#39;)</span>
<span class="sd">    &gt;&gt;&gt; test</span>
<span class="sd">    Element(&quot;test&quot;,</span>
<span class="sd">            inlets=[&quot;in1&quot;, &quot;in2&quot;],</span>
<span class="sd">            outlets=&quot;out1&quot;,</span>
<span class="sd">            receivers=[&quot;rec1&quot;, &quot;rec2&quot;, &quot;rec3&quot;],</span>
<span class="sd">            senders=[&quot;sen1&quot;, &quot;sen2&quot;, &quot;sen3&quot;])</span>

<span class="sd">    The properties verify that an element does not handle the same node</span>
<span class="sd">    both within the `inlet` and the `outlet` group or within the `receiver`</span>
<span class="sd">    and the `sender` group:</span>

<span class="sd">    &gt;&gt;&gt; test.inlets = &#39;out1&#39;</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    ...</span>
<span class="sd">    ValueError: For element `test`, the given inlet node `out1` is already \</span>
<span class="sd">defined as a(n) outlet node, which is not allowed.</span>
<span class="sd">    &gt;&gt;&gt; test.outlets = &#39;in1&#39;</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    ...</span>
<span class="sd">    ValueError: For element `test`, the given outlet node `in1` is already \</span>
<span class="sd">defined as a(n) inlet node, which is not allowed.</span>
<span class="sd">    &gt;&gt;&gt; test.receivers = &#39;sen1&#39;</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    ...</span>
<span class="sd">    ValueError: For element `test`, the given receiver node `sen1` is already \</span>
<span class="sd">defined as a(n) sender node, which is not allowed.</span>
<span class="sd">    &gt;&gt;&gt; test.senders = &#39;rec1&#39;</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    ...</span>
<span class="sd">    ValueError: For element `test`, the given sender node `rec1` is already \</span>
<span class="sd">defined as a(n) receiver node, which is not allowed.</span>

<span class="sd">    Note that the discussed |Nodes| objects are immutable by default,</span>
<span class="sd">    disallowing to change them in other ways as described above:</span>

<span class="sd">    &gt;&gt;&gt; test.inlets += &#39;in3&#39;</span>
<span class="sd">    Traceback (most recent call last):</span>
<span class="sd">    ...</span>
<span class="sd">    RuntimeError: While trying to add the device `in3` to a Nodes object, \</span>
<span class="sd">the following error occurred: Adding devices to immutable Nodes objects \</span>
<span class="sd">is not allowed.</span>

<span class="sd">    Setting their `mutable` flag to |True| changes this behaviour:</span>

<span class="sd">    &gt;&gt;&gt; test.inlets.mutable = True</span>
<span class="sd">    &gt;&gt;&gt; test.inlets.add_device(&#39;in3&#39;)</span>

<span class="sd">    However, then it is up to you to make sure that the added node also</span>
<span class="sd">    handles the relevant element in the suitable group.  In the given</span>
<span class="sd">    example, only node `in2` has been added properly but not node `in3`:</span>

<span class="sd">    &gt;&gt;&gt; test.inlets.in2.exits</span>
<span class="sd">    Elements(&quot;test&quot;)</span>
<span class="sd">    &gt;&gt;&gt; test.inlets.in3.exits</span>
<span class="sd">    Elements()</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="n">ElementConstrArg</span><span class="p">,</span>
            <span class="n">inlets</span><span class="p">:</span> <span class="n">NodesConstrArg</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">outlets</span><span class="p">:</span> <span class="n">NodesConstrArg</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">receivers</span><span class="p">:</span> <span class="n">NodesConstrArg</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">senders</span><span class="p">:</span> <span class="n">NodesConstrArg</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">keywords</span><span class="p">:</span> <span class="n">MayNonerable1</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="c1"># pylint: disable=unused-argument</span>
        <span class="c1"># required for consistincy with Device.__new__</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;new_instance&#39;</span><span class="p">):</span>
            <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;inlets&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Nodes</span><span class="p">(</span><span class="n">mutable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;outlets&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Nodes</span><span class="p">(</span><span class="n">mutable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;receivers&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Nodes</span><span class="p">(</span><span class="n">mutable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;senders&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Nodes</span><span class="p">(</span><span class="n">mutable</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__connections</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inlets</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">outlets</span><span class="p">,</span>
                                  <span class="bp">self</span><span class="o">.</span><span class="n">receivers</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">senders</span><span class="p">)</span>
            <span class="k">del</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;new_instance&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keywords</span> <span class="o">=</span> <span class="n">keywords</span>  <span class="c1"># type: ignore</span>
        <span class="k">if</span> <span class="n">inlets</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">inlets</span> <span class="o">=</span> <span class="n">inlets</span>  <span class="c1"># type: ignore</span>
        <span class="k">if</span> <span class="n">outlets</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">outlets</span> <span class="o">=</span> <span class="n">outlets</span>  <span class="c1"># type: ignore</span>
        <span class="k">if</span> <span class="n">receivers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">receivers</span> <span class="o">=</span> <span class="n">receivers</span>  <span class="c1"># type: ignore</span>
        <span class="k">if</span> <span class="n">senders</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">senders</span> <span class="o">=</span> <span class="n">senders</span>  <span class="c1"># type: ignore</span>
        <span class="c1"># due to internal type conversion</span>
        <span class="c1"># see issue https://github.com/python/mypy/issues/3004</span>

    <span class="k">def</span> <span class="nf">__update_group</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">elementtarget</span><span class="p">,</span> <span class="n">nodetarget</span><span class="p">,</span> <span class="n">comparetarget</span><span class="p">):</span>
        <span class="n">elementgroup</span><span class="p">:</span> <span class="n">Nodes</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elementtarget</span><span class="p">)</span>
        <span class="n">comparisongroup</span><span class="p">:</span> <span class="n">Nodes</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">comparetarget</span><span class="p">)</span>
        <span class="n">elementtargetmutable</span> <span class="o">=</span> <span class="n">elementgroup</span><span class="o">.</span><span class="n">mutable</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">elementgroup</span><span class="o">.</span><span class="n">mutable</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">Nodes</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">comparisongroup</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="n">f</span><span class="s1">&#39;For element `</span><span class="si">{self}</span><span class="s1">`, the given </span><span class="si">{elementtarget[:-1]}</span><span class="s1"> &#39;</span>
                        <span class="n">f</span><span class="s1">&#39;node `</span><span class="si">{node}</span><span class="s1">` is already defined as a(n) &#39;</span>
                        <span class="n">f</span><span class="s1">&#39;</span><span class="si">{comparetarget[:-1]}</span><span class="s1"> node, which is not allowed.&#39;</span><span class="p">)</span>
                <span class="n">elementgroup</span><span class="o">.</span><span class="n">add_device</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
                <span class="n">nodegroup</span><span class="p">:</span> <span class="n">Elements</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">nodetarget</span><span class="p">)</span>
                <span class="n">nodegroupmutable</span> <span class="o">=</span> <span class="n">nodegroup</span><span class="o">.</span><span class="n">mutable</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">nodegroup</span><span class="o">.</span><span class="n">mutable</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">nodegroup</span><span class="o">.</span><span class="n">add_device</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="k">finally</span><span class="p">:</span>
                    <span class="n">nodegroup</span><span class="o">.</span><span class="n">mutable</span> <span class="o">=</span> <span class="n">nodegroupmutable</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">elementgroup</span><span class="o">.</span><span class="n">mutable</span> <span class="o">=</span> <span class="n">elementtargetmutable</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">inlets</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Nodes</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Group of |Node| objects from which the actual |Element| object</span>
<span class="sd">        queries its &quot;upstream&quot; input values (e.g. inflow).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;inlets&#39;</span><span class="p">]</span>

    <span class="nd">@inlets</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">inlets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span> <span class="n">NodesConstrArg</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__update_group</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">elementtarget</span><span class="o">=</span><span class="s1">&#39;inlets&#39;</span><span class="p">,</span>
                            <span class="n">nodetarget</span><span class="o">=</span><span class="s1">&#39;exits&#39;</span><span class="p">,</span> <span class="n">comparetarget</span><span class="o">=</span><span class="s1">&#39;outlets&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">outlets</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Nodes</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Group of |Node| objects to which the actual |Element| object</span>
<span class="sd">        passes its &quot;downstream&quot; output values (e.g. outflow).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;outlets&#39;</span><span class="p">]</span>

    <span class="nd">@outlets</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">outlets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span> <span class="n">NodesConstrArg</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__update_group</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">elementtarget</span><span class="o">=</span><span class="s1">&#39;outlets&#39;</span><span class="p">,</span>
                            <span class="n">nodetarget</span><span class="o">=</span><span class="s1">&#39;entries&#39;</span><span class="p">,</span> <span class="n">comparetarget</span><span class="o">=</span><span class="s1">&#39;inlets&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">receivers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Nodes</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Group of |Node| objects from which the actual |Element| object</span>
<span class="sd">        queries its &quot;remote&quot; information values (e.g. discharge at a</span>
<span class="sd">        remote downstream).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;receivers&#39;</span><span class="p">]</span>

    <span class="nd">@receivers</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">receivers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span> <span class="n">NodesConstrArg</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__update_group</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">elementtarget</span><span class="o">=</span><span class="s1">&#39;receivers&#39;</span><span class="p">,</span>
                            <span class="n">nodetarget</span><span class="o">=</span><span class="s1">&#39;exits&#39;</span><span class="p">,</span> <span class="n">comparetarget</span><span class="o">=</span><span class="s1">&#39;senders&#39;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">senders</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Nodes</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Group of |Node| objects to which the actual |Element| object</span>
<span class="sd">        passes its &quot;remote&quot; information values (e.g. water level in</span>
<span class="sd">        a |dam| model).&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;senders&#39;</span><span class="p">]</span>

    <span class="nd">@senders</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">senders</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span> <span class="n">NodesConstrArg</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__update_group</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">elementtarget</span><span class="o">=</span><span class="s1">&#39;senders&#39;</span><span class="p">,</span>
                            <span class="n">nodetarget</span><span class="o">=</span><span class="s1">&#39;entries&#39;</span><span class="p">,</span> <span class="n">comparetarget</span><span class="o">=</span><span class="s1">&#39;receivers&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="Element.get_handlerclass"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Element.get_handlerclass">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">get_handlerclass</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Type</span><span class="p">[</span><span class="n">Elements</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Return class |Elements|.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Elements</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;modeltools.Model&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The |Model| object handled by the actual |Element| object.</span>

<span class="sd">        Directly after their initialisation, elements do not know</span>
<span class="sd">        which model they require:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Element</span>
<span class="sd">        &gt;&gt;&gt; hland = Element(&#39;hland&#39;, outlets=&#39;outlet&#39;)</span>
<span class="sd">        &gt;&gt;&gt; hland.model</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        AttributeError: The model object of element `hland` has been \</span>
<span class="sd">requested but not been prepared so far.</span>

<span class="sd">        During scripting and when working interactively in the Python</span>
<span class="sd">        shell, it is often convenient to assign a |model| directly.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.models.hland_v1 import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep(&#39;1d&#39;)</span>
<span class="sd">        &gt;&gt;&gt; hland.model = model</span>
<span class="sd">        &gt;&gt;&gt; hland.model.name</span>
<span class="sd">        &#39;hland_v1&#39;</span>

<span class="sd">        &gt;&gt;&gt; del hland.model</span>
<span class="sd">        &gt;&gt;&gt; hasattr(hland, &#39;model&#39;)</span>
<span class="sd">        False</span>

<span class="sd">        For the &quot;usual&quot; approach to prepare models, please see the method</span>
<span class="sd">        |Element.prepare_model|.</span>

<span class="sd">        The following examples show that assigning |Model| objects</span>
<span class="sd">        to property |Element.model| creates some connection required by</span>
<span class="sd">        the respective model type automatically .  These</span>
<span class="sd">        examples  should be relevant for developers only.</span>

<span class="sd">        The following |hbranch| model branches a single input value</span>
<span class="sd">        (from to node `inp`) to multiple outputs (nodes `out1` and `out2`):</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Element, Node, reverse_model_wildcard_import</span>
<span class="sd">        &gt;&gt;&gt; reverse_model_wildcard_import()</span>
<span class="sd">        &gt;&gt;&gt; element = Element(&#39;a_branch&#39;,</span>
<span class="sd">        ...                   inlets=&#39;branch_input&#39;,</span>
<span class="sd">        ...                   outlets=(&#39;branch_output_1&#39;, &#39;branch_output_2&#39;))</span>
<span class="sd">        &gt;&gt;&gt; inp = element.inlets.branch_input</span>
<span class="sd">        &gt;&gt;&gt; out1, out2 = element.outlets</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.models.hbranch import *</span>
<span class="sd">        &gt;&gt;&gt; parameterstep()</span>
<span class="sd">        &gt;&gt;&gt; xpoints(0.0, 3.0)</span>
<span class="sd">        &gt;&gt;&gt; ypoints(branch_output_1=[0.0, 1.0], branch_output_2=[0.0, 2.0])</span>
<span class="sd">        &gt;&gt;&gt; parameters.update()</span>
<span class="sd">        &gt;&gt;&gt; element.model = model</span>

<span class="sd">        To show that the inlet and outlet connections are built properly,</span>
<span class="sd">        we assign a new value to the inlet node `inp` and verify that the</span>
<span class="sd">        suitable fractions of this value are passed to the outlet nodes</span>
<span class="sd">        out1` and `out2` by calling method |Model.simulate|:</span>

<span class="sd">        &gt;&gt;&gt; inp.sequences.sim = 999.0</span>
<span class="sd">        &gt;&gt;&gt; model.simulate(0)</span>
<span class="sd">        &gt;&gt;&gt; fluxes.input</span>
<span class="sd">        input(999.0)</span>
<span class="sd">        &gt;&gt;&gt; out1.sequences.sim</span>
<span class="sd">        sim(333.0)</span>
<span class="sd">        &gt;&gt;&gt; out2.sequences.sim</span>
<span class="sd">        sim(666.0)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">model</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">model</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">model</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
            <span class="n">f</span><span class="s1">&#39;The model object of element `</span><span class="si">{self.name}</span><span class="s1">` has &#39;</span>
            <span class="n">f</span><span class="s1">&#39;been requested but not been prepared so far.&#39;</span><span class="p">)</span>

    <span class="nd">@model</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="s1">&#39;modeltools.Model&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span>
        <span class="n">model</span><span class="o">.</span><span class="n">element</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="n">model</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>

    <span class="nd">@model</span><span class="o">.</span><span class="n">deleter</span>
    <span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">vars</span><span class="p">(</span><span class="bp">self</span><span class="p">)[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="Element.prepare_model"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Element.prepare_model">[docs]</a>    <span class="k">def</span> <span class="nf">prepare_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clear_registry</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Load the control file of the actual |Element| object, initialise</span>
<span class="sd">        its |Model| object, build the required connections via (an eventually</span>
<span class="sd">        overridden version of) method |Model.connect| of class |Model|, and</span>
<span class="sd">        update its  derived parameter values via calling (an eventually</span>
<span class="sd">        overridden version) of method |Parameters.update| of class |Parameters|.</span>

<span class="sd">        See method |HydPy.prepare_models| of class |HydPy| and property</span>
<span class="sd">        |model| of class |Element| fur further information.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">hydpy</span><span class="o">.</span><span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span>
            <span class="k">except</span> <span class="ne">RuntimeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
                    <span class="s1">&#39;The initialisation period has not been defined via &#39;</span>
                    <span class="s1">&#39;attribute `timegrids` of module `pub` yet but might &#39;</span>
                    <span class="s1">&#39;be required to prepare the model properly.&#39;</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">hydpy</span><span class="o">.</span><span class="n">pub</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">warnsimulationstep</span><span class="p">(</span><span class="kc">False</span><span class="p">):</span>
                <span class="n">info</span> <span class="o">=</span> <span class="n">hydpy</span><span class="o">.</span><span class="n">pub</span><span class="o">.</span><span class="n">controlmanager</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span>
                    <span class="n">element</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span> <span class="n">clear_registry</span><span class="o">=</span><span class="n">clear_registry</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">hydpy</span><span class="o">.</span><span class="n">pub</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">warnmissingcontrolfile</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                    <span class="n">f</span><span class="s1">&#39;Due to a missing or no accessible control file, no &#39;</span>
                    <span class="n">f</span><span class="s1">&#39;model could be initialised for element `</span><span class="si">{self.name}</span><span class="s1">`&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">objecttools</span><span class="o">.</span><span class="n">augment_excmessage</span><span class="p">(</span>
                    <span class="n">f</span><span class="s1">&#39;While trying to initialise the model &#39;</span>
                    <span class="n">f</span><span class="s1">&#39;object of element `</span><span class="si">{self.name}</span><span class="s1">`&#39;</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">BaseException</span><span class="p">:</span>
            <span class="n">objecttools</span><span class="o">.</span><span class="n">augment_excmessage</span><span class="p">(</span>
                <span class="n">f</span><span class="s1">&#39;While trying to initialise the model &#39;</span>
                <span class="n">f</span><span class="s1">&#39;object of element `</span><span class="si">{self.name}</span><span class="s1">`&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Element.init_model"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Element.init_model">[docs]</a>    <span class="k">def</span> <span class="nf">init_model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clear_registry</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Deprecated: use method |Element.prepare_model| instead.</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Element</span>
<span class="sd">        &gt;&gt;&gt; from unittest import mock</span>
<span class="sd">        &gt;&gt;&gt; with mock.patch.object(Element, &#39;prepare_model&#39;) as mocked:</span>
<span class="sd">        ...     element = Element(&#39;test&#39;)</span>
<span class="sd">        ...     element.init_model(False)</span>
<span class="sd">        Traceback (most recent call last):</span>
<span class="sd">        ...</span>
<span class="sd">        hydpy.core.exceptiontools.HydPyDeprecationWarning: \</span>
<span class="sd">Method `init_model` of class `Element` is deprecated.  \</span>
<span class="sd">Use method `prepare_model` instead.</span>
<span class="sd">        &gt;&gt;&gt; mocked.call_args_list</span>
<span class="sd">        [call(False)]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prepare_model</span><span class="p">(</span><span class="n">clear_registry</span><span class="p">)</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s1">&#39;Method `init_model` of class `Element` is deprecated.  &#39;</span>
            <span class="s1">&#39;Use method `prepare_model` instead.&#39;</span><span class="p">,</span>
            <span class="n">exceptiontools</span><span class="o">.</span><span class="n">HydPyDeprecationWarning</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">variables</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;A set of all different |Node.variable| values of the |Node|</span>
<span class="sd">        objects directly connected to the actual |Element| object.</span>

<span class="sd">        Suppose there is an element connected to five nodes, which (partly)</span>
<span class="sd">        represent different variables:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy import Element, Node</span>
<span class="sd">        &gt;&gt;&gt; element = Element(&#39;Test&#39;,</span>
<span class="sd">        ...                   inlets=(Node(&#39;N1&#39;, &#39;X&#39;), Node(&#39;N2&#39;, &#39;Y1&#39;)),</span>
<span class="sd">        ...                   outlets=(Node(&#39;N3&#39;, &#39;X&#39;), Node(&#39;N4&#39;, &#39;Y2&#39;)),</span>
<span class="sd">        ...                   receivers=(Node(&#39;N5&#39;, &#39;X&#39;), Node(&#39;N6&#39;, &#39;Y3&#39;)),</span>
<span class="sd">        ...                   senders=(Node(&#39;N7&#39;, &#39;X&#39;), Node(&#39;N8&#39;, &#39;Y4&#39;)))</span>

<span class="sd">        Property |Element.variables| puts all the different variables of</span>
<span class="sd">        these nodes together:</span>

<span class="sd">        &gt;&gt;&gt; sorted(element.variables)</span>
<span class="sd">        [&#39;X&#39;, &#39;Y1&#39;, &#39;Y2&#39;, &#39;Y3&#39;, &#39;Y4&#39;]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">variables</span><span class="p">:</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">connection</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__connections</span><span class="p">:</span>
            <span class="n">variables</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">connection</span><span class="o">.</span><span class="n">variables</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">variables</span>

<div class="viewcode-block" id="Element.open_files"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Element.open_files">[docs]</a>    <span class="k">def</span> <span class="nf">open_files</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Call method |Sequences.open_files| of the |Sequences| object</span>
<span class="sd">        handled (indirectly) by the actual |Element| object.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">open_files</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span></div>

<div class="viewcode-block" id="Element.close_files"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Element.close_files">[docs]</a>    <span class="k">def</span> <span class="nf">close_files</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Call method |Sequences.close_files| of the |Sequences| object</span>
<span class="sd">        handled (indirectly) by the actual |Element| object.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">close_files</span><span class="p">()</span></div>

<div class="viewcode-block" id="Element.prepare_allseries"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Element.prepare_allseries">[docs]</a>    <span class="k">def</span> <span class="nf">prepare_allseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ramflag</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Prepare the |IOSequence.series| objects of all `input`, `flux` and</span>
<span class="sd">        `state` sequences of the model handled by this element.</span>

<span class="sd">        Call this method before a simulation run, if you need access to</span>
<span class="sd">        (nearly) all simulated series of the handled model after the</span>
<span class="sd">        simulation run is finished.</span>

<span class="sd">        By default, the time series are stored in RAM, which is the faster</span>
<span class="sd">        option.  If your RAM is limited, pass |False| to function argument</span>
<span class="sd">        `ramflag` to store the series on disk.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prepare_inputseries</span><span class="p">(</span><span class="n">ramflag</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prepare_fluxseries</span><span class="p">(</span><span class="n">ramflag</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prepare_stateseries</span><span class="p">(</span><span class="n">ramflag</span><span class="p">)</span></div>

<div class="viewcode-block" id="Element.prepare_inputseries"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Element.prepare_inputseries">[docs]</a>    <span class="k">def</span> <span class="nf">prepare_inputseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ramflag</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Prepare the |IOSequence.series| objects of the `input` sequences</span>
<span class="sd">        of the model handled by this element.</span>

<span class="sd">        See method |Element.prepare_allseries| for further information.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__prepare_series</span><span class="p">(</span><span class="s1">&#39;inputs&#39;</span><span class="p">,</span> <span class="n">ramflag</span><span class="p">)</span></div>

<div class="viewcode-block" id="Element.prepare_fluxseries"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Element.prepare_fluxseries">[docs]</a>    <span class="k">def</span> <span class="nf">prepare_fluxseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ramflag</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Prepare the |IOSequence.series| objects of the `flux` sequences</span>
<span class="sd">        of the model handled by this element.</span>

<span class="sd">        See method |Element.prepare_allseries| for further information.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__prepare_series</span><span class="p">(</span><span class="s1">&#39;fluxes&#39;</span><span class="p">,</span> <span class="n">ramflag</span><span class="p">)</span></div>

<div class="viewcode-block" id="Element.prepare_stateseries"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Element.prepare_stateseries">[docs]</a>    <span class="k">def</span> <span class="nf">prepare_stateseries</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ramflag</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Prepare the |IOSequence.series| objects of the `state` sequences</span>
<span class="sd">        of the model handled by this element.</span>

<span class="sd">        See method |Element.prepare_allseries| for further information.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__prepare_series</span><span class="p">(</span><span class="s1">&#39;states&#39;</span><span class="p">,</span> <span class="n">ramflag</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__prepare_series</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name_subseqs</span><span class="p">,</span> <span class="n">ramflag</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">subseqs</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="p">,</span> <span class="n">name_subseqs</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">subseqs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ramflag</span><span class="p">:</span>
                <span class="n">subseqs</span><span class="o">.</span><span class="n">activate_ram</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">subseqs</span><span class="o">.</span><span class="n">activate_disk</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">__plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">subseqs</span><span class="p">:</span> <span class="n">sequencetools</span><span class="o">.</span><span class="n">SubSequences</span><span class="p">,</span>
               <span class="n">names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">average</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
               <span class="n">kwargs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">_get_pandasindex</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">names</span><span class="p">:</span>
            <span class="n">selseqs</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">sequencetools</span><span class="o">.</span><span class="n">IOSequence</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="nb">getattr</span><span class="p">(</span><span class="n">subseqs</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">selseqs</span> <span class="o">=</span> <span class="n">subseqs</span>
        <span class="k">for</span> <span class="n">seq</span> <span class="ow">in</span> <span class="n">selseqs</span><span class="p">:</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">seq</span><span class="o">.</span><span class="n">name</span><span class="p">)))</span>
            <span class="k">if</span> <span class="n">average</span><span class="p">:</span>
                <span class="n">series</span> <span class="o">=</span> <span class="n">seq</span><span class="o">.</span><span class="n">average_series</span><span class="p">()</span>
                <span class="n">label</span> <span class="o">=</span> <span class="n">f</span><span class="s1">&#39;</span><span class="si">{label}</span><span class="s1">, averaged&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">series</span> <span class="o">=</span> <span class="n">seq</span><span class="o">.</span><span class="n">series</span>
            <span class="k">if</span> <span class="n">series</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">ps</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
                <span class="n">ps</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">series</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">ps</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">series</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
                <span class="n">axessubplot</span> <span class="o">=</span> <span class="n">ps</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="n">color</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">axessubplot</span><span class="o">.</span><span class="n">get_lines</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_color</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">series</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                    <span class="n">ps</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">series</span><span class="p">[:,</span> <span class="n">j</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>
                    <span class="n">ps</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">color</span><span class="p">:</span>
                    <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">color</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;color&#39;</span><span class="p">]</span>
        <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span><span class="o">.</span><span class="n">get_lines</span><span class="p">()</span>
                 <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">get_label</span><span class="p">()</span> <span class="o">!=</span> <span class="s1">&#39;None&#39;</span><span class="p">]</span>
        <span class="n">pyplot</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="n">lines</span><span class="p">)</span>

<div class="viewcode-block" id="Element.plot_inputseries"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Element.plot_inputseries">[docs]</a>    <span class="k">def</span> <span class="nf">plot_inputseries</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">average</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Plot (the selected) |InputSequence| |IOSequence.series| values.</span>

<span class="sd">        We demonstrate the functionalities of method |Element.plot_inputseries|</span>
<span class="sd">        based on the `Lahn` example project:</span>

<span class="sd">        &gt;&gt;&gt; from hydpy.examples import prepare_full_example_2</span>
<span class="sd">        &gt;&gt;&gt; hp, _, _ = prepare_full_example_2(lastdate=&#39;1997-01-01&#39;)</span>

<span class="sd">        Without any arguments, |Element.plot_inputseries| prints the</span>
<span class="sd">        time series of all input sequences handled by its |Model| object</span>
<span class="sd">        directly to the screen (in the given example, |hland_inputs.P|,</span>
<span class="sd">        |hland_inputs.T|, |hland_inputs.TN|, and |hland_inputs.EPN| of</span>
<span class="sd">        application model |hland_v1|):</span>

<span class="sd">        &gt;&gt;&gt; land = hp.elements.land_dill</span>
<span class="sd">        &gt;&gt;&gt; land.plot_inputseries()</span>

<span class="sd">        You can use the `pyplot` API of `matplotlib` to modify the figure</span>
<span class="sd">        or to save it to disk (or print it to the screen, in case the</span>
<span class="sd">        interactive mode of `matplotlib` is disabled):</span>

<span class="sd">        &gt;&gt;&gt; from matplotlib import pyplot</span>
<span class="sd">        &gt;&gt;&gt; from hydpy.docs import figs</span>
<span class="sd">        &gt;&gt;&gt; pyplot.savefig(figs.__path__[0] + &#39;/Element_plot_inputseries.png&#39;)</span>
<span class="sd">        &gt;&gt;&gt; pyplot.close()</span>

<span class="sd">        .. image:: Element_plot_inputseries.png</span>

<span class="sd">        Methods |Element.plot_fluxseries| and |Element.plot_stateseries|</span>
<span class="sd">        work in the same manner.  Before applying them, one has at first</span>
<span class="sd">        to calculate the time series of the |FluxSequence| and</span>
<span class="sd">        |StateSequence| objects:</span>

<span class="sd">        &gt;&gt;&gt; hp.simulate()</span>

<span class="sd">        All three methods allow to select certain sequences by passing their</span>
<span class="sd">        names (here, flux sequences |hland_fluxes.Q0| and |hland_fluxes.Q1|</span>
<span class="sd">        of |hland_v1|). Additionally, you can pass the keyword arguments</span>
<span class="sd">        supported by `matplotlib` for modifying the line style:</span>

<span class="sd">        &gt;&gt;&gt; land.plot_fluxseries([&#39;q0&#39;, &#39;q1&#39;], linewidth=2)</span>

<span class="sd">        &gt;&gt;&gt; pyplot.savefig(figs.__path__[0] + &#39;/Element_plot_fluxseries.png&#39;)</span>
<span class="sd">        &gt;&gt;&gt; pyplot.close()</span>

<span class="sd">        .. image:: Element_plot_fluxseries.png</span>

<span class="sd">        For 1-dimensional |IOSequence| objects, all three methods plot the</span>
<span class="sd">        individual time series in the same colour (here, from the state</span>
<span class="sd">        sequences |hland_states.SP| and |hland_states.WC| of |hland_v1|):</span>

<span class="sd">        &gt;&gt;&gt; land.plot_stateseries([&#39;sp&#39;, &#39;wc&#39;])</span>

<span class="sd">        &gt;&gt;&gt; pyplot.savefig(figs.__path__[0] + &#39;/Element_plot_stateseries1.png&#39;)</span>
<span class="sd">        &gt;&gt;&gt; pyplot.close()</span>

<span class="sd">        .. image:: Element_plot_stateseries1.png</span>

<span class="sd">        Alternatively, you can print the averaged time series through</span>
<span class="sd">        passing |True| to the method `average` argument (demonstrated</span>
<span class="sd">        for the state sequence |hland_states.SM|):</span>

<span class="sd">        &gt;&gt;&gt; land.plot_stateseries([&#39;sm&#39;], color=&#39;grey&#39;)</span>
<span class="sd">        &gt;&gt;&gt; land.plot_stateseries(</span>
<span class="sd">        ...     [&#39;sm&#39;], average=True, color=&#39;black&#39;, linewidth=3)</span>

<span class="sd">        &gt;&gt;&gt; pyplot.savefig(figs.__path__[0] + &#39;/Element_plot_stateseries2.png&#39;)</span>
<span class="sd">        &gt;&gt;&gt; pyplot.close()</span>

<span class="sd">        .. image:: Element_plot_stateseries2.png</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">inputs</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="n">average</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Element.plot_fluxseries"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Element.plot_fluxseries">[docs]</a>    <span class="k">def</span> <span class="nf">plot_fluxseries</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">average</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Plot the `flux` series of the handled model.</span>

<span class="sd">        See the documentation on method |Element.plot_inputseries| for</span>
<span class="sd">        additional information.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">fluxes</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="n">average</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Element.plot_stateseries"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Element.plot_stateseries">[docs]</a>    <span class="k">def</span> <span class="nf">plot_stateseries</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">names</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">average</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Plot the `state` series of the handled model.</span>

<span class="sd">        See the documentation on method |Element.plot_inputseries| for</span>
<span class="sd">        additional information.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">sequences</span><span class="o">.</span><span class="n">states</span><span class="p">,</span> <span class="n">names</span><span class="p">,</span> <span class="n">average</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Element.assignrepr"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.Element.assignrepr">[docs]</a>    <span class="k">def</span> <span class="nf">assignrepr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return a |repr| string with a prefixed assignment.&quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">repr_</span><span class="o">.</span><span class="n">preserve_strings</span><span class="p">(</span><span class="kc">True</span><span class="p">):</span>
            <span class="k">with</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">assignrepr_tuple</span><span class="o">.</span><span class="n">always_bracketed</span><span class="p">(</span><span class="kc">False</span><span class="p">):</span>
                <span class="n">blanks</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span> <span class="o">+</span> <span class="mi">8</span><span class="p">)</span>
                <span class="n">lines</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1">Element(&quot;</span><span class="si">%s</span><span class="s1">&quot;,&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)]</span>
                <span class="k">for</span> <span class="n">groupname</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;inlets&#39;</span><span class="p">,</span> <span class="s1">&#39;outlets&#39;</span><span class="p">,</span> <span class="s1">&#39;receivers&#39;</span><span class="p">,</span> <span class="s1">&#39;senders&#39;</span><span class="p">):</span>
                    <span class="n">group</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">groupname</span><span class="p">,</span> <span class="n">Node</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">group</span><span class="p">:</span>
                        <span class="n">subprefix</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s%s</span><span class="s1">=&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">blanks</span><span class="p">,</span> <span class="n">groupname</span><span class="p">)</span>
                        <span class="c1"># pylint: disable=not-an-iterable</span>
                        <span class="c1"># because pylint is wrong</span>
                        <span class="n">nodes</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">node</span><span class="p">)</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">group</span><span class="p">]</span>
                        <span class="c1"># pylint: enable=not-an-iterable</span>
                        <span class="n">line</span> <span class="o">=</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">assignrepr_list</span><span class="p">(</span>
                            <span class="n">nodes</span><span class="p">,</span> <span class="n">subprefix</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span>
                        <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">keywords</span><span class="p">:</span>
                    <span class="n">subprefix</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">keywords=&#39;</span> <span class="o">%</span> <span class="n">blanks</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">objecttools</span><span class="o">.</span><span class="n">assignrepr_list</span><span class="p">(</span>
                        <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">keywords</span><span class="p">),</span> <span class="n">subprefix</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">70</span><span class="p">)</span>
                    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span><span class="p">)</span>
                <span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;)&#39;</span>
                <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">assignrepr</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span></div>


<span class="n">_id2devices</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="n">Device</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="n">Devices</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">_registry</span><span class="p">:</span> <span class="n">Mapping</span> <span class="o">=</span> <span class="p">{</span><span class="n">Node</span><span class="p">:</span> <span class="p">{},</span> <span class="n">Element</span><span class="p">:</span> <span class="p">{}}</span>
<span class="n">_selection</span><span class="p">:</span> <span class="n">Mapping</span> <span class="o">=</span> <span class="p">{</span><span class="n">Node</span><span class="p">:</span> <span class="p">{},</span> <span class="n">Element</span><span class="p">:</span> <span class="p">{}}</span>


<div class="viewcode-block" id="gather_registries"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.gather_registries">[docs]</a><span class="k">def</span> <span class="nf">gather_registries</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Dict</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Get and clear the current |Node| and |Element| registries.</span>

<span class="sd">    Function |gather_registries| is thought to be used by class |Tester| only.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">id2devices</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_id2devices</span><span class="p">)</span>
    <span class="n">registry</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_registry</span><span class="p">)</span>
    <span class="n">selection</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">_selection</span><span class="p">)</span>
    <span class="n">dict_</span> <span class="o">=</span> <span class="nb">globals</span><span class="p">()</span>
    <span class="n">dict_</span><span class="p">[</span><span class="s1">&#39;_id2devices&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">dict_</span><span class="p">[</span><span class="s1">&#39;_registry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">Node</span><span class="p">:</span> <span class="p">{},</span> <span class="n">Element</span><span class="p">:</span> <span class="p">{}}</span>
    <span class="n">dict_</span><span class="p">[</span><span class="s1">&#39;_selection&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">Node</span><span class="p">:</span> <span class="p">{},</span> <span class="n">Element</span><span class="p">:</span> <span class="p">{}}</span>
    <span class="k">return</span> <span class="n">id2devices</span><span class="p">,</span> <span class="n">registry</span><span class="p">,</span> <span class="n">selection</span></div>


<div class="viewcode-block" id="reset_registries"><a class="viewcode-back" href="../../../devicetools.html#hydpy.core.devicetools.reset_registries">[docs]</a><span class="k">def</span> <span class="nf">reset_registries</span><span class="p">(</span><span class="n">dicts</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">Dict</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">,</span> <span class="n">Mapping</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;Reset the current |Node| and |Element| registries.</span>

<span class="sd">    Function |reset_registries| is thought to be used by class |Tester| only.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dict_</span> <span class="o">=</span> <span class="nb">globals</span><span class="p">()</span>
    <span class="n">dict_</span><span class="p">[</span><span class="s1">&#39;_id2devices&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dicts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">dict_</span><span class="p">[</span><span class="s1">&#39;_registry&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dicts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">dict_</span><span class="p">[</span><span class="s1">&#39;_selection&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dicts</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span></div>


<span class="k">def</span> <span class="nf">_get_pandasindex</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    &gt;&gt;&gt; from hydpy import pub</span>
<span class="sd">    &gt;&gt;&gt; pub.timegrids = &#39;2004.01.01&#39;, &#39;2005.01.01&#39;, &#39;1d&#39;</span>
<span class="sd">    &gt;&gt;&gt; from hydpy.core.devicetools import _get_pandasindex</span>
<span class="sd">    &gt;&gt;&gt; _get_pandasindex()   # doctest: +ELLIPSIS</span>
<span class="sd">    DatetimeIndex([&#39;2004-01-01 12:00:00&#39;, &#39;2004-01-02 12:00:00&#39;,</span>
<span class="sd">    ...</span>
<span class="sd">                   &#39;2004-12-30 12:00:00&#39;, &#39;2004-12-31 12:00:00&#39;],</span>
<span class="sd">                  dtype=&#39;datetime64[ns]&#39;, length=366, freq=None)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">tg</span> <span class="o">=</span> <span class="n">hydpy</span><span class="o">.</span><span class="n">pub</span><span class="o">.</span><span class="n">timegrids</span><span class="o">.</span><span class="n">init</span>
    <span class="n">shift</span> <span class="o">=</span> <span class="n">tg</span><span class="o">.</span><span class="n">stepsize</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span>
        <span class="p">(</span><span class="n">tg</span><span class="o">.</span><span class="n">firstdate</span> <span class="o">+</span> <span class="n">shift</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span>
        <span class="p">(</span><span class="n">tg</span><span class="o">.</span><span class="n">lastdate</span> <span class="o">-</span> <span class="n">shift</span><span class="p">)</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span>
        <span class="p">(</span><span class="n">tg</span><span class="o">.</span><span class="n">lastdate</span> <span class="o">-</span> <span class="n">tg</span><span class="o">.</span><span class="n">firstdate</span> <span class="o">-</span> <span class="n">tg</span><span class="o">.</span><span class="n">stepsize</span><span class="p">)</span> <span class="o">/</span> <span class="n">tg</span><span class="o">.</span><span class="n">stepsize</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">index</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/HydPy_Logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="../../../index.html">Table of Contents</a></h3>
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../install.html">Installation Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../framework.html">Framework Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../modelcollection.html">Model Collection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../development.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples.html">Example Projects</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">HydPy 4.0a11 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, HydPy Developers.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.1.
    </div>
  </body>
</html>