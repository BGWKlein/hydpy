# -*- coding: utf-8 -*-
# pylint: disable=line-too-long, unused-wildcard-import
"""Model for calculating radiation terms based on sunshine duration following the
`LARSIM`_ model.

.. _`LARSIM`: http://www.larsim.de/en/the-model/

Version 3 of `HydPy-Meteo` applies the equations given in :cite:`ref-LARSIM` and
:cite:`ref-LARSIM-Hilfe` for estimating global radiation.  It is pretty similar to
|meteo_v001| for daily simulations.  However, it is more complicated for hourly (or
other short) timesteps, as it implements an approach of adjusting hourly global
radiation values to directly calculated daily global radiation sums.  The documentation
on method |Calc_GlobalRadiation_V2| explains this in more detail.

Users that strive for high consistency with `LARSIM's` results should note |meteo_v003|
works slightly different regarding the mentioned approach for adjusting hourly global
radiation values.  `LARSIM` normalises them so that their sum is identical with the
directly calculated global radiation sum of the current calendar day.  Hence,
estimating the global radiation for the early morning takes the sunshine duration
measured for the late evening into account.  *HydPy* generally does not support looking
into the future for calculating current states or fluxes.  Instead, we decided to let
|meteo_v003| always uses data of the last 24 hours for this adjustment process.  Hence,
there are noticeable differences in individual hourly radiation estimates of `LARSIM`
and |meteo_v003|, but these are random short term fluctuations that do not introduce
any long term bias.

Integration tests
=================

.. how_to_understand_integration_tests::

Application model |meteo_v003| calculates multiple meteorological factors hydrological
models could require.  We design the following integration tests so that their output
can serve as input for the integration tests of |lland_v3|.  Among others, |lland_v3|
requires global radiation and possible sunshine duration as input, which is why we
select the corresponding sequences |meteo_fluxes.GlobalRadiation| and
|PossibleSunshineDuration| as outputs.  We hand them over to the |Node| instances
`node1` and `node2`:

>>> from hydpy import Element, Node
>>> from hydpy.outputs import meteo_GlobalRadiation, meteo_PossibleSunshineDuration
>>> node1 = Node("node1", variable=meteo_GlobalRadiation)
>>> node2 = Node("node2", variable=meteo_PossibleSunshineDuration)

We prepare a |meteo_v003| instance and assign it to an element connected to those
nodes:

>>> from hydpy.models.meteo_v003 import *
>>> parameterstep()
>>> element = Element("element", outputs=(node1, node2))
>>> element.model = model

We will use the same coordinates and Ångström coefficients  in all examples:

>>> latitude(54.1)
>>> longitude(9.7)
>>> angstromconstant(0.25)
>>> angstromfactor(0.5)
>>> angstromalternative(0.15)

.. _meteo_v003_daily_simulation_summer:

daily simulation summer
_______________________

The first example takes place in a summer period, for which we calculate daily values
of global radiation and possible sunshine duration.  Besides preparing an
|IntegrationTest| instance for running the test, we only need to provide the time
series of (measured) sunshine duration:

>>> from hydpy import IntegrationTest, pub
>>> pub.timegrids = "1997-08-01", "1997-09-01", "1d"
>>> test = IntegrationTest(element)
>>> test.axis1 = (fluxes.globalradiation,)
>>> test.axis2 = (factors.possiblesunshineduration,)
>>> test.dateformat = "%Y-%d-%m"

>>> inputs.sunshineduration.series = (
...     6.3, 1.7, 4.5, 12.4, 13.9, 13.0, 13.8, 12.3, 13.1, 12.8, 13.1, 13.3, 12.7,
...     10.2, 9.4, 10.3, 11.1, 11.0, 8.5, 11.3, 12.4, 0.1, 6.7, 10.4, 6.5, 4.9, 6.6,
...     0.3, 0.1, 5.0, 3.8)

.. integration-test::

    >>> test("meteo_v003_daily_summer")
    |       date | sunshineduration | earthsundistance | solardeclination | timeofsunrise | timeofsunset | possiblesunshineduration | dailypossiblesunshineduration | dailysunshineduration | portiondailyradiation | extraterrestrialradiation | unadjustedglobalradiation | dailyglobalradiation | globalradiation |     node1 |     node2 |
    ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    | 1997-01-08 |              6.3 |         0.971564 |         0.307429 |      4.507941 |    20.198726 |                15.690785 |                     15.690785 |                   6.3 |                 100.0 |                  36.46712 |                 16.437729 |            16.437729 |       16.437729 | 16.437729 | 15.690785 |
    | 1997-02-08 |              1.7 |         0.971855 |         0.302714 |      4.538923 |    20.167744 |                15.628821 |                     15.628821 |                   1.7 |                 100.0 |                 36.236444 |                 11.029892 |            11.029892 |       11.029892 | 11.029892 | 15.628821 |
    | 1997-03-08 |              4.5 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                15.566134 |                     15.566134 |                   4.5 |                 100.0 |                 36.001693 |                 14.204272 |            14.204272 |       14.204272 | 14.204272 | 15.566134 |
    | 1997-04-08 |             12.4 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                15.502754 |                     15.502754 |                  12.4 |                 100.0 |                 35.762943 |                 23.243371 |            23.243371 |       23.243371 | 23.243371 | 15.502754 |
    | 1997-05-08 |             13.9 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                15.438712 |                     15.438712 |                  13.9 |                 100.0 |                 35.520271 |                 24.870125 |            24.870125 |       24.870125 | 24.870125 | 15.438712 |
    | 1997-06-08 |             13.0 |         0.973104 |         0.282971 |      4.666316 |     20.04035 |                15.374034 |                     15.374034 |                  13.0 |                 100.0 |                 35.273753 |                 23.731856 |            23.731856 |       23.731856 | 23.731856 | 15.374034 |
    | 1997-07-08 |             13.8 |         0.973436 |         0.277822 |      4.698958 |    20.007708 |                 15.30875 |                      15.30875 |                  13.8 |                 100.0 |                  35.02347 |                 24.541738 |            24.541738 |       24.541738 | 24.541738 |  15.30875 |
    | 1997-08-08 |             12.3 |         0.973776 |         0.272591 |      4.731891 |    19.974776 |                15.242885 |                     15.242885 |                  12.3 |                 100.0 |                 34.769499 |                 22.720717 |            22.720717 |       22.720717 | 22.720717 | 15.242885 |
    | 1997-09-08 |             13.1 |         0.974124 |         0.267279 |        4.7651 |    19.941567 |                15.176467 |                     15.176467 |                  13.1 |                 100.0 |                 34.511921 |                 23.522954 |            23.522954 |       23.522954 | 23.522954 | 15.176467 |
    | 1997-10-08 |             12.8 |         0.974479 |         0.261887 |      4.798573 |    19.908094 |                15.109521 |                     15.109521 |                  12.8 |                 100.0 |                 34.250819 |                  23.07046 |             23.07046 |        23.07046 |  23.07046 | 15.109521 |
    | 1997-11-08 |             13.1 |         0.974842 |         0.256418 |      4.832298 |    19.874369 |                15.042071 |                     15.042071 |                  13.1 |                 100.0 |                 33.986274 |                 23.295734 |            23.295734 |       23.295734 | 23.295734 | 15.042071 |
    | 1997-12-08 |             13.3 |         0.975213 |         0.250873 |      4.866263 |    19.840404 |                14.974141 |                     14.974141 |                  13.3 |                 100.0 |                  33.71837 |                 23.403884 |            23.403884 |       23.403884 | 23.403884 | 14.974141 |
    | 1997-13-08 |             12.7 |          0.97559 |         0.245254 |      4.900456 |    19.806211 |                14.905755 |                     14.905755 |                  12.7 |                 100.0 |                 33.447192 |                 22.610635 |            22.610635 |       22.610635 | 22.610635 | 14.905755 |
    | 1997-14-08 |             10.2 |         0.975975 |         0.239562 |      4.934866 |      19.7718 |                14.836934 |                     14.836934 |                  10.2 |                 100.0 |                 33.172825 |                 19.695927 |            19.695927 |       19.695927 | 19.695927 | 14.836934 |
    | 1997-15-08 |              9.4 |         0.976367 |         0.233799 |      4.969483 |    19.737183 |                  14.7677 |                       14.7677 |                   9.4 |                 100.0 |                 32.895357 |                 18.693186 |            18.693186 |       18.693186 | 18.693186 |   14.7677 |
    | 1997-16-08 |             10.3 |         0.976766 |         0.227967 |      5.004296 |    19.702371 |                14.698075 |                     14.698075 |                  10.3 |                 100.0 |                 32.614875 |                 19.581515 |            19.581515 |       19.581515 | 19.581515 | 14.698075 |
    | 1997-17-08 |             11.1 |         0.977172 |         0.222067 |      5.039294 |    19.667372 |                14.628078 |                     14.628078 |                  11.1 |                 100.0 |                 32.331467 |                 20.349663 |            20.349663 |       20.349663 | 20.349663 | 14.628078 |
    | 1997-18-08 |             11.0 |         0.977584 |         0.216102 |      5.074469 |    19.632198 |                14.557728 |                     14.557728 |                  11.0 |                 100.0 |                 32.045225 |                 20.118191 |            20.118191 |       20.118191 | 20.118191 | 14.557728 |
    | 1997-19-08 |              8.5 |         0.978003 |         0.210072 |       5.10981 |    19.596856 |                14.487046 |                     14.487046 |                   8.5 |                 100.0 |                 31.756238 |                 17.255246 |            17.255246 |       17.255246 | 17.255246 | 14.487046 |
    | 1997-20-08 |             11.3 |         0.978429 |          0.20398 |      5.145309 |    19.561357 |                14.416048 |                     14.416048 |                  11.3 |                 100.0 |                   31.4646 |                 20.197892 |            20.197892 |       20.197892 | 20.197892 | 14.416048 |
    | 1997-21-08 |             12.4 |          0.97886 |         0.197828 |      5.180957 |    19.525709 |                14.344752 |                     14.344752 |                  12.4 |                 100.0 |                 31.170402 |                 21.264879 |            21.264879 |       21.264879 | 21.264879 | 14.344752 |
    | 1997-22-08 |              0.1 |         0.979299 |         0.191617 |      5.216746 |    19.489921 |                14.273175 |                     14.273175 |                   0.1 |                 100.0 |                  30.87374 |                  7.826588 |             7.826588 |        7.826588 |  7.826588 | 14.273175 |
    | 1997-23-08 |              6.7 |         0.979743 |          0.18535 |      5.252667 |       19.454 |                14.201333 |                     14.201333 |                   6.7 |                 100.0 |                 30.574709 |                 14.856047 |            14.856047 |       14.856047 | 14.856047 | 14.201333 |
    | 1997-24-08 |             10.4 |         0.980193 |         0.179027 |      5.288712 |    19.417955 |                14.129243 |                     14.129243 |                  10.4 |                 100.0 |                 30.273404 |                 18.709904 |            18.709904 |       18.709904 | 18.709904 | 14.129243 |
    | 1997-25-08 |              6.5 |         0.980649 |         0.172651 |      5.324874 |    19.381792 |                14.056918 |                     14.056918 |                   6.5 |                 100.0 |                 29.969924 |                 14.421614 |            14.421614 |       14.421614 | 14.421614 | 14.056918 |
    | 1997-26-08 |              4.9 |         0.981111 |         0.166225 |      5.361147 |     19.34552 |                13.984374 |                     13.984374 |                   4.9 |                 100.0 |                 29.664367 |                 12.613157 |            12.613157 |       12.613157 | 12.613157 | 13.984374 |
    | 1997-27-08 |              6.6 |         0.981578 |         0.159748 |      5.397522 |    19.309145 |                13.911624 |                     13.911624 |                   6.6 |                 100.0 |                 29.356832 |                 14.302992 |            14.302992 |       14.302992 | 14.302992 | 13.911624 |
    | 1997-28-08 |              0.3 |         0.982051 |         0.153225 |      5.433993 |    19.272674 |                13.838682 |                     13.838682 |                   0.3 |                 100.0 |                 29.047419 |                  7.576705 |             7.576705 |        7.576705 |  7.576705 | 13.838682 |
    | 1997-29-08 |              0.1 |         0.982529 |         0.146656 |      5.470553 |    19.236114 |                13.765561 |                     13.765561 |                   0.1 |                 100.0 |                  28.73623 |                  7.288435 |             7.288435 |        7.288435 |  7.288435 | 13.765561 |
    | 1997-30-08 |              5.0 |         0.983012 |         0.140044 |      5.507197 |     19.19947 |                13.692273 |                     13.692273 |                   5.0 |                 100.0 |                 28.423368 |                 12.295515 |            12.295515 |       12.295515 | 12.295515 | 13.692273 |
    | 1997-31-08 |              3.8 |           0.9835 |          0.13339 |      5.543918 |    19.162749 |                13.618831 |                     13.618831 |                   3.8 |                 100.0 |                 28.108935 |                 10.948788 |            10.948788 |       10.948788 | 10.948788 | 13.618831 |

.. _meteo_v003_daily_simulation_winter:

daily simulation winter
_______________________

This test is similar to the :ref:`meteo_v003_daily_simulation_summer` example but
deals with winter conditions:

>>> pub.timegrids = "2010-12-01", "2011-01-01", "1d"

>>> inputs.sunshineduration.series = (
...     3.5, 0.0, 0.1, 3.7, 0.0, 0.1, 0.0, 0.0, 4.4, 0.1, 0.2, 0.7, 0.0, 1.2, 3.0, 0.0,
...     0.0, 0.0, 0.0, 0.2, 0.8, 0.0, 0.0, 0.0, 3.2, 4.3, 0.0, 3.4, 0.0, 0.0, 4.0)

.. integration-test::

    >>> test("meteo_v003_daily_winter")
    |       date | sunshineduration | earthsundistance | solardeclination | timeofsunrise | timeofsunset | possiblesunshineduration | dailypossiblesunshineduration | dailysunshineduration | portiondailyradiation | extraterrestrialradiation | unadjustedglobalradiation | dailyglobalradiation | globalradiation |    node1 |    node2 |
    ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    | 2010-01-12 |              3.5 |         1.028719 |        -0.389384 |      8.532819 |    16.173848 |                 7.641029 |                      7.641029 |                   3.5 |                 100.0 |                  5.761386 |                  2.759858 |             2.759858 |        2.759858 | 2.759858 | 7.641029 |
    | 2010-02-12 |              0.0 |         1.028994 |        -0.391536 |      8.548511 |    16.158156 |                 7.609644 |                      7.609644 |                   0.0 |                 100.0 |                  5.687365 |                  0.853105 |             0.853105 |        0.853105 | 0.853105 | 7.609644 |
    | 2010-03-12 |              0.1 |          1.02926 |        -0.393572 |      8.563421 |    16.143245 |                 7.579824 |                      7.579824 |                   0.1 |                 100.0 |                  5.617593 |                  1.441454 |             1.441454 |        1.441454 | 1.441454 | 7.579824 |
    | 2010-04-12 |              3.7 |         1.029518 |        -0.395492 |      8.577535 |    16.129131 |                 7.551596 |                      7.551596 |                   3.7 |                 100.0 |                  5.552051 |                  2.748162 |             2.748162 |        2.748162 | 2.748162 | 7.551596 |
    | 2010-05-12 |              0.0 |         1.029767 |        -0.397294 |      8.590839 |    16.115828 |                 7.524989 |                      7.524989 |                   0.0 |                 100.0 |                  5.490726 |                  0.823609 |             0.823609 |        0.823609 | 0.823609 | 7.524989 |
    | 2010-06-12 |              0.1 |         1.030007 |        -0.398979 |      8.603319 |    16.103347 |                 7.500028 |                      7.500028 |                   0.1 |                 100.0 |                  5.433602 |                  1.394624 |             1.394624 |        1.394624 | 1.394624 | 7.500028 |
    | 2010-07-12 |              0.0 |         1.030238 |        -0.400545 |      8.614964 |    16.091703 |                 7.476739 |                      7.476739 |                   0.0 |                 100.0 |                  5.380663 |                  0.807099 |             0.807099 |        0.807099 | 0.807099 | 7.476739 |
    | 2010-08-12 |              0.0 |         1.030461 |        -0.401992 |      8.625761 |    16.080906 |                 7.455145 |                      7.455145 |                   0.0 |                 100.0 |                  5.331896 |                  0.799784 |             0.799784 |        0.799784 | 0.799784 | 7.455145 |
    | 2010-09-12 |              4.4 |         1.030674 |        -0.403321 |      8.635699 |    16.070967 |                 7.435268 |                      7.435268 |                   4.4 |                 100.0 |                  5.287288 |                  2.886262 |             2.886262 |        2.886262 | 2.886262 | 7.435268 |
    | 2010-10-12 |              0.1 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                  7.41713 |                       7.41713 |                   0.1 |                 100.0 |                  5.246826 |                  1.347076 |             1.347076 |        1.347076 | 1.347076 |  7.41713 |
    | 2010-11-12 |              0.2 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                 7.400749 |                      7.400749 |                   0.2 |                 100.0 |                  5.210498 |                  1.373029 |             1.373029 |        1.373029 | 1.373029 | 7.400749 |
    | 2010-12-12 |              0.7 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                 7.386143 |                      7.386143 |                   0.7 |                 100.0 |                  5.178293 |                  1.539952 |             1.539952 |        1.539952 | 1.539952 | 7.386143 |
    | 2010-13-12 |              0.0 |         1.031437 |        -0.407436 |      8.666669 |    16.039997 |                 7.373328 |                      7.373328 |                   0.0 |                 100.0 |                  5.150203 |                   0.77253 |              0.77253 |         0.77253 |  0.77253 | 7.373328 |
    | 2010-14-12 |              1.2 |         1.031605 |        -0.408164 |      8.672175 |    16.034492 |                 7.362317 |                      7.362317 |                   1.2 |                 100.0 |                  5.126218 |                  1.699321 |             1.699321 |        1.699321 | 1.699321 | 7.362317 |
    | 2010-15-12 |              3.0 |         1.031763 |         -0.40877 |      8.676772 |    16.029895 |                 7.353123 |                      7.353123 |                   3.0 |                 100.0 |                  5.106331 |                  2.318249 |             2.318249 |        2.318249 | 2.318249 | 7.353123 |
    | 2010-16-12 |              0.0 |         1.031912 |        -0.409256 |      8.680456 |    16.026211 |                 7.345755 |                      7.345755 |                   0.0 |                 100.0 |                  5.090537 |                  0.763581 |             0.763581 |        0.763581 | 0.763581 | 7.345755 |
    | 2010-17-12 |              0.0 |         1.032051 |         -0.40962 |      8.683222 |    16.023444 |                 7.340222 |                      7.340222 |                   0.0 |                 100.0 |                  5.078832 |                  0.761825 |             0.761825 |        0.761825 | 0.761825 | 7.340222 |
    | 2010-18-12 |              0.0 |         1.032182 |        -0.409863 |      8.685068 |    16.021598 |                  7.33653 |                       7.33653 |                   0.0 |                 100.0 |                  5.071211 |                  0.760682 |             0.760682 |        0.760682 | 0.760682 |  7.33653 |
    | 2010-19-12 |              0.0 |         1.032302 |        -0.409985 |      8.685992 |    16.020675 |                 7.334683 |                      7.334683 |                   0.0 |                 100.0 |                  5.067673 |                  0.760151 |             0.760151 |        0.760151 | 0.760151 | 7.334683 |
    | 2010-20-12 |              0.2 |         1.032413 |        -0.409985 |      8.685992 |    16.020675 |                 7.334683 |                      7.334683 |                   0.2 |                 100.0 |                  5.068219 |                  1.336154 |             1.336154 |        1.336154 | 1.336154 | 7.334683 |
    | 2010-21-12 |              0.8 |         1.032515 |        -0.409863 |      8.685068 |    16.021598 |                  7.33653 |                       7.33653 |                   0.8 |                 100.0 |                  5.072848 |                  1.544792 |             1.544792 |        1.544792 | 1.544792 |  7.33653 |
    | 2010-22-12 |              0.0 |         1.032607 |         -0.40962 |      8.683222 |    16.023444 |                 7.340222 |                      7.340222 |                   0.0 |                 100.0 |                  5.081565 |                  0.762235 |             0.762235 |        0.762235 | 0.762235 | 7.340222 |
    | 2010-23-12 |              0.0 |         1.032689 |        -0.409256 |      8.680456 |    16.026211 |                 7.345755 |                      7.345755 |                   0.0 |                 100.0 |                  5.094372 |                  0.764156 |             0.764156 |        0.764156 | 0.764156 | 7.345755 |
    | 2010-24-12 |              0.0 |         1.032762 |         -0.40877 |      8.676772 |    16.029895 |                 7.353123 |                      7.353123 |                   0.0 |                 100.0 |                  5.111276 |                  0.766691 |             0.766691 |        0.766691 | 0.766691 | 7.353123 |
    | 2010-25-12 |              3.2 |         1.032825 |        -0.408164 |      8.672175 |    16.034492 |                 7.362317 |                      7.362317 |                   3.2 |                 100.0 |                  5.132282 |                  2.398433 |             2.398433 |        2.398433 | 2.398433 | 7.362317 |
    | 2010-26-12 |              4.3 |         1.032879 |        -0.407436 |      8.666669 |    16.039997 |                 7.373328 |                      7.373328 |                   4.3 |                 100.0 |                  5.157401 |                  2.793204 |             2.793204 |        2.793204 | 2.793204 | 7.373328 |
    | 2010-27-12 |              0.0 |         1.032922 |        -0.406588 |      8.660262 |    16.046405 |                 7.386143 |                      7.386143 |                   0.0 |                 100.0 |                  5.186639 |                  0.777996 |             0.777996 |        0.777996 | 0.777996 | 7.386143 |
    | 2010-28-12 |              3.4 |         1.032956 |        -0.405619 |      8.652959 |    16.053708 |                 7.400749 |                      7.400749 |                   3.4 |                 100.0 |                   5.22001 |                  2.504073 |             2.504073 |        2.504073 | 2.504073 | 7.400749 |
    | 2010-29-12 |              0.0 |         1.032981 |         -0.40453 |      8.644768 |    16.061898 |                  7.41713 |                       7.41713 |                   0.0 |                 100.0 |                  5.257524 |                  0.788629 |             0.788629 |        0.788629 | 0.788629 |  7.41713 |
    | 2010-30-12 |              0.0 |         1.032995 |        -0.403321 |      8.635699 |    16.070967 |                 7.435268 |                      7.435268 |                   0.0 |                 100.0 |                  5.299194 |                  0.794879 |             0.794879 |        0.794879 | 0.794879 | 7.435268 |
    | 2010-31-12 |              4.0 |            1.033 |        -0.401992 |      8.625761 |    16.080906 |                 7.455145 |                      7.455145 |                   4.0 |                 100.0 |                  5.345035 |                  2.770177 |             2.770177 |        2.770177 | 2.770177 | 7.455145 |

.. _meteo_v003_hourly_simulation_summer:

hourly simulation summer
________________________

When choosing a simulation timestep smaller one day, we additionally must provide
sunshine duration and "unadjusted" global radiation values for the last 24 hours, which
we pass to the sequences |LoggedSunshineDuration| and |LoggedUnadjustedGlobalRadiation|:

>>> pub.timegrids = "1997-08-03", "1997-08-06", "1h"
>>> test = IntegrationTest(element)
>>> test.axis1 = (fluxes.globalradiation,)
>>> test.axis2 = (factors.possiblesunshineduration,)
>>> test.dateformat = "%Y-%d-%m %H:00"

>>> inputs.sunshineduration.series = (
...     0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2, 0.5, 0.7, 0.8, 0.5, 0.4, 0.5,
...     0.5, 0.3, 0.1, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1, 0.9,
...     1.0, 1.0, 0.9, 0.8, 0.9, 0.8, 0.9, 0.9, 0.9, 1.0, 1.0, 1.0, 0.3, 0.0, 0.0, 0.0,
...     0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.6, 0.9, 1.0, 0.9, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0,
...     1.0, 1.0, 1.0, 1.0, 0.5, 0.0, 0.0, 0.0)

>>> test.inits = (
...     (logs.loggedsunshineduration,
...      [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2, 0.1, 0.2, 0.1, 0.2, 0.2, 0.3, 0.0,
...       0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]),
...     (logs.loggedunadjustedglobalradiation,
...      [0.0, 0.0, 0.0, 0.0, 0.0, 0.1, 0.2, 0.5, 0.8, 1.1, 1.2, 1.4, 1.9, 1.6, 0.9,
...       0.8, 0.6, 0.4, 0.2, 0.1, 0.0, 0.0, 0.0, 0.0]))

.. integration-test::

    >>> test("meteo_v003_hourly_summer")
    |             date | sunshineduration | earthsundistance | solardeclination | timeofsunrise | timeofsunset | possiblesunshineduration | dailypossiblesunshineduration | dailysunshineduration | portiondailyradiation | extraterrestrialradiation | unadjustedglobalradiation | dailyglobalradiation | globalradiation |    node1 |    node2 |
    ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    | 1997-03-08 00:00 |              0.0 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      0.0 |                     15.566134 |                   1.3 |                   0.0 |                 36.001693 |                       0.0 |            10.503757 |             0.0 |      0.0 |      0.0 |
    | 1997-03-08 01:00 |              0.0 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      0.0 |                     15.566134 |                   1.3 |                   0.0 |                 36.001693 |                       0.0 |            10.503757 |             0.0 |      0.0 |      0.0 |
    | 1997-03-08 02:00 |              0.0 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      0.0 |                     15.566134 |                   1.3 |                   0.0 |                 36.001693 |                       0.0 |            10.503757 |             0.0 |      0.0 |      0.0 |
    | 1997-03-08 03:00 |              0.0 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      0.0 |                     15.566134 |                   1.3 |                   0.0 |                 36.001693 |                       0.0 |            10.503757 |             0.0 |      0.0 |      0.0 |
    | 1997-03-08 04:00 |              0.0 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                 0.429734 |                     15.566134 |                   1.3 |              0.086656 |                 36.001693 |                  0.007799 |            10.503757 |        0.006997 | 0.006997 | 0.429734 |
    | 1997-03-08 05:00 |              0.0 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      1.0 |                     15.566134 |                   1.3 |              0.968392 |                 36.001693 |                  0.087159 |            10.503757 |        0.078957 | 0.078957 |      1.0 |
    | 1997-03-08 06:00 |              0.0 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      1.0 |                     15.566134 |                   1.3 |                2.4897 |                 36.001693 |                  0.224084 |            10.503757 |        0.206122 | 0.206122 |      1.0 |
    | 1997-03-08 07:00 |              0.0 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      1.0 |                     15.566134 |                   1.3 |              4.679733 |                 36.001693 |                  0.421196 |            10.503757 |        0.393598 | 0.393598 |      1.0 |
    | 1997-03-08 08:00 |              0.0 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      1.0 |                     15.566134 |                   1.3 |              7.219274 |                 36.001693 |                  0.649765 |            10.503757 |        0.615417 | 0.615417 |      1.0 |
    | 1997-03-08 09:00 |              0.2 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      1.0 |                     15.566134 |                   1.5 |              9.442017 |                 36.001693 |                   1.18975 |             10.73504 |        1.122345 | 1.122345 |      1.0 |
    | 1997-03-08 10:00 |              0.5 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      1.0 |                     15.566134 |                   1.7 |             10.709164 |                 36.001693 |                   1.92774 |            10.966322 |          1.8057 |   1.8057 |      1.0 |
    | 1997-03-08 11:00 |              0.7 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      1.0 |                     15.566134 |                   2.2 |             10.773868 |                 36.001693 |                  2.327265 |            11.544527 |        2.214067 | 2.214067 |      1.0 |
    | 1997-03-08 12:00 |              0.8 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      1.0 |                     15.566134 |                   2.8 |             10.364714 |                 36.001693 |                  2.425457 |            12.238374 |         2.25556 |  2.25556 |      1.0 |
    | 1997-03-08 13:00 |              0.5 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      1.0 |                     15.566134 |                   3.2 |             10.872489 |                 36.001693 |                   1.95714 |            12.700938 |         1.78608 |  1.78608 |      1.0 |
    | 1997-03-08 14:00 |              0.4 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      1.0 |                     15.566134 |                   3.4 |             10.461143 |                 36.001693 |                  1.694785 |             12.93222 |        1.510276 | 1.510276 |      1.0 |
    | 1997-03-08 15:00 |              0.5 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      1.0 |                     15.566134 |                   3.8 |              8.865382 |                 36.001693 |                  1.595844 |            13.394785 |        1.396394 | 1.396394 |      1.0 |
    | 1997-03-08 16:00 |              0.5 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      1.0 |                     15.566134 |                   4.1 |              6.474205 |                 36.001693 |                  1.165412 |            13.741708 |        1.002589 | 1.002589 |      1.0 |
    | 1997-03-08 17:00 |              0.3 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      1.0 |                     15.566134 |                   4.4 |              3.977658 |                 36.001693 |                   0.57281 |            14.088631 |        0.493699 | 0.493699 |      1.0 |
    | 1997-03-08 18:00 |              0.1 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      1.0 |                     15.566134 |                   4.5 |              1.972911 |                 36.001693 |                  0.213084 |            14.204272 |        0.183891 | 0.183891 |      1.0 |
    | 1997-03-08 19:00 |              0.0 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      1.0 |                     15.566134 |                   4.5 |              0.634046 |                 36.001693 |                  0.057067 |            14.204272 |        0.049078 | 0.049078 |      1.0 |
    | 1997-03-08 20:00 |              0.0 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                   0.1364 |                     15.566134 |                   4.5 |              0.008648 |                 36.001693 |                  0.000778 |            14.204272 |        0.000669 | 0.000669 |   0.1364 |
    | 1997-03-08 21:00 |              0.0 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      0.0 |                     15.566134 |                   4.5 |                   0.0 |                 36.001693 |                       0.0 |            14.204272 |             0.0 |      0.0 |      0.0 |
    | 1997-03-08 22:00 |              0.0 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      0.0 |                     15.566134 |                   4.5 |                   0.0 |                 36.001693 |                       0.0 |            14.204272 |             0.0 |      0.0 |      0.0 |
    | 1997-03-08 23:00 |              0.0 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      0.0 |                     15.566134 |                   4.5 |                   0.0 |                 36.001693 |                       0.0 |            14.204272 |             0.0 |      0.0 |      0.0 |
    | 1997-04-08 00:00 |              0.0 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      0.0 |                     15.502754 |                   4.5 |                   0.0 |                 35.762943 |                       0.0 |            14.131208 |             0.0 |      0.0 |      0.0 |
    | 1997-04-08 01:00 |              0.0 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      0.0 |                     15.502754 |                   4.5 |                   0.0 |                 35.762943 |                       0.0 |            14.131208 |             0.0 |      0.0 |      0.0 |
    | 1997-04-08 02:00 |              0.0 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      0.0 |                     15.502754 |                   4.5 |                   0.0 |                 35.762943 |                       0.0 |            14.131208 |             0.0 |      0.0 |      0.0 |
    | 1997-04-08 03:00 |              0.0 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      0.0 |                     15.502754 |                   4.5 |                   0.0 |                 35.762943 |                       0.0 |            14.131208 |             0.0 |      0.0 |      0.0 |
    | 1997-04-08 04:00 |              0.0 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                 0.398044 |                     15.502754 |                   4.5 |               0.07485 |                 35.762943 |                  0.006692 |            14.131208 |        0.005726 | 0.005726 | 0.398044 |
    | 1997-04-08 05:00 |              0.0 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      1.0 |                     15.502754 |                   4.5 |              0.938714 |                 35.762943 |                  0.083928 |            14.131208 |        0.071823 | 0.071823 |      1.0 |
    | 1997-04-08 06:00 |              0.1 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      1.0 |                     15.502754 |                   4.6 |              2.455474 |                 35.762943 |                  0.263445 |            14.246552 |        0.226749 | 0.226749 |      1.0 |
    | 1997-04-08 07:00 |              0.9 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      1.0 |                     15.502754 |                   5.5 |              4.650125 |                 35.762943 |                  1.164115 |            15.284647 |        1.028795 | 1.028795 |      1.0 |
    | 1997-04-08 08:00 |              1.0 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      1.0 |                     15.502754 |                   6.5 |              7.209034 |                 35.762943 |                  1.933622 |            16.438085 |        1.710811 | 1.710811 |      1.0 |
    | 1997-04-08 09:00 |              1.0 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      1.0 |                     15.502754 |                   7.3 |              9.458797 |                 35.762943 |                  2.537058 |            17.360836 |        2.210424 | 2.210424 |      1.0 |
    | 1997-04-08 10:00 |              0.9 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      1.0 |                     15.502754 |                   7.7 |             10.747438 |                 35.762943 |                   2.69052 |            17.822211 |        2.317703 | 2.317703 |      1.0 |
    | 1997-04-08 11:00 |              0.8 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      1.0 |                     15.502754 |                   7.8 |             10.819272 |                 35.762943 |                  2.515039 |            17.937555 |        2.160947 | 2.160947 |      1.0 |
    | 1997-04-08 12:00 |              0.9 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      1.0 |                     15.502754 |                   7.9 |             10.408076 |                 35.762943 |                  2.605564 |            18.052899 |        2.233851 | 2.233851 |      1.0 |
    | 1997-04-08 13:00 |              0.8 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      1.0 |                     15.502754 |                   8.2 |             10.917404 |                 35.762943 |                   2.53785 |             18.39893 |        2.157989 | 2.157989 |      1.0 |
    | 1997-04-08 14:00 |              0.9 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      1.0 |                     15.502754 |                   8.7 |             10.494383 |                 35.762943 |                   2.62717 |            18.975649 |        2.208784 | 2.208784 |      1.0 |
    | 1997-04-08 15:00 |              0.9 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      1.0 |                     15.502754 |                   9.1 |              8.874215 |                 35.762943 |                  2.221576 |            19.437025 |        1.861585 | 1.861585 |      1.0 |
    | 1997-04-08 16:00 |              0.9 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      1.0 |                     15.502754 |                   9.5 |               6.45697 |                 35.762943 |                  1.616442 |              19.8984 |        1.360212 | 1.360212 |      1.0 |
    | 1997-04-08 17:00 |              1.0 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      1.0 |                     15.502754 |                  10.2 |              3.945159 |                 35.762943 |                  1.058179 |            20.705807 |        0.907937 | 0.907937 |      1.0 |
    | 1997-04-08 18:00 |              1.0 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      1.0 |                     15.502754 |                  11.1 |              1.939642 |                 35.762943 |                  0.520255 |            21.743901 |        0.462876 | 0.462876 |      1.0 |
    | 1997-04-08 19:00 |              1.0 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      1.0 |                     15.502754 |                  12.1 |               0.60531 |                 35.762943 |                  0.162358 |             22.89734 |        0.151461 | 0.151461 |      1.0 |
    | 1997-04-08 20:00 |              0.3 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                 0.104711 |                     15.502754 |                  12.4 |              0.005136 |                 35.762943 |                  0.003091 |            23.243371 |        0.002926 | 0.002926 | 0.104711 |
    | 1997-04-08 21:00 |              0.0 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      0.0 |                     15.502754 |                  12.4 |                   0.0 |                 35.762943 |                       0.0 |            23.243371 |             0.0 |      0.0 |      0.0 |
    | 1997-04-08 22:00 |              0.0 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      0.0 |                     15.502754 |                  12.4 |                   0.0 |                 35.762943 |                       0.0 |            23.243371 |             0.0 |      0.0 |      0.0 |
    | 1997-04-08 23:00 |              0.0 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      0.0 |                     15.502754 |                  12.4 |                   0.0 |                 35.762943 |                       0.0 |            23.243371 |             0.0 |      0.0 |      0.0 |
    | 1997-05-08 00:00 |              0.0 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      0.0 |                     15.438712 |                  12.4 |                   0.0 |                 35.520271 |                       0.0 |            23.144579 |             0.0 |      0.0 |      0.0 |
    | 1997-05-08 01:00 |              0.0 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      0.0 |                     15.438712 |                  12.4 |                   0.0 |                 35.520271 |                       0.0 |            23.144579 |             0.0 |      0.0 |      0.0 |
    | 1997-05-08 02:00 |              0.0 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      0.0 |                     15.438712 |                  12.4 |                   0.0 |                 35.520271 |                       0.0 |            23.144579 |             0.0 |      0.0 |      0.0 |
    | 1997-05-08 03:00 |              0.0 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      0.0 |                     15.438712 |                  12.4 |                   0.0 |                 35.520271 |                       0.0 |            23.144579 |             0.0 |      0.0 |      0.0 |
    | 1997-05-08 04:00 |              0.0 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                 0.366022 |                     15.438712 |                  12.4 |              0.063733 |                 35.520271 |                   0.00566 |            23.144579 |        0.005336 | 0.005336 | 0.366022 |
    | 1997-05-08 05:00 |              0.0 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      1.0 |                     15.438712 |                  12.4 |              0.908598 |                 35.520271 |                  0.080684 |            23.144579 |        0.076088 | 0.076088 |      1.0 |
    | 1997-05-08 06:00 |              0.6 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      1.0 |                     15.438712 |                  12.9 |              2.420659 |                 35.520271 |                  0.472904 |            23.719761 |         0.45318 |  0.45318 |      1.0 |
    | 1997-05-08 07:00 |              0.9 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      1.0 |                     15.438712 |                  12.9 |              4.619722 |                 35.520271 |                  1.148656 |            23.719761 |        1.101438 | 1.101438 |      1.0 |
    | 1997-05-08 08:00 |              1.0 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      1.0 |                     15.438712 |                  12.9 |              7.198198 |                 35.520271 |                  1.917614 |            23.719761 |        1.839976 | 1.839976 |      1.0 |
    | 1997-05-08 09:00 |              0.9 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      1.0 |                     15.438712 |                  12.8 |              9.475573 |                 35.520271 |                  2.356024 |            23.604725 |        2.266269 | 2.266269 |      1.0 |
    | 1997-05-08 10:00 |              1.0 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      1.0 |                     15.438712 |                  12.9 |             10.786309 |                 35.520271 |                  2.873495 |            23.719761 |         2.75694 |  2.75694 |      1.0 |
    | 1997-05-08 11:00 |              1.0 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      1.0 |                     15.438712 |                  13.1 |             10.865527 |                 35.520271 |                  2.894599 |            23.949834 |        2.761725 | 2.761725 |      1.0 |
    | 1997-05-08 12:00 |              1.0 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      1.0 |                     15.438712 |                  13.2 |              10.45226 |                 35.520271 |                  2.784503 |             24.06487 |         2.65055 |  2.65055 |      1.0 |
    | 1997-05-08 13:00 |              1.0 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      1.0 |                     15.438712 |                  13.4 |              10.96314 |                 35.520271 |                  2.920603 |            24.294943 |        2.764822 | 2.764822 |      1.0 |
    | 1997-05-08 14:00 |              1.0 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      1.0 |                     15.438712 |                  13.5 |             10.528069 |                 35.520271 |                  2.804699 |            24.409979 |        2.649346 | 2.649346 |      1.0 |
    | 1997-05-08 15:00 |              1.0 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      1.0 |                     15.438712 |                  13.6 |              8.882849 |                 35.520271 |                  2.366409 |            24.525016 |         2.23335 |  2.23335 |      1.0 |
    | 1997-05-08 16:00 |              1.0 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      1.0 |                     15.438712 |                  13.7 |              6.439028 |                 35.520271 |                   1.71537 |            24.640052 |        1.620343 | 1.620343 |      1.0 |
    | 1997-05-08 17:00 |              1.0 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      1.0 |                     15.438712 |                  13.7 |              3.911896 |                 35.520271 |                  1.042137 |            24.640052 |        0.985011 | 0.985011 |      1.0 |
    | 1997-05-08 18:00 |              1.0 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      1.0 |                     15.438712 |                  13.7 |              1.905864 |                 35.520271 |                  0.507726 |            24.640052 |        0.480125 | 0.480125 |      1.0 |
    | 1997-05-08 19:00 |              1.0 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      1.0 |                     15.438712 |                  13.7 |              0.576079 |                 35.520271 |                  0.153469 |            24.640052 |        0.145175 | 0.145175 |      1.0 |
    | 1997-05-08 20:00 |              0.5 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                 0.072689 |                     15.438712 |                  13.9 |              0.002495 |                 35.520271 |                  0.003269 |            24.870125 |        0.003122 | 0.003122 | 0.072689 |
    | 1997-05-08 21:00 |              0.0 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      0.0 |                     15.438712 |                  13.9 |                   0.0 |                 35.520271 |                       0.0 |            24.870125 |             0.0 |      0.0 |      0.0 |
    | 1997-05-08 22:00 |              0.0 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      0.0 |                     15.438712 |                  13.9 |                   0.0 |                 35.520271 |                       0.0 |            24.870125 |             0.0 |      0.0 |      0.0 |
    | 1997-05-08 23:00 |              0.0 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      0.0 |                     15.438712 |                  13.9 |                   0.0 |                 35.520271 |                       0.0 |            24.870125 |             0.0 |      0.0 |      0.0 |

.. _meteo_v003_hourly_simulation_winter:

hourly simulation winter
________________________

This test is similar to the :ref:`meteo_v003_hourly_simulation_summer` example but
deals with winter conditions:

>>> pub.timegrids = "2010-12-10", "2010-12-13", "1h"

>>> inputs.sunshineduration.series = (
...     0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1, 0.0, 0.0, 0.0, 0.0,
...     0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
...     0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
...     0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2, 0.2,
...     0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0)

>>> test.inits = (
...     (logs.loggedsunshineduration,
...      [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.04, 0.25, 0.59, 0.91,
...       0.97, 1.0, 0.65, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]),
...     (logs.loggedunadjustedglobalradiation,
...      [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1, 0.2, 0.4, 0.6, 0.5, 0.2,
...       0.0,0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]))

.. integration-test::

    >>> test("meteo_v003_hourly_winter")
    |             date | sunshineduration | earthsundistance | solardeclination | timeofsunrise | timeofsunset | possiblesunshineduration | dailypossiblesunshineduration | dailysunshineduration | portiondailyradiation | extraterrestrialradiation | unadjustedglobalradiation | dailyglobalradiation | globalradiation |    node1 |    node2 |
    ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    | 2010-10-12 00:00 |              0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      0.0 |                       7.41713 |                  4.41 |                   0.0 |                  5.246826 |                       0.0 |             2.871508 |             0.0 |      0.0 |      0.0 |
    | 2010-10-12 01:00 |              0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      0.0 |                       7.41713 |                  4.41 |                   0.0 |                  5.246826 |                       0.0 |             2.871508 |             0.0 |      0.0 |      0.0 |
    | 2010-10-12 02:00 |              0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      0.0 |                       7.41713 |                  4.41 |                   0.0 |                  5.246826 |                       0.0 |             2.871508 |             0.0 |      0.0 |      0.0 |
    | 2010-10-12 03:00 |              0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      0.0 |                       7.41713 |                  4.41 |                   0.0 |                  5.246826 |                       0.0 |             2.871508 |             0.0 |      0.0 |      0.0 |
    | 2010-10-12 04:00 |              0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      0.0 |                       7.41713 |                  4.41 |                   0.0 |                  5.246826 |                       0.0 |             2.871508 |             0.0 |      0.0 |      0.0 |
    | 2010-10-12 05:00 |              0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      0.0 |                       7.41713 |                  4.41 |                   0.0 |                  5.246826 |                       0.0 |             2.871508 |             0.0 |      0.0 |      0.0 |
    | 2010-10-12 06:00 |              0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      0.0 |                       7.41713 |                  4.41 |                   0.0 |                  5.246826 |                       0.0 |             2.871508 |             0.0 |      0.0 |      0.0 |
    | 2010-10-12 07:00 |              0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      0.0 |                       7.41713 |                  3.76 |                   0.0 |                  5.246826 |                       0.0 |             2.641605 |             0.0 |      0.0 |      0.0 |
    | 2010-10-12 08:00 |              0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                 0.355232 |                       7.41713 |                  2.76 |              0.266196 |                  5.246826 |                  0.003492 |             2.287909 |        0.003987 | 0.003987 | 0.355232 |
    | 2010-10-12 09:00 |              0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      1.0 |                       7.41713 |                  1.79 |              4.919884 |                  5.246826 |                  0.064534 |             1.944823 |        0.067188 | 0.067188 |      1.0 |
    | 2010-10-12 10:00 |              0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      1.0 |                       7.41713 |                  0.88 |             14.873457 |                  5.246826 |                  0.195096 |             1.622959 |        0.202564 | 0.202564 |      1.0 |
    | 2010-10-12 11:00 |              0.1 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      1.0 |                       7.41713 |                  0.39 |             22.189872 |                  5.246826 |                  0.349279 |             1.449648 |        0.385806 | 0.385806 |      1.0 |
    | 2010-10-12 12:00 |              0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      1.0 |                       7.41713 |                  0.14 |             22.197307 |                  5.246826 |                  0.291164 |             1.361224 |        0.329304 | 0.329304 |      1.0 |
    | 2010-10-12 13:00 |              0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      1.0 |                       7.41713 |                   0.1 |             20.962863 |                  5.246826 |                  0.274971 |             1.347076 |        0.289712 | 0.289712 |      1.0 |
    | 2010-10-12 14:00 |              0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      1.0 |                       7.41713 |                   0.1 |             11.702396 |                  5.246826 |                  0.153501 |             1.347076 |        0.155234 | 0.155234 |      1.0 |
    | 2010-10-12 15:00 |              0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      1.0 |                       7.41713 |                   0.1 |              2.880181 |                  5.246826 |                   0.03778 |             1.347076 |        0.037152 | 0.037152 |      1.0 |
    | 2010-10-12 16:00 |              0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                 0.061898 |                       7.41713 |                   0.1 |              0.007844 |                  5.246826 |                  0.000103 |             1.347076 |        0.000101 | 0.000101 | 0.061898 |
    | 2010-10-12 17:00 |              0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      0.0 |                       7.41713 |                   0.1 |                   0.0 |                  5.246826 |                       0.0 |             1.347076 |             0.0 |      0.0 |      0.0 |
    | 2010-10-12 18:00 |              0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      0.0 |                       7.41713 |                   0.1 |                   0.0 |                  5.246826 |                       0.0 |             1.347076 |             0.0 |      0.0 |      0.0 |
    | 2010-10-12 19:00 |              0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      0.0 |                       7.41713 |                   0.1 |                   0.0 |                  5.246826 |                       0.0 |             1.347076 |             0.0 |      0.0 |      0.0 |
    | 2010-10-12 20:00 |              0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      0.0 |                       7.41713 |                   0.1 |                   0.0 |                  5.246826 |                       0.0 |             1.347076 |             0.0 |      0.0 |      0.0 |
    | 2010-10-12 21:00 |              0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      0.0 |                       7.41713 |                   0.1 |                   0.0 |                  5.246826 |                       0.0 |             1.347076 |             0.0 |      0.0 |      0.0 |
    | 2010-10-12 22:00 |              0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      0.0 |                       7.41713 |                   0.1 |                   0.0 |                  5.246826 |                       0.0 |             1.347076 |             0.0 |      0.0 |      0.0 |
    | 2010-10-12 23:00 |              0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      0.0 |                       7.41713 |                   0.1 |                   0.0 |                  5.246826 |                       0.0 |             1.347076 |             0.0 |      0.0 |      0.0 |
    | 2010-11-12 00:00 |              0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      0.0 |                      7.400749 |                   0.1 |                   0.0 |                  5.210498 |                       0.0 |             1.337827 |             0.0 |      0.0 |      0.0 |
    | 2010-11-12 01:00 |              0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      0.0 |                      7.400749 |                   0.1 |                   0.0 |                  5.210498 |                       0.0 |             1.337827 |             0.0 |      0.0 |      0.0 |
    | 2010-11-12 02:00 |              0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      0.0 |                      7.400749 |                   0.1 |                   0.0 |                  5.210498 |                       0.0 |             1.337827 |             0.0 |      0.0 |      0.0 |
    | 2010-11-12 03:00 |              0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      0.0 |                      7.400749 |                   0.1 |                   0.0 |                  5.210498 |                       0.0 |             1.337827 |             0.0 |      0.0 |      0.0 |
    | 2010-11-12 04:00 |              0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      0.0 |                      7.400749 |                   0.1 |                   0.0 |                  5.210498 |                       0.0 |             1.337827 |             0.0 |      0.0 |      0.0 |
    | 2010-11-12 05:00 |              0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      0.0 |                      7.400749 |                   0.1 |                   0.0 |                  5.210498 |                       0.0 |             1.337827 |             0.0 |      0.0 |      0.0 |
    | 2010-11-12 06:00 |              0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      0.0 |                      7.400749 |                   0.1 |                   0.0 |                  5.210498 |                       0.0 |             1.337827 |             0.0 |      0.0 |      0.0 |
    | 2010-11-12 07:00 |              0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      0.0 |                      7.400749 |                   0.1 |                   0.0 |                  5.210498 |                       0.0 |             1.337827 |             0.0 |      0.0 |      0.0 |
    | 2010-11-12 08:00 |              0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                 0.347041 |                      7.400749 |                   0.1 |              0.254871 |                  5.210498 |                   0.00332 |             1.337827 |        0.003243 | 0.003243 | 0.347041 |
    | 2010-11-12 09:00 |              0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      1.0 |                      7.400749 |                   0.1 |              4.882681 |                  5.210498 |                  0.063603 |             1.337827 |        0.062163 | 0.062163 |      1.0 |
    | 2010-11-12 10:00 |              0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      1.0 |                      7.400749 |                   0.1 |             14.862249 |                  5.210498 |                  0.193599 |             1.337827 |        0.189423 | 0.189423 |      1.0 |
    | 2010-11-12 11:00 |              0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      1.0 |                      7.400749 |                   0.0 |              22.23196 |                  5.210498 |                  0.289599 |             1.302624 |        0.288488 | 0.288488 |      1.0 |
    | 2010-11-12 12:00 |              0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      1.0 |                      7.400749 |                   0.0 |             22.247803 |                  5.210498 |                  0.289805 |             1.302624 |        0.288994 | 0.288994 |      1.0 |
    | 2010-11-12 13:00 |              0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      1.0 |                      7.400749 |                   0.0 |             20.992726 |                  5.210498 |                  0.273456 |             1.302624 |        0.273007 | 0.273007 |      1.0 |
    | 2010-11-12 14:00 |              0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      1.0 |                      7.400749 |                   0.0 |             11.677032 |                  5.210498 |                  0.152108 |             1.302624 |         0.15202 |  0.15202 |      1.0 |
    | 2010-11-12 15:00 |              0.1 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      1.0 |                      7.400749 |                   0.1 |              2.844748 |                  5.210498 |                  0.044468 |             1.337827 |         0.04541 |  0.04541 |      1.0 |
    | 2010-11-12 16:00 |              0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                 0.053708 |                      7.400749 |                   0.1 |               0.00593 |                  5.210498 |                  0.000077 |             1.337827 |        0.000079 | 0.000079 | 0.053708 |
    | 2010-11-12 17:00 |              0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      0.0 |                      7.400749 |                   0.1 |                   0.0 |                  5.210498 |                       0.0 |             1.337827 |             0.0 |      0.0 |      0.0 |
    | 2010-11-12 18:00 |              0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      0.0 |                      7.400749 |                   0.1 |                   0.0 |                  5.210498 |                       0.0 |             1.337827 |             0.0 |      0.0 |      0.0 |
    | 2010-11-12 19:00 |              0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      0.0 |                      7.400749 |                   0.1 |                   0.0 |                  5.210498 |                       0.0 |             1.337827 |             0.0 |      0.0 |      0.0 |
    | 2010-11-12 20:00 |              0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      0.0 |                      7.400749 |                   0.1 |                   0.0 |                  5.210498 |                       0.0 |             1.337827 |             0.0 |      0.0 |      0.0 |
    | 2010-11-12 21:00 |              0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      0.0 |                      7.400749 |                   0.1 |                   0.0 |                  5.210498 |                       0.0 |             1.337827 |             0.0 |      0.0 |      0.0 |
    | 2010-11-12 22:00 |              0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      0.0 |                      7.400749 |                   0.1 |                   0.0 |                  5.210498 |                       0.0 |             1.337827 |             0.0 |      0.0 |      0.0 |
    | 2010-11-12 23:00 |              0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      0.0 |                      7.400749 |                   0.1 |                   0.0 |                  5.210498 |                       0.0 |             1.337827 |             0.0 |      0.0 |      0.0 |
    | 2010-12-12 00:00 |              0.0 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      0.0 |                      7.386143 |                   0.1 |                   0.0 |                  5.178293 |                       0.0 |             1.329627 |             0.0 |      0.0 |      0.0 |
    | 2010-12-12 01:00 |              0.0 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      0.0 |                      7.386143 |                   0.1 |                   0.0 |                  5.178293 |                       0.0 |             1.329627 |             0.0 |      0.0 |      0.0 |
    | 2010-12-12 02:00 |              0.0 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      0.0 |                      7.386143 |                   0.1 |                   0.0 |                  5.178293 |                       0.0 |             1.329627 |             0.0 |      0.0 |      0.0 |
    | 2010-12-12 03:00 |              0.0 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      0.0 |                      7.386143 |                   0.1 |                   0.0 |                  5.178293 |                       0.0 |             1.329627 |             0.0 |      0.0 |      0.0 |
    | 2010-12-12 04:00 |              0.0 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      0.0 |                      7.386143 |                   0.1 |                   0.0 |                  5.178293 |                       0.0 |             1.329627 |             0.0 |      0.0 |      0.0 |
    | 2010-12-12 05:00 |              0.0 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      0.0 |                      7.386143 |                   0.1 |                   0.0 |                  5.178293 |                       0.0 |             1.329627 |             0.0 |      0.0 |      0.0 |
    | 2010-12-12 06:00 |              0.0 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      0.0 |                      7.386143 |                   0.1 |                   0.0 |                  5.178293 |                       0.0 |             1.329627 |             0.0 |      0.0 |      0.0 |
    | 2010-12-12 07:00 |              0.0 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      0.0 |                      7.386143 |                   0.1 |                   0.0 |                  5.178293 |                       0.0 |             1.329627 |             0.0 |      0.0 |      0.0 |
    | 2010-12-12 08:00 |              0.0 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                 0.339738 |                      7.386143 |                   0.1 |              0.244956 |                  5.178293 |                  0.003171 |             1.329627 |        0.003219 | 0.003219 | 0.339738 |
    | 2010-12-12 09:00 |              0.0 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      1.0 |                      7.386143 |                   0.1 |              4.849391 |                  5.178293 |                  0.062779 |             1.329627 |        0.063765 | 0.063765 |      1.0 |
    | 2010-12-12 10:00 |              0.0 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      1.0 |                      7.386143 |                   0.1 |             14.852029 |                  5.178293 |                   0.19227 |             1.329627 |        0.195489 | 0.195489 |      1.0 |
    | 2010-12-12 11:00 |              0.0 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      1.0 |                      7.386143 |                   0.1 |             22.269583 |                  5.178293 |                  0.288296 |             1.329627 |        0.293415 | 0.293415 |      1.0 |
    | 2010-12-12 12:00 |              0.0 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      1.0 |                      7.386143 |                   0.1 |             22.293018 |                  5.178293 |                  0.288599 |             1.329627 |        0.293995 | 0.293995 |      1.0 |
    | 2010-12-12 13:00 |              0.0 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      1.0 |                      7.386143 |                   0.1 |             21.019348 |                  5.178293 |                  0.272111 |             1.329627 |        0.277484 | 0.277484 |      1.0 |
    | 2010-12-12 14:00 |              0.2 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      1.0 |                      7.386143 |                   0.3 |             11.654171 |                  5.178293 |                   0.21122 |             1.399736 |        0.216915 | 0.216915 |      1.0 |
    | 2010-12-12 15:00 |              0.2 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      1.0 |                      7.386143 |                   0.4 |              2.813062 |                  5.178293 |                  0.050984 |              1.43479 |        0.053414 | 0.053414 |      1.0 |
    | 2010-12-12 16:00 |              0.2 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                 0.046405 |                      7.386143 |                   0.6 |              0.004444 |                  5.178293 |                  0.000553 |             1.504898 |        0.000608 | 0.000608 | 0.046405 |
    | 2010-12-12 17:00 |              0.0 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      0.0 |                      7.386143 |                   0.6 |                   0.0 |                  5.178293 |                       0.0 |             1.504898 |             0.0 |      0.0 |      0.0 |
    | 2010-12-12 18:00 |              0.0 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      0.0 |                      7.386143 |                   0.6 |                   0.0 |                  5.178293 |                       0.0 |             1.504898 |             0.0 |      0.0 |      0.0 |
    | 2010-12-12 19:00 |              0.0 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      0.0 |                      7.386143 |                   0.6 |                   0.0 |                  5.178293 |                       0.0 |             1.504898 |             0.0 |      0.0 |      0.0 |
    | 2010-12-12 20:00 |              0.0 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      0.0 |                      7.386143 |                   0.6 |                   0.0 |                  5.178293 |                       0.0 |             1.504898 |             0.0 |      0.0 |      0.0 |
    | 2010-12-12 21:00 |              0.0 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      0.0 |                      7.386143 |                   0.6 |                   0.0 |                  5.178293 |                       0.0 |             1.504898 |             0.0 |      0.0 |      0.0 |
    | 2010-12-12 22:00 |              0.0 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      0.0 |                      7.386143 |                   0.6 |                   0.0 |                  5.178293 |                       0.0 |             1.504898 |             0.0 |      0.0 |      0.0 |
    | 2010-12-12 23:00 |              0.0 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      0.0 |                      7.386143 |                   0.6 |                   0.0 |                  5.178293 |                       0.0 |             1.504898 |             0.0 |      0.0 |      0.0 |
"""
# import...
# ...from HydPy
from hydpy.exe.modelimports import *
from hydpy.core import modeltools
from hydpy.models.meteo import meteo_model


class Model(modeltools.AdHocModel):
    """Version 3 of the Meteo model."""

    INLET_METHODS = ()
    RECEIVER_METHODS = ()
    RUN_METHODS = (
        meteo_model.Calc_EarthSunDistance_V1,
        meteo_model.Calc_SolarDeclination_V2,
        meteo_model.Calc_TimeOfSunrise_TimeOfSunset_V1,
        meteo_model.Calc_DailyPossibleSunshineDuration_V1,
        meteo_model.Calc_PossibleSunshineDuration_V2,
        meteo_model.Update_LoggedSunshineDuration_V1,
        meteo_model.Calc_DailySunshineDuration_V1,
        meteo_model.Calc_ExtraterrestrialRadiation_V2,
        meteo_model.Calc_DailyGlobalRadiation_V1,
        meteo_model.Calc_PortionDailyRadiation_V1,
        meteo_model.Calc_UnadjustedGlobalRadiation_V1,
        meteo_model.Update_LoggedUnadjustedGlobalRadiation_V1,
        meteo_model.Calc_GlobalRadiation_V2,
    )
    ADD_METHODS = (meteo_model.Return_DailyGlobalRadiation_V1,)
    OUTLET_METHODS = ()
    SENDER_METHODS = ()
    SUBMODELS = ()


tester = Tester()
cythonizer = Cythonizer()
