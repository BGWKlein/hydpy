# -*- coding: utf-8 -*-
# pylint: disable=line-too-long, unused-wildcard-import
"""Model for estimating sunshine duration based on global radiation following the
`LARSIM`_ model.

.. _`LARSIM`: http://www.larsim.de/en/the-model/

|meteo_v004| is similar to |meteo_v003| but uses |meteo_inputs.GlobalRadiation| to
estimate |meteo_factors.SunshineDuration|, while |meteo_v003| uses
|meteo_inputs.SunshineDuration| to estimate |meteo_fluxes.GlobalRadiation|.  So, the
relationship of |meteo_v004| and |meteo_v003| corresponds to the one of |meteo_v002|
and |meteo_v001|.  However, opposed to |meteo_v002| and |meteo_v001|, |meteo_v004|
"inverts" |meteo_v003| only approximately for sub-daily simulation time steps.  This
deficit is primarily due to the "daily radiation adjustment" described in the
documentation of |meteo_v003|.

.. note::

   |meteo_v004| is still under discussion.  Please be aware that we might modify it
   later if we find a way to achieve higher agreements with |meteo_v003|.

.. _`LARSIM`: http://www.larsim.de/en/the-model/


Integration tests
=================

.. how_to_understand_integration_tests::

We design all integration tests as similar to those of |meteo_v003|.  This time, we
select |meteo_factors.SunshineDuration| and |meteo_factors.PossibleSunshineDuration| as
output sequences:

>>> from hydpy import Element, Node
>>> from hydpy.outputs import meteo_SunshineDuration, meteo_PossibleSunshineDuration
>>> node1 = Node("node1", variable=meteo_SunshineDuration)
>>> node2 = Node("node2", variable=meteo_PossibleSunshineDuration)

>>> from hydpy.models.meteo_v004 import *
>>> parameterstep()
>>> element = Element("element", outputs=(node1, node2))
>>> element.model = model

We take all parameter values without modifications.  But note that |meteo_v004| does
not use the parameter |AngstromAlternative| (ideas to include it sensibly are welcome):

>>> latitude(54.1)
>>> longitude(9.7)
>>> angstromconstant(0.25)
>>> angstromfactor(0.5)

.. _meteo_v004_daily_simulation_summer:

daily simulation summer
_______________________

We repeat the :ref:`meteo_v003_daily_simulation_summer` example of |meteo_v003| but use
its global radiation result as input:

>>> from hydpy import IntegrationTest, pub
>>> pub.timegrids = "1997-08-01", "1997-09-01", "1d"
>>> test = IntegrationTest(element)
>>> test.axis1 = (inputs.globalradiation,)
>>> test.axis2 = (factors.sunshineduration, factors.possiblesunshineduration,)
>>> test.dateformat = "%Y-%d-%m"

>>> inputs.globalradiation.series = (
...     16.43772876, 11.02989158, 14.20427213, 23.24337134, 24.87012485, 23.73185633,
...     24.54173784, 22.72071715, 23.52295413, 23.07046042, 23.29573363, 23.40388433,
...     22.61063495, 19.69592678, 18.69318616, 19.58151487, 20.34966262, 20.11819061,
...     17.2552455, 20.19789234, 21.26487912, 7.82658806, 14.85604741, 18.70990381,
...     14.42161408, 12.61315678, 14.30299212, 7.57670506, 7.28843486, 12.2955151,
...     10.94878758)

|meteo_v004| calculates a sunshine duration series equal to the one we use in the
:ref:`meteo_v003_daily_simulation_summer` example of |meteo_v003| as input:

.. integration-test::

    >>> test("meteo_v004_daily_summer")
    |       date | globalradiation | earthsundistance | solardeclination | timeofsunrise | timeofsunset | possiblesunshineduration | dailypossiblesunshineduration | unadjustedsunshineduration | sunshineduration | dailysunshineduration | portiondailyradiation | extraterrestrialradiation | dailyglobalradiation | node1 |     node2 |
    ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    | 1997-01-08 |       16.437729 |         0.971564 |         0.307429 |      4.507941 |    20.198726 |                15.690785 |                     15.690785 |                        6.3 |              6.3 |                   6.3 |                 100.0 |                  36.46712 |            16.437729 |   6.3 | 15.690785 |
    | 1997-02-08 |       11.029892 |         0.971855 |         0.302714 |      4.538923 |    20.167744 |                15.628821 |                     15.628821 |                        1.7 |              1.7 |                   1.7 |                 100.0 |                 36.236444 |            11.029892 |   1.7 | 15.628821 |
    | 1997-03-08 |       14.204272 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                15.566134 |                     15.566134 |                        4.5 |              4.5 |                   4.5 |                 100.0 |                 36.001693 |            14.204272 |   4.5 | 15.566134 |
    | 1997-04-08 |       23.243371 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                15.502754 |                     15.502754 |                       12.4 |             12.4 |                  12.4 |                 100.0 |                 35.762943 |            23.243371 |  12.4 | 15.502754 |
    | 1997-05-08 |       24.870125 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                15.438712 |                     15.438712 |                       13.9 |             13.9 |                  13.9 |                 100.0 |                 35.520271 |            24.870125 |  13.9 | 15.438712 |
    | 1997-06-08 |       23.731856 |         0.973104 |         0.282971 |      4.666316 |     20.04035 |                15.374034 |                     15.374034 |                       13.0 |             13.0 |                  13.0 |                 100.0 |                 35.273753 |            23.731856 |  13.0 | 15.374034 |
    | 1997-07-08 |       24.541738 |         0.973436 |         0.277822 |      4.698958 |    20.007708 |                 15.30875 |                      15.30875 |                       13.8 |             13.8 |                  13.8 |                 100.0 |                  35.02347 |            24.541738 |  13.8 |  15.30875 |
    | 1997-08-08 |       22.720717 |         0.973776 |         0.272591 |      4.731891 |    19.974776 |                15.242885 |                     15.242885 |                       12.3 |             12.3 |                  12.3 |                 100.0 |                 34.769499 |            22.720717 |  12.3 | 15.242885 |
    | 1997-09-08 |       23.522954 |         0.974124 |         0.267279 |        4.7651 |    19.941567 |                15.176467 |                     15.176467 |                       13.1 |             13.1 |                  13.1 |                 100.0 |                 34.511921 |            23.522954 |  13.1 | 15.176467 |
    | 1997-10-08 |        23.07046 |         0.974479 |         0.261887 |      4.798573 |    19.908094 |                15.109521 |                     15.109521 |                       12.8 |             12.8 |                  12.8 |                 100.0 |                 34.250819 |             23.07046 |  12.8 | 15.109521 |
    | 1997-11-08 |       23.295734 |         0.974842 |         0.256418 |      4.832298 |    19.874369 |                15.042071 |                     15.042071 |                       13.1 |             13.1 |                  13.1 |                 100.0 |                 33.986274 |            23.295734 |  13.1 | 15.042071 |
    | 1997-12-08 |       23.403884 |         0.975213 |         0.250873 |      4.866263 |    19.840404 |                14.974141 |                     14.974141 |                       13.3 |             13.3 |                  13.3 |                 100.0 |                  33.71837 |            23.403884 |  13.3 | 14.974141 |
    | 1997-13-08 |       22.610635 |          0.97559 |         0.245254 |      4.900456 |    19.806211 |                14.905755 |                     14.905755 |                       12.7 |             12.7 |                  12.7 |                 100.0 |                 33.447192 |            22.610635 |  12.7 | 14.905755 |
    | 1997-14-08 |       19.695927 |         0.975975 |         0.239562 |      4.934866 |      19.7718 |                14.836934 |                     14.836934 |                       10.2 |             10.2 |                  10.2 |                 100.0 |                 33.172825 |            19.695927 |  10.2 | 14.836934 |
    | 1997-15-08 |       18.693186 |         0.976367 |         0.233799 |      4.969483 |    19.737183 |                  14.7677 |                       14.7677 |                        9.4 |              9.4 |                   9.4 |                 100.0 |                 32.895357 |            18.693186 |   9.4 |   14.7677 |
    | 1997-16-08 |       19.581515 |         0.976766 |         0.227967 |      5.004296 |    19.702371 |                14.698075 |                     14.698075 |                       10.3 |             10.3 |                  10.3 |                 100.0 |                 32.614875 |            19.581515 |  10.3 | 14.698075 |
    | 1997-17-08 |       20.349663 |         0.977172 |         0.222067 |      5.039294 |    19.667372 |                14.628078 |                     14.628078 |                       11.1 |             11.1 |                  11.1 |                 100.0 |                 32.331467 |            20.349663 |  11.1 | 14.628078 |
    | 1997-18-08 |       20.118191 |         0.977584 |         0.216102 |      5.074469 |    19.632198 |                14.557728 |                     14.557728 |                       11.0 |             11.0 |                  11.0 |                 100.0 |                 32.045225 |            20.118191 |  11.0 | 14.557728 |
    | 1997-19-08 |       17.255246 |         0.978003 |         0.210072 |       5.10981 |    19.596856 |                14.487046 |                     14.487046 |                        8.5 |              8.5 |                   8.5 |                 100.0 |                 31.756238 |            17.255246 |   8.5 | 14.487046 |
    | 1997-20-08 |       20.197892 |         0.978429 |          0.20398 |      5.145309 |    19.561357 |                14.416048 |                     14.416048 |                       11.3 |             11.3 |                  11.3 |                 100.0 |                   31.4646 |            20.197892 |  11.3 | 14.416048 |
    | 1997-21-08 |       21.264879 |          0.97886 |         0.197828 |      5.180957 |    19.525709 |                14.344752 |                     14.344752 |                       12.4 |             12.4 |                  12.4 |                 100.0 |                 31.170402 |            21.264879 |  12.4 | 14.344752 |
    | 1997-22-08 |        7.826588 |         0.979299 |         0.191617 |      5.216746 |    19.489921 |                14.273175 |                     14.273175 |                        0.1 |              0.1 |                   0.1 |                 100.0 |                  30.87374 |             7.826588 |   0.1 | 14.273175 |
    | 1997-23-08 |       14.856047 |         0.979743 |          0.18535 |      5.252667 |       19.454 |                14.201333 |                     14.201333 |                        6.7 |              6.7 |                   6.7 |                 100.0 |                 30.574709 |            14.856047 |   6.7 | 14.201333 |
    | 1997-24-08 |       18.709904 |         0.980193 |         0.179027 |      5.288712 |    19.417955 |                14.129243 |                     14.129243 |                       10.4 |             10.4 |                  10.4 |                 100.0 |                 30.273404 |            18.709904 |  10.4 | 14.129243 |
    | 1997-25-08 |       14.421614 |         0.980649 |         0.172651 |      5.324874 |    19.381792 |                14.056918 |                     14.056918 |                        6.5 |              6.5 |                   6.5 |                 100.0 |                 29.969924 |            14.421614 |   6.5 | 14.056918 |
    | 1997-26-08 |       12.613157 |         0.981111 |         0.166225 |      5.361147 |     19.34552 |                13.984374 |                     13.984374 |                        4.9 |              4.9 |                   4.9 |                 100.0 |                 29.664367 |            12.613157 |   4.9 | 13.984374 |
    | 1997-27-08 |       14.302992 |         0.981578 |         0.159748 |      5.397522 |    19.309145 |                13.911624 |                     13.911624 |                        6.6 |              6.6 |                   6.6 |                 100.0 |                 29.356832 |            14.302992 |   6.6 | 13.911624 |
    | 1997-28-08 |        7.576705 |         0.982051 |         0.153225 |      5.433993 |    19.272674 |                13.838682 |                     13.838682 |                        0.3 |              0.3 |                   0.3 |                 100.0 |                 29.047419 |             7.576705 |   0.3 | 13.838682 |
    | 1997-29-08 |        7.288435 |         0.982529 |         0.146656 |      5.470553 |    19.236114 |                13.765561 |                     13.765561 |                        0.1 |              0.1 |                   0.1 |                 100.0 |                  28.73623 |             7.288435 |   0.1 | 13.765561 |
    | 1997-30-08 |       12.295515 |         0.983012 |         0.140044 |      5.507197 |     19.19947 |                13.692273 |                     13.692273 |                        5.0 |              5.0 |                   5.0 |                 100.0 |                 28.423368 |            12.295515 |   5.0 | 13.692273 |
    | 1997-31-08 |       10.948788 |           0.9835 |          0.13339 |      5.543918 |    19.162749 |                13.618831 |                     13.618831 |                        3.8 |              3.8 |                   3.8 |                 100.0 |                 28.108935 |            10.948788 |   3.8 | 13.618831 |

.. _meteo_v004_daily_simulation_winter:

daily simulation winter
_______________________

We repeat the :ref:`meteo_v003_daily_simulation_winter` example of |meteo_v003| but use
its global radiation results as input:

>>> pub.timegrids = "2010-12-01", "2011-01-01", "1d"

>>> inputs.globalradiation.series = (
...     2.75985776, 0.85310482, 1.44145438, 2.74816174, 0.82360891, 1.39462425,
...     0.80709944, 0.79978444, 2.88626242, 1.34707609, 1.37302942, 1.53995203,
...     0.77253039, 1.69932107, 2.31824864, 0.7635806, 0.76182474, 0.76068162,
...     0.76015099, 1.33615405, 1.54479236, 0.76223473, 0.76415582, 0.76669135,
...     2.39843304, 2.79320446, 0.77799591, 2.50407253, 0.78862856, 0.79487909,
...     2.77017706)

Again, there is a perfect agreement regarding the sunshine duration:

.. integration-test::

    >>> test("meteo_v004_daily_winter")
    |       date | globalradiation | earthsundistance | solardeclination | timeofsunrise | timeofsunset | possiblesunshineduration | dailypossiblesunshineduration | unadjustedsunshineduration | sunshineduration | dailysunshineduration | portiondailyradiation | extraterrestrialradiation | dailyglobalradiation | node1 |    node2 |
    --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    | 2010-01-12 |        2.759858 |         1.028719 |        -0.389384 |      8.532819 |    16.173848 |                 7.641029 |                      7.641029 |                        3.5 |              3.5 |                   3.5 |                 100.0 |                  5.761386 |             2.759858 |   3.5 | 7.641029 |
    | 2010-02-12 |        0.853105 |         1.028994 |        -0.391536 |      8.548511 |    16.158156 |                 7.609644 |                      7.609644 |                        0.0 |              0.0 |                   0.0 |                 100.0 |                  5.687365 |             0.853105 |   0.0 | 7.609644 |
    | 2010-03-12 |        1.441454 |          1.02926 |        -0.393572 |      8.563421 |    16.143245 |                 7.579824 |                      7.579824 |                        0.1 |              0.1 |                   0.1 |                 100.0 |                  5.617593 |             1.441454 |   0.1 | 7.579824 |
    | 2010-04-12 |        2.748162 |         1.029518 |        -0.395492 |      8.577535 |    16.129131 |                 7.551596 |                      7.551596 |                        3.7 |              3.7 |                   3.7 |                 100.0 |                  5.552051 |             2.748162 |   3.7 | 7.551596 |
    | 2010-05-12 |        0.823609 |         1.029767 |        -0.397294 |      8.590839 |    16.115828 |                 7.524989 |                      7.524989 |                        0.0 |              0.0 |                   0.0 |                 100.0 |                  5.490726 |             0.823609 |   0.0 | 7.524989 |
    | 2010-06-12 |        1.394624 |         1.030007 |        -0.398979 |      8.603319 |    16.103347 |                 7.500028 |                      7.500028 |                        0.1 |              0.1 |                   0.1 |                 100.0 |                  5.433602 |             1.394624 |   0.1 | 7.500028 |
    | 2010-07-12 |        0.807099 |         1.030238 |        -0.400545 |      8.614964 |    16.091703 |                 7.476739 |                      7.476739 |                        0.0 |              0.0 |                   0.0 |                 100.0 |                  5.380663 |             0.807099 |   0.0 | 7.476739 |
    | 2010-08-12 |        0.799784 |         1.030461 |        -0.401992 |      8.625761 |    16.080906 |                 7.455145 |                      7.455145 |                        0.0 |              0.0 |                   0.0 |                 100.0 |                  5.331896 |             0.799784 |   0.0 | 7.455145 |
    | 2010-09-12 |        2.886262 |         1.030674 |        -0.403321 |      8.635699 |    16.070967 |                 7.435268 |                      7.435268 |                        4.4 |              4.4 |                   4.4 |                 100.0 |                  5.287288 |             2.886262 |   4.4 | 7.435268 |
    | 2010-10-12 |        1.347076 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                  7.41713 |                       7.41713 |                        0.1 |              0.1 |                   0.1 |                 100.0 |                  5.246826 |             1.347076 |   0.1 |  7.41713 |
    | 2010-11-12 |        1.373029 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                 7.400749 |                      7.400749 |                        0.2 |              0.2 |                   0.2 |                 100.0 |                  5.210498 |             1.373029 |   0.2 | 7.400749 |
    | 2010-12-12 |        1.539952 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                 7.386143 |                      7.386143 |                        0.7 |              0.7 |                   0.7 |                 100.0 |                  5.178293 |             1.539952 |   0.7 | 7.386143 |
    | 2010-13-12 |         0.77253 |         1.031437 |        -0.407436 |      8.666669 |    16.039997 |                 7.373328 |                      7.373328 |                        0.0 |              0.0 |                   0.0 |                 100.0 |                  5.150203 |              0.77253 |   0.0 | 7.373328 |
    | 2010-14-12 |        1.699321 |         1.031605 |        -0.408164 |      8.672175 |    16.034492 |                 7.362317 |                      7.362317 |                        1.2 |              1.2 |                   1.2 |                 100.0 |                  5.126218 |             1.699321 |   1.2 | 7.362317 |
    | 2010-15-12 |        2.318249 |         1.031763 |         -0.40877 |      8.676772 |    16.029895 |                 7.353123 |                      7.353123 |                        3.0 |              3.0 |                   3.0 |                 100.0 |                  5.106331 |             2.318249 |   3.0 | 7.353123 |
    | 2010-16-12 |        0.763581 |         1.031912 |        -0.409256 |      8.680456 |    16.026211 |                 7.345755 |                      7.345755 |                        0.0 |              0.0 |                   0.0 |                 100.0 |                  5.090537 |             0.763581 |   0.0 | 7.345755 |
    | 2010-17-12 |        0.761825 |         1.032051 |         -0.40962 |      8.683222 |    16.023444 |                 7.340222 |                      7.340222 |                        0.0 |              0.0 |                   0.0 |                 100.0 |                  5.078832 |             0.761825 |   0.0 | 7.340222 |
    | 2010-18-12 |        0.760682 |         1.032182 |        -0.409863 |      8.685068 |    16.021598 |                  7.33653 |                       7.33653 |                        0.0 |              0.0 |                   0.0 |                 100.0 |                  5.071211 |             0.760682 |   0.0 |  7.33653 |
    | 2010-19-12 |        0.760151 |         1.032302 |        -0.409985 |      8.685992 |    16.020675 |                 7.334683 |                      7.334683 |                        0.0 |              0.0 |                   0.0 |                 100.0 |                  5.067673 |             0.760151 |   0.0 | 7.334683 |
    | 2010-20-12 |        1.336154 |         1.032413 |        -0.409985 |      8.685992 |    16.020675 |                 7.334683 |                      7.334683 |                        0.2 |              0.2 |                   0.2 |                 100.0 |                  5.068219 |             1.336154 |   0.2 | 7.334683 |
    | 2010-21-12 |        1.544792 |         1.032515 |        -0.409863 |      8.685068 |    16.021598 |                  7.33653 |                       7.33653 |                        0.8 |              0.8 |                   0.8 |                 100.0 |                  5.072848 |             1.544792 |   0.8 |  7.33653 |
    | 2010-22-12 |        0.762235 |         1.032607 |         -0.40962 |      8.683222 |    16.023444 |                 7.340222 |                      7.340222 |                        0.0 |              0.0 |                   0.0 |                 100.0 |                  5.081565 |             0.762235 |   0.0 | 7.340222 |
    | 2010-23-12 |        0.764156 |         1.032689 |        -0.409256 |      8.680456 |    16.026211 |                 7.345755 |                      7.345755 |                        0.0 |              0.0 |                   0.0 |                 100.0 |                  5.094372 |             0.764156 |   0.0 | 7.345755 |
    | 2010-24-12 |        0.766691 |         1.032762 |         -0.40877 |      8.676772 |    16.029895 |                 7.353123 |                      7.353123 |                        0.0 |              0.0 |                   0.0 |                 100.0 |                  5.111276 |             0.766691 |   0.0 | 7.353123 |
    | 2010-25-12 |        2.398433 |         1.032825 |        -0.408164 |      8.672175 |    16.034492 |                 7.362317 |                      7.362317 |                        3.2 |              3.2 |                   3.2 |                 100.0 |                  5.132282 |             2.398433 |   3.2 | 7.362317 |
    | 2010-26-12 |        2.793204 |         1.032879 |        -0.407436 |      8.666669 |    16.039997 |                 7.373328 |                      7.373328 |                        4.3 |              4.3 |                   4.3 |                 100.0 |                  5.157401 |             2.793204 |   4.3 | 7.373328 |
    | 2010-27-12 |        0.777996 |         1.032922 |        -0.406588 |      8.660262 |    16.046405 |                 7.386143 |                      7.386143 |                        0.0 |              0.0 |                   0.0 |                 100.0 |                  5.186639 |             0.777996 |   0.0 | 7.386143 |
    | 2010-28-12 |        2.504073 |         1.032956 |        -0.405619 |      8.652959 |    16.053708 |                 7.400749 |                      7.400749 |                        3.4 |              3.4 |                   3.4 |                 100.0 |                   5.22001 |             2.504073 |   3.4 | 7.400749 |
    | 2010-29-12 |        0.788629 |         1.032981 |         -0.40453 |      8.644768 |    16.061898 |                  7.41713 |                       7.41713 |                        0.0 |              0.0 |                   0.0 |                 100.0 |                  5.257524 |             0.788629 |   0.0 |  7.41713 |
    | 2010-30-12 |        0.794879 |         1.032995 |        -0.403321 |      8.635699 |    16.070967 |                 7.435268 |                      7.435268 |                        0.0 |              0.0 |                   0.0 |                 100.0 |                  5.299194 |             0.794879 |   0.0 | 7.435268 |
    | 2010-31-12 |        2.770177 |            1.033 |        -0.401992 |      8.625761 |    16.080906 |                 7.455145 |                      7.455145 |                        4.0 |              4.0 |                   4.0 |                 100.0 |                  5.345035 |             2.770177 |   4.0 | 7.455145 |

.. _meteo_v004_hourly_simulation_summer:

hourly simulation summer
________________________

We repeat the :ref:`meteo_v003_hourly_simulation_summer` example of |meteo_v003| but
use its global radiation results as input and prepare the log sequences
|LoggedGlobalRadiation| and |LoggedUnadjustedSunshineDuration| instead of
|LoggedSunshineDuration| and |LoggedUnadjustedSunshineDuration|:

>>> pub.timegrids = "1997-08-03", "1997-08-06", "1h"
>>> test = IntegrationTest(element)
>>> test.axis1 = (inputs.globalradiation,)
>>> test.axis2 = (factors.sunshineduration, factors.possiblesunshineduration,)
>>> test.dateformat = "%Y-%d-%m %H:00"

>>> inputs.globalradiation.series = (
...     0.0, 0.0, 0.0, 0.0, 0.00699727, 0.07895679, 0.20612227, 0.39359824, 0.61541695,
...     1.12234545, 1.80569988, 2.21406742, 2.25555957, 1.7860803, 1.51027558,
...     1.39639447, 1.00258874, 0.49369899, 0.18389057, 0.04907814, 0.0006694, 0.0, 0.0,
...     0.0, 0.0, 0.0, 0.0, 0.0, 0.00572586, 0.07182325, 0.22674879, 1.028795,
...     1.71081089, 2.21042419, 2.31770343, 2.16094673, 2.2338509, 2.15798899,
...     2.2087844, 1.86158537, 1.36021182, 0.9079367, 0.46287617, 0.15146131,
...     0.00292643, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00533645, 0.07608804,
...     0.45318042, 1.1014378, 1.83997647, 2.26626926, 2.75693972, 2.76172503,
...     2.65054987, 2.76482226, 2.64934573, 2.23334983, 1.62034295, 0.98501091,
...     0.48012518, 0.14517541, 0.00312164, 0.0, 0.0, 0.0)

>>> test.inits = (
...     (logs.loggedglobalradiation,
...      [0.0, 0.0, 0.0, 0.0, 0.0, 0.1, 0.2, 0.5, 0.8, 1.1, 1.2, 1.4, 1.9, 1.6, 0.9,
...       0.8, 0.6, 0.4, 0.2, 0.1, 0.0, 0.0, 0.0, 0.0]),
...     (logs.loggedunadjustedsunshineduration,
...      [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.2, 0.1, 0.2, 0.1, 0.2, 0.2, 0.3, 0.0,
...       0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]))

For this hourly simulation, there are relevant differences between the "real" sunshine
durations defined in the :ref:`meteo_v003_hourly_simulation_summer` example and the
estimates of |meteo_v004|.  The "daily sunshine adjustment" approach implemented by
method |Calc_SunshineDuration_V2| improves the agreement but cannot achieve equality:

.. integration-test::

    >>> test("meteo_v004_hourly_summer")
    |             date | globalradiation | earthsundistance | solardeclination | timeofsunrise | timeofsunset | possiblesunshineduration | dailypossiblesunshineduration | unadjustedsunshineduration | sunshineduration | dailysunshineduration | portiondailyradiation | extraterrestrialradiation | dailyglobalradiation |    node1 |    node2 |
    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    | 1997-03-08 00:00 |             0.0 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      0.0 |                     15.566134 |                        0.0 |              0.0 |              2.420919 |                   0.0 |                 36.001693 |                 11.8 |      0.0 |      0.0 |
    | 1997-03-08 01:00 |             0.0 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      0.0 |                     15.566134 |                        0.0 |              0.0 |              2.420919 |                   0.0 |                 36.001693 |                 11.8 |      0.0 |      0.0 |
    | 1997-03-08 02:00 |             0.0 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      0.0 |                     15.566134 |                        0.0 |              0.0 |              2.420919 |                   0.0 |                 36.001693 |                 11.8 |      0.0 |      0.0 |
    | 1997-03-08 03:00 |             0.0 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      0.0 |                     15.566134 |                        0.0 |              0.0 |              2.420919 |                   0.0 |                 36.001693 |                 11.8 |      0.0 |      0.0 |
    | 1997-03-08 04:00 |        0.006997 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                 0.429734 |                     15.566134 |                        0.0 |              0.0 |              2.340495 |              0.086656 |                 36.001693 |            11.706997 |      0.0 | 0.429734 |
    | 1997-03-08 05:00 |        0.078957 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      1.0 |                     15.566134 |                        0.0 |              0.0 |              2.235824 |              0.968392 |                 36.001693 |            11.585954 |      0.0 |      1.0 |
    | 1997-03-08 06:00 |        0.206122 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      1.0 |                     15.566134 |                        0.0 |              0.0 |              2.068169 |                2.4897 |                 36.001693 |            11.392076 |      0.0 |      1.0 |
    | 1997-03-08 07:00 |        0.393598 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      1.0 |                     15.566134 |                        0.0 |              0.0 |              1.889684 |              4.679733 |                 36.001693 |            11.185675 |      0.0 |      1.0 |
    | 1997-03-08 08:00 |        0.615417 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      1.0 |                     15.566134 |                        0.0 |              0.0 |              1.730067 |              7.219274 |                 36.001693 |            11.001092 |      0.0 |      1.0 |
    | 1997-03-08 09:00 |        1.122345 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      1.0 |                     15.566134 |                   0.160342 |         0.211068 |              1.922339 |              9.442017 |                 36.001693 |            11.223437 | 0.211068 |      1.0 |
    | 1997-03-08 10:00 |          1.8057 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      1.0 |                     15.566134 |                   0.436693 |         0.574283 |              2.100217 |             10.709164 |                 36.001693 |            11.429137 | 0.574283 |      1.0 |
    | 1997-03-08 11:00 |        2.214067 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      1.0 |                     15.566134 |                   0.641632 |         0.746481 |              2.371805 |             10.773868 |                 36.001693 |            11.743204 | 0.746481 |      1.0 |
    | 1997-03-08 12:00 |         2.25556 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      1.0 |                     15.566134 |                   0.708938 |         0.865897 |              3.111645 |             10.364714 |                 36.001693 |            12.598764 | 0.865897 |      1.0 |
    | 1997-03-08 13:00 |         1.78608 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      1.0 |                     15.566134 |                   0.412597 |         0.521979 |              3.618455 |             10.872489 |                 36.001693 |            13.184844 | 0.521979 |      1.0 |
    | 1997-03-08 14:00 |        1.510276 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      1.0 |                     15.566134 |                   0.302018 |         0.405098 |              3.973239 |             10.461143 |                 36.001693 |             13.59512 | 0.405098 |      1.0 |
    | 1997-03-08 15:00 |        1.396394 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      1.0 |                     15.566134 |                   0.375019 |         0.520027 |              4.488968 |              8.865382 |                 36.001693 |            14.191514 | 0.520027 |      1.0 |
    | 1997-03-08 16:00 |        1.002589 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      1.0 |                     15.566134 |                   0.360287 |         0.522116 |              4.923579 |              6.474205 |                 36.001693 |            14.694103 | 0.522116 |      1.0 |
    | 1997-03-08 17:00 |        0.493699 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      1.0 |                     15.566134 |                   0.189512 |         0.273543 |              5.177553 |              3.977658 |                 36.001693 |            14.987802 | 0.273543 |      1.0 |
    | 1997-03-08 18:00 |        0.183891 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      1.0 |                     15.566134 |                   0.017797 |         0.025919 |              5.250097 |              1.972911 |                 36.001693 |            15.071692 | 0.025919 |      1.0 |
    | 1997-03-08 19:00 |        0.049078 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      1.0 |                     15.566134 |                        0.0 |              0.0 |              5.292537 |              0.634046 |                 36.001693 |            15.120771 |      0.0 |      1.0 |
    | 1997-03-08 20:00 |        0.000669 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                   0.1364 |                     15.566134 |                        0.0 |              0.0 |              5.293116 |              0.008648 |                 36.001693 |             15.12144 |      0.0 |   0.1364 |
    | 1997-03-08 21:00 |             0.0 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      0.0 |                     15.566134 |                        0.0 |              0.0 |              5.293116 |                   0.0 |                 36.001693 |             15.12144 |      0.0 |      0.0 |
    | 1997-03-08 22:00 |             0.0 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      0.0 |                     15.566134 |                        0.0 |              0.0 |              5.293116 |                   0.0 |                 36.001693 |             15.12144 |      0.0 |      0.0 |
    | 1997-03-08 23:00 |             0.0 |         0.972155 |         0.297909 |      4.570266 |      20.1364 |                      0.0 |                     15.566134 |                        0.0 |              0.0 |              5.293116 |                   0.0 |                 36.001693 |             15.12144 |      0.0 |      0.0 |
    | 1997-04-08 00:00 |             0.0 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      0.0 |                     15.502754 |                        0.0 |              0.0 |              5.358504 |                   0.0 |                 35.762943 |             15.12144 |      0.0 |      0.0 |
    | 1997-04-08 01:00 |             0.0 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      0.0 |                     15.502754 |                        0.0 |              0.0 |              5.358504 |                   0.0 |                 35.762943 |             15.12144 |      0.0 |      0.0 |
    | 1997-04-08 02:00 |             0.0 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      0.0 |                     15.502754 |                        0.0 |              0.0 |              5.358504 |                   0.0 |                 35.762943 |             15.12144 |      0.0 |      0.0 |
    | 1997-04-08 03:00 |             0.0 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      0.0 |                     15.502754 |                        0.0 |              0.0 |              5.358504 |                   0.0 |                 35.762943 |             15.12144 |      0.0 |      0.0 |
    | 1997-04-08 04:00 |        0.005726 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                 0.398044 |                     15.502754 |                        0.0 |              0.0 |              5.357402 |               0.07485 |                 35.762943 |            15.120169 |      0.0 | 0.398044 |
    | 1997-04-08 05:00 |        0.071823 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      1.0 |                     15.502754 |                        0.0 |              0.0 |              5.351217 |              0.938714 |                 35.762943 |            15.113035 |      0.0 |      1.0 |
    | 1997-04-08 06:00 |        0.226749 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      1.0 |                     15.502754 |                   0.016424 |         0.024351 |                5.3691 |              2.455474 |                 35.762943 |            15.133662 | 0.024351 |      1.0 |
    | 1997-04-08 07:00 |        1.028795 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      1.0 |                     15.502754 |                    0.73726 |              1.0 |              5.919798 |              4.650125 |                 35.762943 |            15.768858 |      1.0 |      1.0 |
    | 1997-04-08 08:00 |        1.710811 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      1.0 |                     15.502754 |                   0.827155 |              1.0 |              6.869476 |              7.209034 |                 35.762943 |            16.864252 |      1.0 |      1.0 |
    | 1997-04-08 09:00 |        2.210424 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      1.0 |                     15.502754 |                   0.806882 |              1.0 |              7.812811 |              9.458797 |                 35.762943 |            17.952331 |      1.0 |      1.0 |
    | 1997-04-08 10:00 |        2.317703 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      1.0 |                     15.502754 |                   0.706007 |         0.955381 |              8.256704 |             10.747438 |                 35.762943 |            18.464335 | 0.955381 |      1.0 |
    | 1997-04-08 11:00 |        2.160947 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      1.0 |                     15.502754 |                   0.616973 |         0.833612 |               8.21065 |             10.819272 |                 35.762943 |            18.411214 | 0.833612 |      1.0 |
    | 1997-04-08 12:00 |        2.233851 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      1.0 |                     15.502754 |                   0.700274 |         0.945342 |              8.191829 |             10.408076 |                 35.762943 |            18.389505 | 0.945342 |      1.0 |
    | 1997-04-08 13:00 |        2.157989 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      1.0 |                     15.502754 |                   0.605418 |         0.823298 |              8.514264 |             10.917404 |                 35.762943 |            18.761414 | 0.823298 |      1.0 |
    | 1997-04-08 14:00 |        2.208784 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      1.0 |                     15.502754 |                   0.677045 |         0.930455 |              9.119852 |             10.494383 |                 35.762943 |            19.459923 | 0.930455 |      1.0 |
    | 1997-04-08 15:00 |        1.861585 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      1.0 |                     15.502754 |                    0.67314 |         0.924467 |               9.52316 |              8.874215 |                 35.762943 |            19.925114 | 0.924467 |      1.0 |
    | 1997-04-08 16:00 |        1.360212 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      1.0 |                     15.502754 |                   0.678079 |         0.919433 |              9.833209 |               6.45697 |                 35.762943 |            20.282737 | 0.919433 |      1.0 |
    | 1997-04-08 17:00 |        0.907937 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      1.0 |                     15.502754 |                   0.787027 |              1.0 |             10.192342 |              3.945159 |                 35.762943 |            20.696974 |      1.0 |      1.0 |
    | 1997-04-08 18:00 |        0.462876 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      1.0 |                     15.502754 |                   0.834566 |              1.0 |             10.434215 |              1.939642 |                 35.762943 |             20.97596 |      1.0 |      1.0 |
    | 1997-04-08 19:00 |        0.151461 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      1.0 |                     15.502754 |                   0.899331 |         0.989343 |             10.522979 |               0.60531 |                 35.762943 |            21.078343 | 0.989343 |      1.0 |
    | 1997-04-08 20:00 |        0.002926 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                 0.104711 |                     15.502754 |                   0.104711 |         0.104711 |             10.524936 |              0.005136 |                 35.762943 |              21.0806 | 0.104711 | 0.104711 |
    | 1997-04-08 21:00 |             0.0 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      0.0 |                     15.502754 |                        0.0 |              0.0 |             10.524936 |                   0.0 |                 35.762943 |              21.0806 |      0.0 |      0.0 |
    | 1997-04-08 22:00 |             0.0 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      0.0 |                     15.502754 |                        0.0 |              0.0 |             10.524936 |                   0.0 |                 35.762943 |              21.0806 |      0.0 |      0.0 |
    | 1997-04-08 23:00 |             0.0 |         0.972464 |         0.293016 |      4.601956 |    20.104711 |                      0.0 |                     15.502754 |                        0.0 |              0.0 |             10.524936 |                   0.0 |                 35.762943 |              21.0806 |      0.0 |      0.0 |
    | 1997-05-08 00:00 |             0.0 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      0.0 |                     15.438712 |                        0.0 |              0.0 |             10.605803 |                   0.0 |                 35.520271 |              21.0806 |      0.0 |      0.0 |
    | 1997-05-08 01:00 |             0.0 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      0.0 |                     15.438712 |                        0.0 |              0.0 |             10.605803 |                   0.0 |                 35.520271 |              21.0806 |      0.0 |      0.0 |
    | 1997-05-08 02:00 |             0.0 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      0.0 |                     15.438712 |                        0.0 |              0.0 |             10.605803 |                   0.0 |                 35.520271 |              21.0806 |      0.0 |      0.0 |
    | 1997-05-08 03:00 |             0.0 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      0.0 |                     15.438712 |                        0.0 |              0.0 |             10.605803 |                   0.0 |                 35.520271 |              21.0806 |      0.0 |      0.0 |
    | 1997-05-08 04:00 |        0.005336 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                 0.366022 |                     15.438712 |                        0.0 |              0.0 |             10.605465 |              0.063733 |                 35.520271 |            21.080211 |      0.0 | 0.366022 |
    | 1997-05-08 05:00 |        0.076088 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      1.0 |                     15.438712 |                        0.0 |              0.0 |             10.609172 |              0.908598 |                 35.520271 |            21.084476 |      0.0 |      1.0 |
    | 1997-05-08 06:00 |         0.45318 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      1.0 |                     15.438712 |                   0.554123 |         0.586585 |             10.806007 |              2.420659 |                 35.520271 |            21.310907 | 0.586585 |      1.0 |
    | 1997-05-08 07:00 |        1.101438 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      1.0 |                     15.438712 |                   0.842449 |         0.887865 |             10.869155 |              4.619722 |                 35.520271 |             21.38355 | 0.887865 |      1.0 |
    | 1997-05-08 08:00 |        1.839976 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      1.0 |                     15.438712 |                    0.93927 |         0.989376 |             10.981437 |              7.198198 |                 35.520271 |            21.512716 | 0.989376 |      1.0 |
    | 1997-05-08 09:00 |        2.266269 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      1.0 |                     15.438712 |                   0.846666 |         0.892368 |             11.029983 |              9.475573 |                 35.520271 |            21.568561 | 0.892368 |      1.0 |
    | 1997-05-08 10:00 |         2.75694 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      1.0 |                     15.438712 |                   0.939157 |              1.0 |             11.411806 |             10.786309 |                 35.520271 |            22.007797 |      1.0 |      1.0 |
    | 1997-05-08 11:00 |        2.761725 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      1.0 |                     15.438712 |                   0.931144 |              1.0 |             11.934057 |             10.865527 |                 35.520271 |            22.608575 |      1.0 |      1.0 |
    | 1997-05-08 12:00 |         2.65055 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      1.0 |                     15.438712 |                    0.92784 |              1.0 |             12.296289 |              10.45226 |                 35.520271 |            23.025274 |      1.0 |      1.0 |
    | 1997-05-08 13:00 |        2.764822 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      1.0 |                     15.438712 |                   0.919992 |              1.0 |             12.823804 |              10.96314 |                 35.520271 |            23.632108 |      1.0 |      1.0 |
    | 1997-05-08 14:00 |        2.649346 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      1.0 |                     15.438712 |                   0.916914 |              1.0 |             13.206779 |             10.528069 |                 35.520271 |            24.072669 |      1.0 |      1.0 |
    | 1997-05-08 15:00 |         2.23335 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      1.0 |                     15.438712 |                   0.915658 |              1.0 |             13.529951 |              8.882849 |                 35.520271 |            24.444433 |      1.0 |      1.0 |
    | 1997-05-08 16:00 |        1.620343 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      1.0 |                     15.438712 |                   0.916904 |              1.0 |              13.75608 |              6.439028 |                 35.520271 |            24.704564 |      1.0 |      1.0 |
    | 1997-05-08 17:00 |        0.985011 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      1.0 |                     15.438712 |                   0.917776 |              1.0 |              13.82308 |              3.911896 |                 35.520271 |            24.781639 |      1.0 |      1.0 |
    | 1997-05-08 18:00 |        0.480125 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      1.0 |                     15.438712 |                   0.918457 |              1.0 |             13.838074 |              1.905864 |                 35.520271 |            24.798888 |      1.0 |      1.0 |
    | 1997-05-08 19:00 |        0.145175 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      1.0 |                     15.438712 |                   0.918941 |              1.0 |              13.83261 |              0.576079 |                 35.520271 |            24.792602 |      1.0 |      1.0 |
    | 1997-05-08 20:00 |        0.003122 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                 0.072689 |                     15.438712 |                   0.072689 |         0.072689 |              13.83278 |              0.002495 |                 35.520271 |            24.792797 | 0.072689 | 0.072689 |
    | 1997-05-08 21:00 |             0.0 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      0.0 |                     15.438712 |                        0.0 |              0.0 |              13.83278 |                   0.0 |                 35.520271 |            24.792797 |      0.0 |      0.0 |
    | 1997-05-08 22:00 |             0.0 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      0.0 |                     15.438712 |                        0.0 |              0.0 |              13.83278 |                   0.0 |                 35.520271 |            24.792797 |      0.0 |      0.0 |
    | 1997-05-08 23:00 |             0.0 |          0.97278 |         0.288036 |      4.633978 |    20.072689 |                      0.0 |                     15.438712 |                        0.0 |              0.0 |              13.83278 |                   0.0 |                 35.520271 |            24.792797 |      0.0 |      0.0 |

.. _meteo_v004_hourly_simulation_winter:

hourly simulation winter
________________________

We repeat the :ref:`meteo_v003_hourly_simulation_winter` example of |meteo_v003| but
use its global radiation results as input and prepare the log sequences
|LoggedGlobalRadiation| and |LoggedUnadjustedSunshineDuration| instead of
|LoggedSunshineDuration| and |LoggedUnadjustedSunshineDuration|:

>>> pub.timegrids = "2010-12-10", "2010-12-13", "1h"

>>> inputs.globalradiation.series = (
...     0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0039874, 0.06718753, 0.20256447,
...     0.38580565, 0.329304, 0.28971193, 0.15523413, 0.03715233, 0.00010117, 0.0, 0.0,
...     0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00324264,
...     0.06216304, 0.1894234, 0.28848828, 0.28899402, 0.27300745, 0.15202048,
...     0.04541011, 0.00007888, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
...     0.0, 0.0, 0.0, 0.0, 0.00321892, 0.06376514, 0.19548931, 0.29341493, 0.29399506,
...     0.27748425, 0.21691455, 0.05341428, 0.00060788, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
...     0.0)

>>> test.inits = (
...     (logs.loggedglobalradiation,
...      [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.1, 0.2, 0.4, 0.6, 0.5, 0.2,
...       0.0,0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]),
...     (logs.loggedunadjustedsunshineduration,
...      [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.04, 0.25, 0.59, 0.91,
...       0.97, 1.0, 0.65, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]))

In this short period with little sunshine, relative differences between the original
and the estimated sunshine duration are more severe than in the summer example.  The
"daily sunshine adjustment" approach does not improve the agreement but worsens it
slightly (which needs further investigation):

.. integration-test::

    >>> test("meteo_v004_hourly_winter")
    |             date | globalradiation | earthsundistance | solardeclination | timeofsunrise | timeofsunset | possiblesunshineduration | dailypossiblesunshineduration | unadjustedsunshineduration | sunshineduration | dailysunshineduration | portiondailyradiation | extraterrestrialradiation | dailyglobalradiation |    node1 |    node2 |
    -----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
    | 2010-10-12 00:00 |             0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      0.0 |                       7.41713 |                        0.0 |              0.0 |                 1.946 |                   0.0 |                  5.246826 |                  2.0 |      0.0 |      0.0 |
    | 2010-10-12 01:00 |             0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      0.0 |                       7.41713 |                        0.0 |              0.0 |                 1.946 |                   0.0 |                  5.246826 |                  2.0 |      0.0 |      0.0 |
    | 2010-10-12 02:00 |             0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      0.0 |                       7.41713 |                        0.0 |              0.0 |                 1.946 |                   0.0 |                  5.246826 |                  2.0 |      0.0 |      0.0 |
    | 2010-10-12 03:00 |             0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      0.0 |                       7.41713 |                        0.0 |              0.0 |                 1.946 |                   0.0 |                  5.246826 |                  2.0 |      0.0 |      0.0 |
    | 2010-10-12 04:00 |             0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      0.0 |                       7.41713 |                        0.0 |              0.0 |                 1.946 |                   0.0 |                  5.246826 |                  2.0 |      0.0 |      0.0 |
    | 2010-10-12 05:00 |             0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      0.0 |                       7.41713 |                        0.0 |              0.0 |                 1.946 |                   0.0 |                  5.246826 |                  2.0 |      0.0 |      0.0 |
    | 2010-10-12 06:00 |             0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      0.0 |                       7.41713 |                        0.0 |              0.0 |                 1.946 |                   0.0 |                  5.246826 |                  2.0 |      0.0 |      0.0 |
    | 2010-10-12 07:00 |             0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      0.0 |                       7.41713 |                        0.0 |              0.0 |                 1.946 |                   0.0 |                  5.246826 |                  2.0 |      0.0 |      0.0 |
    | 2010-10-12 08:00 |        0.003987 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                 0.355232 |                       7.41713 |                   0.025215 |         0.017719 |              1.957274 |              0.266196 |                  5.246826 |             2.003987 | 0.017719 | 0.355232 |
    | 2010-10-12 09:00 |        0.067188 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      1.0 |                       7.41713 |                   0.020556 |         0.017712 |              1.581776 |              4.919884 |                  5.246826 |             1.871175 | 0.017712 |      1.0 |
    | 2010-10-12 10:00 |        0.202564 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      1.0 |                       7.41713 |                    0.01914 |         0.015007 |              0.740841 |             14.873457 |                  5.246826 |             1.573739 | 0.015007 |      1.0 |
    | 2010-10-12 11:00 |        0.385806 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      1.0 |                       7.41713 |                   0.162746 |         0.042522 |              0.135253 |             22.189872 |                  5.246826 |             1.359545 | 0.042522 |      1.0 |
    | 2010-10-12 12:00 |        0.329304 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      1.0 |                       7.41713 |                   0.065497 |              0.0 |                   0.0 |             22.197307 |                  5.246826 |             1.288849 |      0.0 |      1.0 |
    | 2010-10-12 13:00 |        0.289712 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      1.0 |                       7.41713 |                   0.026804 |         0.015835 |              0.189017 |             20.962863 |                  5.246826 |             1.378561 | 0.015835 |      1.0 |
    | 2010-10-12 14:00 |        0.155234 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      1.0 |                       7.41713 |                   0.005645 |         0.005984 |              0.345179 |             11.702396 |                  5.246826 |             1.433795 | 0.005984 |      1.0 |
    | 2010-10-12 15:00 |        0.037152 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      1.0 |                       7.41713 |                        0.0 |              0.0 |              0.450219 |              2.880181 |                  5.246826 |             1.470947 |      0.0 |      1.0 |
    | 2010-10-12 16:00 |        0.000101 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                 0.061898 |                       7.41713 |                        0.0 |              0.0 |              0.450505 |              0.007844 |                  5.246826 |             1.471049 |      0.0 | 0.061898 |
    | 2010-10-12 17:00 |             0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      0.0 |                       7.41713 |                        0.0 |              0.0 |              0.450505 |                   0.0 |                  5.246826 |             1.471049 |      0.0 |      0.0 |
    | 2010-10-12 18:00 |             0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      0.0 |                       7.41713 |                        0.0 |              0.0 |              0.450505 |                   0.0 |                  5.246826 |             1.471049 |      0.0 |      0.0 |
    | 2010-10-12 19:00 |             0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      0.0 |                       7.41713 |                        0.0 |              0.0 |              0.450505 |                   0.0 |                  5.246826 |             1.471049 |      0.0 |      0.0 |
    | 2010-10-12 20:00 |             0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      0.0 |                       7.41713 |                        0.0 |              0.0 |              0.450505 |                   0.0 |                  5.246826 |             1.471049 |      0.0 |      0.0 |
    | 2010-10-12 21:00 |             0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      0.0 |                       7.41713 |                        0.0 |              0.0 |              0.450505 |                   0.0 |                  5.246826 |             1.471049 |      0.0 |      0.0 |
    | 2010-10-12 22:00 |             0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      0.0 |                       7.41713 |                        0.0 |              0.0 |              0.450505 |                   0.0 |                  5.246826 |             1.471049 |      0.0 |      0.0 |
    | 2010-10-12 23:00 |             0.0 |         1.030879 |         -0.40453 |      8.644768 |    16.061898 |                      0.0 |                       7.41713 |                        0.0 |              0.0 |              0.450505 |                   0.0 |                  5.246826 |             1.471049 |      0.0 |      0.0 |
    | 2010-11-12 00:00 |             0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      0.0 |                      7.400749 |                        0.0 |              0.0 |              0.478444 |                   0.0 |                  5.210498 |             1.471049 |      0.0 |      0.0 |
    | 2010-11-12 01:00 |             0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      0.0 |                      7.400749 |                        0.0 |              0.0 |              0.478444 |                   0.0 |                  5.210498 |             1.471049 |      0.0 |      0.0 |
    | 2010-11-12 02:00 |             0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      0.0 |                      7.400749 |                        0.0 |              0.0 |              0.478444 |                   0.0 |                  5.210498 |             1.471049 |      0.0 |      0.0 |
    | 2010-11-12 03:00 |             0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      0.0 |                      7.400749 |                        0.0 |              0.0 |              0.478444 |                   0.0 |                  5.210498 |             1.471049 |      0.0 |      0.0 |
    | 2010-11-12 04:00 |             0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      0.0 |                      7.400749 |                        0.0 |              0.0 |              0.478444 |                   0.0 |                  5.210498 |             1.471049 |      0.0 |      0.0 |
    | 2010-11-12 05:00 |             0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      0.0 |                      7.400749 |                        0.0 |              0.0 |              0.478444 |                   0.0 |                  5.210498 |             1.471049 |      0.0 |      0.0 |
    | 2010-11-12 06:00 |             0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      0.0 |                      7.400749 |                        0.0 |              0.0 |              0.478444 |                   0.0 |                  5.210498 |             1.471049 |      0.0 |      0.0 |
    | 2010-11-12 07:00 |             0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      0.0 |                      7.400749 |                        0.0 |              0.0 |              0.478444 |                   0.0 |                  5.210498 |             1.471049 |      0.0 |      0.0 |
    | 2010-11-12 08:00 |        0.003243 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                 0.347041 |                      7.400749 |                        0.0 |              0.0 |              0.476328 |              0.254871 |                  5.210498 |             1.470304 |      0.0 | 0.347041 |
    | 2010-11-12 09:00 |        0.062163 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      1.0 |                      7.400749 |                        0.0 |              0.0 |              0.462055 |              4.882681 |                  5.210498 |             1.465279 |      0.0 |      1.0 |
    | 2010-11-12 10:00 |        0.189423 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      1.0 |                      7.400749 |                        0.0 |              0.0 |              0.424725 |             14.862249 |                  5.210498 |             1.452138 |      0.0 |      1.0 |
    | 2010-11-12 11:00 |        0.288488 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      1.0 |                      7.400749 |                        0.0 |              0.0 |              0.148275 |              22.23196 |                  5.210498 |             1.354821 |      0.0 |      1.0 |
    | 2010-11-12 12:00 |        0.288994 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      1.0 |                      7.400749 |                        0.0 |              0.0 |              0.033766 |             22.247803 |                  5.210498 |             1.314511 |      0.0 |      1.0 |
    | 2010-11-12 13:00 |        0.273007 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      1.0 |                      7.400749 |                        0.0 |              0.0 |                   0.0 |             20.992726 |                  5.210498 |             1.297806 |      0.0 |      1.0 |
    | 2010-11-12 14:00 |         0.15202 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      1.0 |                      7.400749 |                        0.0 |              0.0 |                   0.0 |             11.677032 |                  5.210498 |             1.294593 |      0.0 |      1.0 |
    | 2010-11-12 15:00 |         0.04541 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      1.0 |                      7.400749 |                   0.112716 |         0.000642 |              0.000642 |              2.844748 |                  5.210498 |             1.302851 | 0.000642 |      1.0 |
    | 2010-11-12 16:00 |        0.000079 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                 0.053708 |                      7.400749 |                   0.000569 |         0.000003 |              0.000579 |               0.00593 |                  5.210498 |             1.302828 | 0.000003 | 0.053708 |
    | 2010-11-12 17:00 |             0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      0.0 |                      7.400749 |                        0.0 |              0.0 |              0.000579 |                   0.0 |                  5.210498 |             1.302828 |      0.0 |      0.0 |
    | 2010-11-12 18:00 |             0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      0.0 |                      7.400749 |                        0.0 |              0.0 |              0.000579 |                   0.0 |                  5.210498 |             1.302828 |      0.0 |      0.0 |
    | 2010-11-12 19:00 |             0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      0.0 |                      7.400749 |                        0.0 |              0.0 |              0.000579 |                   0.0 |                  5.210498 |             1.302828 |      0.0 |      0.0 |
    | 2010-11-12 20:00 |             0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      0.0 |                      7.400749 |                        0.0 |              0.0 |              0.000579 |                   0.0 |                  5.210498 |             1.302828 |      0.0 |      0.0 |
    | 2010-11-12 21:00 |             0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      0.0 |                      7.400749 |                        0.0 |              0.0 |              0.000579 |                   0.0 |                  5.210498 |             1.302828 |      0.0 |      0.0 |
    | 2010-11-12 22:00 |             0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      0.0 |                      7.400749 |                        0.0 |              0.0 |              0.000579 |                   0.0 |                  5.210498 |             1.302828 |      0.0 |      0.0 |
    | 2010-11-12 23:00 |             0.0 |         1.031074 |        -0.405619 |      8.652959 |    16.053708 |                      0.0 |                      7.400749 |                        0.0 |              0.0 |              0.000579 |                   0.0 |                  5.210498 |             1.302828 |      0.0 |      0.0 |
    | 2010-12-12 00:00 |             0.0 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      0.0 |                      7.386143 |                        0.0 |              0.0 |              0.023549 |                   0.0 |                  5.178293 |             1.302828 |      0.0 |      0.0 |
    | 2010-12-12 01:00 |             0.0 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      0.0 |                      7.386143 |                        0.0 |              0.0 |              0.023549 |                   0.0 |                  5.178293 |             1.302828 |      0.0 |      0.0 |
    | 2010-12-12 02:00 |             0.0 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      0.0 |                      7.386143 |                        0.0 |              0.0 |              0.023549 |                   0.0 |                  5.178293 |             1.302828 |      0.0 |      0.0 |
    | 2010-12-12 03:00 |             0.0 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      0.0 |                      7.386143 |                        0.0 |              0.0 |              0.023549 |                   0.0 |                  5.178293 |             1.302828 |      0.0 |      0.0 |
    | 2010-12-12 04:00 |             0.0 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      0.0 |                      7.386143 |                        0.0 |              0.0 |              0.023549 |                   0.0 |                  5.178293 |             1.302828 |      0.0 |      0.0 |
    | 2010-12-12 05:00 |             0.0 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      0.0 |                      7.386143 |                        0.0 |              0.0 |              0.023549 |                   0.0 |                  5.178293 |             1.302828 |      0.0 |      0.0 |
    | 2010-12-12 06:00 |             0.0 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      0.0 |                      7.386143 |                        0.0 |              0.0 |              0.023549 |                   0.0 |                  5.178293 |             1.302828 |      0.0 |      0.0 |
    | 2010-12-12 07:00 |             0.0 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      0.0 |                      7.386143 |                        0.0 |              0.0 |              0.023549 |                   0.0 |                  5.178293 |             1.302828 |      0.0 |      0.0 |
    | 2010-12-12 08:00 |        0.003219 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                 0.339738 |                      7.386143 |                    0.00256 |         0.000519 |              0.023482 |              0.244956 |                  5.178293 |             1.302805 | 0.000519 | 0.339738 |
    | 2010-12-12 09:00 |        0.063765 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      1.0 |                      7.386143 |                   0.007855 |         0.001781 |              0.028052 |              4.849391 |                  5.178293 |             1.304407 | 0.001781 |      1.0 |
    | 2010-12-12 10:00 |        0.195489 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      1.0 |                      7.386143 |                   0.008371 |         0.002875 |              0.045356 |             14.852029 |                  5.178293 |             1.310473 | 0.002875 |      1.0 |
    | 2010-12-12 11:00 |        0.293415 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      1.0 |                      7.386143 |                   0.008878 |         0.003742 |              0.059411 |             22.269583 |                  5.178293 |             1.315399 | 0.003742 |      1.0 |
    | 2010-12-12 12:00 |        0.293995 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      1.0 |                      7.386143 |                   0.009348 |         0.004582 |              0.073678 |             22.293018 |                  5.178293 |               1.3204 | 0.004582 |      1.0 |
    | 2010-12-12 13:00 |        0.277484 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      1.0 |                      7.386143 |                   0.009874 |         0.005329 |              0.086449 |             21.019348 |                  5.178293 |             1.324877 | 0.005329 |      1.0 |
    | 2010-12-12 14:00 |        0.216915 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      1.0 |                      7.386143 |                   0.218871 |         0.156816 |              0.271574 |             11.654171 |                  5.178293 |             1.389771 | 0.156816 |      1.0 |
    | 2010-12-12 15:00 |        0.053414 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      1.0 |                      7.386143 |                   0.233367 |         0.137495 |              0.294408 |              2.813062 |                  5.178293 |             1.397775 | 0.137495 |      1.0 |
    | 2010-12-12 16:00 |        0.000608 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                 0.046405 |                      7.386143 |                   0.046405 |         0.025172 |              0.295917 |              0.004444 |                  5.178293 |             1.398304 | 0.025172 | 0.046405 |
    | 2010-12-12 17:00 |             0.0 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      0.0 |                      7.386143 |                        0.0 |              0.0 |              0.295917 |                   0.0 |                  5.178293 |             1.398304 |      0.0 |      0.0 |
    | 2010-12-12 18:00 |             0.0 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      0.0 |                      7.386143 |                        0.0 |              0.0 |              0.295917 |                   0.0 |                  5.178293 |             1.398304 |      0.0 |      0.0 |
    | 2010-12-12 19:00 |             0.0 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      0.0 |                      7.386143 |                        0.0 |              0.0 |              0.295917 |                   0.0 |                  5.178293 |             1.398304 |      0.0 |      0.0 |
    | 2010-12-12 20:00 |             0.0 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      0.0 |                      7.386143 |                        0.0 |              0.0 |              0.295917 |                   0.0 |                  5.178293 |             1.398304 |      0.0 |      0.0 |
    | 2010-12-12 21:00 |             0.0 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      0.0 |                      7.386143 |                        0.0 |              0.0 |              0.295917 |                   0.0 |                  5.178293 |             1.398304 |      0.0 |      0.0 |
    | 2010-12-12 22:00 |             0.0 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      0.0 |                      7.386143 |                        0.0 |              0.0 |              0.295917 |                   0.0 |                  5.178293 |             1.398304 |      0.0 |      0.0 |
    | 2010-12-12 23:00 |             0.0 |          1.03126 |        -0.406588 |      8.660262 |    16.046405 |                      0.0 |                      7.386143 |                        0.0 |              0.0 |              0.295917 |                   0.0 |                  5.178293 |             1.398304 |      0.0 |      0.0 |
"""
# import...
# ...from HydPy
from hydpy.exe.modelimports import *
from hydpy.core import modeltools
from hydpy.models.meteo import meteo_model


class Model(modeltools.AdHocModel):
    """Version 4 of the Meteo model."""

    INLET_METHODS = ()
    RECEIVER_METHODS = ()
    RUN_METHODS = (
        meteo_model.Calc_EarthSunDistance_V1,
        meteo_model.Calc_SolarDeclination_V2,
        meteo_model.Calc_TimeOfSunrise_TimeOfSunset_V1,
        meteo_model.Calc_DailyPossibleSunshineDuration_V1,
        meteo_model.Calc_PossibleSunshineDuration_V2,
        meteo_model.Update_LoggedGlobalRadiation_V1,
        meteo_model.Calc_DailyGlobalRadiation_V2,
        meteo_model.Calc_ExtraterrestrialRadiation_V2,
        meteo_model.Calc_DailySunshineDuration_V2,
        meteo_model.Calc_PortionDailyRadiation_V1,
        meteo_model.Calc_UnadjustedSunshineDuration_V1,
        meteo_model.Update_LoggedUnadjustedSunshineDuration_V1,
        meteo_model.Calc_SunshineDuration_V2,
    )
    ADD_METHODS = (meteo_model.Return_SunshineDuration_V1,)
    OUTLET_METHODS = ()
    SENDER_METHODS = ()
    SUBMODELS = ()


tester = Tester()
cythonizer = Cythonizer()
